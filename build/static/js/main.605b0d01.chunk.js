(this.webpackJsonplowympact=this.webpackJsonplowympact||[]).push([[0],{163:function(e,t,a){},177:function(e,t,a){},178:function(e,t,a){},179:function(e,t,a){},180:function(e,t,a){},182:function(e,t,a){},197:function(e,t,a){},198:function(e,t,a){},204:function(e,t){},206:function(e,t){},219:function(e,t){},221:function(e,t){},249:function(e,t){},251:function(e,t){},252:function(e,t){},257:function(e,t){},259:function(e,t){},278:function(e,t){},290:function(e,t){},293:function(e,t){},310:function(e,t,a){},311:function(e,t,a){},312:function(e,t,a){},313:function(e,t,a){},314:function(e,t,a){},316:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),r=a(164),o=a.n(r),c=(a(177),a(5)),i=a(13),l=a(7),d=a(6),u=a(9),p=a(16),b=a(324),m=(a(178),a.p+"static/media/fruits-vegetables-basket-by-oblik-studio.7d5e1c64.svg"),j=(a(179),a(180),a(0));var v=function(){return Object(j.jsxs)("div",{children:[Object(j.jsx)("div",{className:"button-logo",children:Object(j.jsx)("span",{class:"material-icons",children:"history"})}),Object(j.jsx)("div",{children:"Historique"})]})};var h=function(){return Object(j.jsxs)("div",{children:[Object(j.jsx)("div",{children:Object(j.jsx)("span",{class:"material-icons",children:"person"})}),Object(j.jsx)("div",{children:"Profil"})]})};var g=function(){return Object(j.jsx)("div",{children:Object(j.jsx)("div",{className:"navbar-scan-icon",children:Object(j.jsx)("span",{class:"material-icons",children:"qr_code_scanner"})})})},f=a(63),x=(a(182),a(322)),O=Object(f.configure)("ASHf6Cx7DGz5BbkR5RWee94Ezm55DtkCAFB5HoNVQLhPf8gUhk8ypmZ72tbfAdIo33/I2gZR9pcXcdBwQGyYu69PkahqLA0dEEN5WFtpVEjMfQMiBhwmRWIJQgn+E54DiwJm/5CjsV1+Uy7AJWXnvrLiuwxG2D/b7b1QoPFJfkKp2OSreWJXnV/kJ+rtqFyNOu2wQb5Rq5IFXOU/tnjlTvJp8Kxl4jezOVoWlQZreaLKfxfBforPArJErC16cldrqFULYUdsPqb4Vn27hWUmPQTfaX/SbeDCl1h++IPmcvRpzwM9hY0ti7zzfhBKg3TgEYTMiPUipakmM21mU92xYjA9kmKO6bOjzY4XqyrWBUzv/C1TwJfK1aZDDLH8BOmqqJILi2Ty9fN84y09vBgv0dfXhQa3Q0/UW0Hnv0Xge2am3RY5dmE6pfWaxYyA3fDj920DpnlUNcAsfdErnvpZz8H1eftw6D2w3ps6q3jNFc/CTkALFZOk9Sy2u+lOfzvjKrcz5d1yoSo1sVhFsLWNUoaoHTP6NPnQaawC1YwPRp90T+2yNfx+iESAhn3qfn2pOEpBG0rHdZNLLj1yeNJU9Pjt7dznNeCJwG2SzSQvPZU5HzLuIu+siWjUPStB9WWMfVluWN3opv+ReRWBjBsaRFPBmit6LNbRk3QLT6To50yVZg8Zy1NuDFUoE+Ms2ytVn9fs30n1DeNYJLCWjQJ4ktQaz2mIFTOFvRVrJqPkTBwzOaAjWoPxOr097hga8bRhPAqV6ir7ojSffUeCjL/jmp1x1uSE4OaQe3Y32oC0XOVJqA==",{engineLocation:"https://cdn.jsdelivr.net/npm/scandit-sdk@5.x/build/"}).catch((function(e){alert(e)})),y={position:"absolute",top:"0",bottom:"0",left:"0",right:"0",margin:"auto",maxWidth:"1280px",maxHeight:"80%"},S=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).ref=s.a.createRef(),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;O.then((function(){f.BarcodePicker.create(e.ref.current,e.props).then((function(t){e.barcodePicker=t,null!=e.props.onScan&&t.on("scan",e.props.onScan),null!=e.props.onError&&t.on("scanError",e.props.onError)}))}))}},{key:"componentWillUnmount",value:function(){null!=this.barcodePicker&&this.barcodePicker.destroy()}},{key:"componentDidUpdate",value:function(e){JSON.stringify(e.scanSettings)!==JSON.stringify(this.props.scanSettings)&&this.barcodePicker.applyScanSettings(this.props.scanSettings),e.visible!==this.props.visible&&this.barcodePicker.setVisible(this.props.visible)}},{key:"render",value:function(){var e=this;return Object(j.jsx)(b.a,{exitBeforeEnter:!0,children:Object(j.jsxs)(x.a.div,{id:"background-scan",initial:{bottom:"-1000px"},animate:{bottom:"0px"},transition:{duration:.5},exit:{bottom:"-1000px"},children:[Object(j.jsx)("div",{ref:this.ref,style:y}),Object(j.jsx)("span",{class:"close",onClick:function(){e.props.onCrossClicked(!1)},children:"\xd7"}),Object(j.jsx)("div",{id:"scandit-barcode-picker"})]})})}}]),a}(n.Component),N=a(18),w=a.n(N),k=a(34),C=a(45),I=a.n(C),P=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).componentDidMount=Object(k.a)(w.a.mark((function t(){var a,n,s,r,o,c;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.mediaDevices.enumerateDevices();case 2:n=t.sent,s=[],n.forEach((function(e){"videoinput"==e.kind&&null!=e.label.match(/back/)&&s.push(e)})),r=-1,o=w.a.mark((function e(t){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s[t],void 0,e.next=4,navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:n.deviceId}}}).then((function(e){e.getVideoTracks().forEach((function(e){var t=e.getCapabilities();t.height.max>=r&&(r=t.height.max,a=n.deviceId)})),e.getTracks().forEach((function(e){return e.stop()}))}),(function(e){return console.log(e)}));case 4:e.sent;case 5:case"end":return e.stop()}}),e)})),t.t0=w.a.keys(s);case 8:if((t.t1=t.t0()).done){t.next=13;break}return c=t.t1.value,t.delegateYield(o(c),"t2",11);case 11:t.next=8;break;case 13:I.a.init({inputStream:{type:"LiveStream",constraints:{deviceId:a,focusMode:"continuous",width:{min:1920},height:{min:1080},aspectRatio:{min:1,max:2}}},locator:{patchSize:"normal",halfSample:!1},locate:!1,area:{top:"25%",right:"25%",left:"25%",bottom:"25%"},numOfWorkers:window.navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader"]},debug:{drawBoundingBox:!0,showFrequency:!0,drawScanline:!0,showPattern:!0},multiple:!1,singleChannel:!1},(function(e){if(e)return console.log(e);I.a.start()})),e.props.setQuagga(I.a),I.a.onDetected(e._onDetected);case 16:case"end":return t.stop()}}),t)}))),e._onDetected=function(){var t=Object(k.a)(w.a.mark((function t(a){var n;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.props.onDetected(a);case 2:n=t.sent,console.log(n),n&&I.a.stop();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(i.a)(a,[{key:"componentWillUnmount",value:function(){I.a.offDetected(this._onDetected)}},{key:"render",value:function(){return Object(j.jsx)(s.a.Fragment,{children:Object(j.jsx)("div",{id:"interactive",className:"viewport"})})}}]),a}(n.Component),F=a(165),_=a.n(F),D=a(167),E=a.n(D),T=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={scanning:!0,status:"",results:[],usedCameraId:"3f6fc4177028f25c3e8215f4444838450630b8d656c627ef511346545d37f302",devices:[],reading:0,barcode:void 0,bcProductId:void 0,Quagga:void 0},e.setQuagga=function(t){console.log(t),e.state.Quagga&&e.state.Quagga.stop(),e.setState({Quagga:t})},e._scan=function(){e.setState({scanning:!e.state.scanning,status:""})},e._onDetected=function(){var t=Object(k.a)(w.a.mark((function t(a){var n,s;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log(a),!a){t.next=18;break}if(!a.codeResult||!a.codeResult.code){t.next=18;break}return e.setState({results:[a],scanning:!0,status:"waiting"}),t.next=6,fetch("https://world.openfoodfacts.org/api/v0/product/".concat(a.codeResult.code,".json/"));case 6:return n=t.sent,t.next=9,n.json();case 9:if(s=t.sent,console.log(s),0===s.status){t.next=16;break}return e.setState({scanning:!1,status:"found",barcode:a.codeResult.code}),t.abrupt("return",!0);case 16:return e.setState({scanning:!0,status:"not found"}),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleScan=function(t){if(t){var a=t.split("/");a.length>1&&e.setState({scanning:!1,barcode:a[4],bcProductId:a[5],status:"found"}),e.state.Quagga.stop()}},e.handleError=function(e){console.error(e)},e.displayQrCode=function(){return"found"!==e.state.status?Object(j.jsx)(_.a,{delay:300,onError:e.handleError,onScan:e.handleScan,style:{width:"100%"},showViewFinder:!1}):Object(j.jsx)(s.a.Fragment,{})},e.displayBarCode=function(){return"found"!==e.state.status?Object(j.jsxs)(s.a.Fragment,{children:[Object(j.jsxs)("div",{className:"header",children:[e.state.scanning?"true":"false",Object(j.jsx)("ul",{className:"results",children:e.state.results.map((function(t,a){var n;return Object(j.jsxs)("div",{children:["waiting"===e.state.status?"V\xe9rification du code"+(null===t||void 0===t||null===(n=t.codeResult)||void 0===n?void 0:n.code):"","not found"===e.state.status?"code non trouv\xe9, merci de r\xe9essayer":""]},t.codeResult.code+a)}))})]}),e.state.scanning?Object(j.jsx)(P,{onDetected:e._onDetected,setQuagga:e.setQuagga,usedCameraId:e.usedCameraId}):null]}):Object(j.jsx)(s.a.Fragment,{})},e.switchReader=function(){e.state.reading?e.setState({reading:!1}):e.setState({reading:!0})},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return console.log("Results: ",this.state.results,this.state.redirect),this.state.barcode&&this.state.bcProductId&&(this.props.barcode!==this.state.barcode||this.props.bcProductId!==this.state.bcProductId)?Object(j.jsx)(p.a,{to:"/products/"+this.state.barcode+"/"+this.state.bcProductId}):this.state.barcode&&this.props.barcode!==this.state.barcode?Object(j.jsx)(p.a,{to:"/products/"+this.state.barcode}):Object(j.jsxs)("div",{className:"code-reader-container",children:[Object(j.jsx)("span",{class:"close",onClick:function(){var t;null===(t=e.props)||void 0===t||t.onCrossClicked(!1)},children:"\xd7"}),Object(j.jsxs)("div",{className:"code-switch",onClick:this.switchReader,children:[Object(j.jsxs)("div",{className:"span-code-switch",children:[Object(j.jsx)("span",{className:this.state.reading?"material-icons":"material-icons green",children:"view_week"}),Object(j.jsx)("span",{children:"Barcode"})]}),Object(j.jsx)(E.a,{onChange:this.switchReader,uncheckedIcon:!1,checkedIcon:!1,checked:this.state.reading,onColor:"#888",offColor:"#888"}),Object(j.jsxs)("div",{className:"span-code-switch",children:[Object(j.jsx)("span",{className:this.state.reading?"material-icons green":"material-icons",children:"qr_code_scanner"}),Object(j.jsx)("span",{children:"QR Code"})]})]}),this.state.reading?this.displayQrCode():this.displayBarCode()]})}}]),a}(n.Component),A=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={showScanner:!1,barcode:void 0,bcProductId:void 0,height:0},e.updateWindowDimensions=function(){e.setState({height:window.innerHeight})},e.handleScannerButton=function(t){e.setState({showScanner:t})},e.handleBarcode=function(t){if(t){var a=t.split("/");a.length>1?e.setState({barcode:a[4],bcProductId:a[5],showScanner:!1}):e.setState({barcode:a[0],showScanner:!1,bcProductId:void 0})}},e.render=function(){return e.state.height<550?Object(j.jsx)(s.a.Fragment,{}):e.state.barcode&&e.state.bcProductId&&(e.props.barcode!==e.state.barcode||e.props.bcProductId!==e.state.bcProductId)?Object(j.jsx)(p.a,{to:"/products/"+e.state.barcode+"/"+e.state.bcProductId}):e.state.barcode&&e.props.barcode!==e.state.barcode?Object(j.jsx)(p.a,{to:"/products/"+e.state.barcode}):e.state.showScanner?Object(j.jsx)(S,{onCrossClicked:e.handleScannerButton,vibrateOnScan:!0,enableTorchToggle:!0,enablePinchToZoom:!0,enableCameraSwitcher:!0,guiStyle:"viewfinder",scanSettings:new f.ScanSettings({enabledSymbologies:["qr","ean8","ean13","upca","upce","code128","code39","code93","itf"],codeDuplicateFilter:1e3}),onScan:function(t){console.log(t.barcodes[0].data),e.handleBarcode(t.barcodes[0].data)},onError:function(e){console.error(e.message)}}):Object(j.jsx)(s.a.Fragment,{children:Object(j.jsxs)("div",{className:"navbar-container",children:[Object(j.jsx)(u.b,{to:"/history",className:"/history"==window.location.pathname?"navbar-link navbar-text-left navbar-selected":"navbar-link navbar-text-left ",children:Object(j.jsx)(v,{})}),Object(j.jsx)("div",{onClick:function(){return e.handleScannerButton(!0)},children:Object(j.jsx)("div",{className:"navbar-circle",children:Object(j.jsx)(g,{})})}),Object(j.jsx)("span",{className:"navbar-scan-text",children:"Scan"}),Object(j.jsx)(u.b,{to:"/profil",className:"/profil"==window.location.pathname?"navbar-link navbar-text-right navbar-selected":"navbar-link navbar-text-right ",children:Object(j.jsx)(h,{})})]})})},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}}]),a}(s.a.Component),L=(a(197),a.p+"static/media/logo.b235ef42.svg"),M=a.p+"static/media/bitmap.6f490d5b.png";var B=function(){return Object(j.jsxs)("div",{children:[Object(j.jsx)("div",{children:Object(j.jsx)("img",{src:M,className:"blob-top",alt:"Blob"})}),Object(j.jsx)("div",{children:Object(j.jsx)("img",{src:M,className:"blob-left",alt:"Blob"})}),Object(j.jsx)("div",{children:Object(j.jsx)("img",{src:M,className:"blob-right",alt:"Blob"})}),Object(j.jsxs)("div",{className:"header-container",children:[Object(j.jsx)("img",{src:L,className:"header-logo",alt:"Logo"}),Object(j.jsx)("span",{children:"Lowympact"})]})]})};a(198);function z(e){var t,a=e.item;"d"===a.label||"e"===a.label?t="red":"c"===a.label?t="yellow":"a"!==a.label&&"b"!==a.label||(t="green");var n="/products/"+a.barcode;return a.bcProductId&&(n+="/"+a.bcProductId),"80135463"===a.barcode&&(a.name="Nutella 200g"),Object(j.jsx)(x.a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:Object(j.jsxs)(u.b,{className:"history-item",to:n,children:[Object(j.jsx)("div",{className:"history-img-container",children:Object(j.jsx)("img",{src:a.image,alt:""})}),Object(j.jsxs)("div",{className:"history-name-container",children:[Object(j.jsx)("div",{className:"history-name",children:a.name}),Object(j.jsx)("div",{className:"history-brand",children:a.brand})]}),Object(j.jsxs)("div",{className:"history-label-container",children:[Object(j.jsx)("div",{style:{color:t},children:"\u25cf"}),Object(j.jsx)("div",{className:"history-label",children:"not-applicable"==a.label?"":a.label})]}),Object(j.jsx)("div",{style:{marginRight:"10px",color:"rgb(41,72,102)"},children:">"})]})})}var R=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){var e=localStorage.getItem("userId"),t=localStorage.getItem("token");e&&t?(n.setState({userId:e}),n.loadHistoryInformations(e)):n.loadLocalStorageHistory(e)},n.loadHistoryInformations=function(e){fetch("https://api.lowympact.fr/api/v1/users/".concat(e,"/history"),{method:"get",credentials:"include",headers:new Headers({authorization:localStorage.getItem("token"),"Content-Type":"application/json","api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043"})}).then((function(e){return e.json()})).then((function(e){console.log(e),n.setState({items:null===e||void 0===e?void 0:e.data,loading:!1})}))},n.loadLocalStorageHistory=function(){var e=JSON.parse(localStorage.getItem("local_history"));n.setState({items:e,loading:!1})},n.state={items:void 0,loading:!0,userId:void 0},n}return Object(i.a)(a,[{key:"render",value:function(){if(this.state.items){var e=Object(j.jsx)(n.Fragment,{});return e=this.loading?Object(j.jsx)("div",{className:"loader",children:Object(j.jsx)("img",{src:"/images/utils/loading.gif",alt:""})}):this.state.items.map((function(e){return Object(j.jsx)("div",{children:Object(j.jsx)(z,{item:e})},e.id)})),0===Object.keys(this.state.items).length?Object(j.jsxs)("div",{children:[Object(j.jsx)(B,{}),Object(j.jsx)(A,{}),Object(j.jsx)(x.a.div,{className:"App",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:Object(j.jsxs)("div",{children:[Object(j.jsx)("img",{src:m,className:"logo",alt:"Fruits"}),Object(j.jsx)("p",{className:"logo-text",children:"Commence \xe0 scanner des produits !"})]})})]}):Object(j.jsxs)("div",{children:[Object(j.jsxs)("div",{className:"screen",children:[Object(j.jsx)("div",{className:"screen-title"}),e]}),Object(j.jsx)(B,{}),Object(j.jsx)(A,{})]})}var t=Object(j.jsxs)("div",{children:[Object(j.jsx)("img",{src:m,className:"logo",alt:"Fruits"}),Object(j.jsx)("p",{className:"logo-text",children:"Commence \xe0 scanner des produits !"})]});return this.state.loading&&(t=Object(j.jsx)("div",{className:"loader",children:Object(j.jsx)("img",{src:"/images/utils/loading.gif",alt:""})})),Object(j.jsxs)("div",{children:[Object(j.jsx)(B,{}),Object(j.jsx)(A,{}),Object(j.jsx)(x.a.div,{className:"App",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:t})]})}}]),a}(n.Component);var U=function(){return Object(j.jsx)("div",{className:"App",children:Object(j.jsxs)("header",{className:"App-header",children:[Object(j.jsx)("img",{src:L,className:"logo",alt:"logo"}),Object(j.jsx)("h1",{children:"Erreur 404"}),Object(j.jsx)(u.b,{to:"/",children:"Retourner \xe0 l'accueil"})]})})};a(65);var V=function(){return Object(j.jsx)("div",{children:"Cr\xe9er un compte"})};var W=function(){return Object(j.jsx)("div",{children:"Me connecter"})};var q=function(){return Object(j.jsxs)("div",{children:["Continuer sans compte ",">"]})},H=a(28),J=a.n(H),Q=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).componentDidMount=function(){e.Verify();var t=window.location.search,a=new URLSearchParams(t);window.innerWidth>1200&&"website"!=a.get("from")&&window.location.assign("https://web.lowympact.fr")},e.Verify=function(){var t=!0,a=localStorage.getItem("token");if(a){var n=J.a.decode(a,{complete:!0}),s=new Date;console.log(n,s.getTime()/1e3),n.payload.exp>=s.getTime()/1e3&&(t=!1)}!1===t&&(console.log("here"),e.props.history.push("/history"))},e.render=function(){return Object(j.jsxs)(x.a.div,{exit:{opacity:0},children:[Object(j.jsx)("div",{className:"login-logo",children:Object(j.jsx)("img",{src:L,className:"logo",alt:"Logo"})}),Object(j.jsx)("div",{className:"login-lowympact",children:"Lowympact"}),Object(j.jsx)(u.b,{to:"/signup",className:"button-account",children:Object(j.jsx)(V,{})}),Object(j.jsx)(u.b,{to:"/signin",className:"button-connect",children:Object(j.jsx)(W,{})}),Object(j.jsx)(u.b,{to:"/history",className:"button-no-account",children:Object(j.jsx)(q,{})}),Object(j.jsx)("div",{className:"logo-fruits",children:Object(j.jsx)("img",{src:m,className:"logo",alt:"Fruits"})})]})},e}return a}(s.a.Component),G=a(320),Y=a(325),Z=a(326),X=(a(310),a(319)),K=a(323),$=a(172),ee=a(14),te=a.n(ee),ae=a(171),ne=a(33),se=a(3),re=a.n(se);re.a.Curve=re.a.Path.extend({options:{},initialize:function(e,t){re.a.setOptions(this,t),this._initialUpdate=!0,this._setPath(e)},getPath:function(){return this._coords},setPath:function(e,t){return this._initialUpdate=!0,this._setPath(e),this.redraw()},getBounds:function(){return this._bounds},_setPath:function(e){this._coords=e,this._bounds=this._computeBounds()},_computeBounds:function(){for(var e,t,a,n=new re.a.LatLngBounds,s=0;s<this._coords.length;s++)if("string"==typeof(a=this._coords[s])||a instanceof String)t=a;else if("H"==t)n.extend([e.lat,a[0]]),e=new re.a.latLng(e.lat,a[0]);else if("V"==t)n.extend([a[0],e.lng]),e=new re.a.latLng(a[0],e.lng);else if("C"==t){var r=new re.a.latLng(a[0],a[1]);a=this._coords[++s];var o=new re.a.latLng(a[0],a[1]);a=this._coords[++s];var c=new re.a.latLng(a[0],a[1]);n.extend(r),n.extend(o),n.extend(c),c.controlPoint1=r,c.controlPoint2=o,e=c}else if("S"==t){o=new re.a.latLng(a[0],a[1]);a=this._coords[++s];c=new re.a.latLng(a[0],a[1]),r=e;if(e.controlPoint2){var i=e.lat-e.controlPoint2.lat,l=e.lng-e.controlPoint2.lng;r=new re.a.latLng(e.lat+i,e.lng+l)}n.extend(r),n.extend(o),n.extend(c),c.controlPoint1=r,c.controlPoint2=o,e=c}else if("Q"==t){var d=new re.a.latLng(a[0],a[1]);a=this._coords[++s];c=new re.a.latLng(a[0],a[1]);n.extend(d),n.extend(c),c.controlPoint=d,e=c}else if("T"==t){c=new re.a.latLng(a[0],a[1]),d=e;if(e.controlPoint){i=e.lat-e.controlPoint.lat,l=e.lng-e.controlPoint.lng;d=new re.a.latLng(e.lat+i,e.lng+l)}n.extend(d),n.extend(c),c.controlPoint=d,e=c}else n.extend(a),e=new re.a.latLng(a[0],a[1]);return n},getCenter:function(){return this._bounds.getCenter()},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updatecurve(this)},_project:function(){var e,t,a,n;this._points=[];for(var s=0;s<this._coords.length;s++)if("string"==typeof(e=this._coords[s])||e instanceof String)this._points.push(e),a=e;else{switch(e.length){case 2:n=this._map.latLngToLayerPoint(e),t=e;break;case 1:"H"==a?(n=this._map.latLngToLayerPoint([t[0],e[0]]),t=[t[0],e[0]]):(n=this._map.latLngToLayerPoint([e[0],t[1]]),t=[e[0],t[1]])}this._points.push(n)}}}),re.a.curve=function(e,t){return new re.a.Curve(e,t)},re.a.SVG.include({_updatecurve:function(e){if(this._setPath(e,this._curvePointsToPath(e._points)),e.options.animate){var t=e._path,a=t.getTotalLength();e.options.dashArray||(t.style.strokeDasharray=a+" "+a),e._initialUpdate&&(t.animate([{strokeDashoffset:a},{strokeDashoffset:0}],e.options.animate),e._initialUpdate=!1)}},_curvePointsToPath:function(e){for(var t,a,n="",s=0;s<e.length;s++)if("string"==typeof(t=e[s])||t instanceof String)n+=a=t;else switch(a){case"H":n+=t.x+" ";break;case"V":n+=t.y+" ";break;default:n+=t.x+","+t.y+" "}return n||"M0 0"}});var oe=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"createLeafletElement",value:function(e){var t=e.positions,a=e.option,n=Object($.a)(e,["positions","option"]);return re.a.curve(t,a,this.getOptions(n))}},{key:"updateLeafletElement",value:function(e,t){t.positions!==e.positions&&this.leafletElement.setPath(t.positions),this.setStyleIfChanged(e,t)}}]),a}(ae.a);oe.propTypes={children:te.a.oneOfType([te.a.arrayOf(te.a.node),te.a.node]),option:te.a.object,positions:te.a.array.isRequired};var ce=Object(ne.b)(oe),ie=(a(62),function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).map=void 0,e.state={zoom:12,swiper:void 0,currentIndex:0,map:void 0},e.getMaterialIcon=function(e){switch(e){case"Charette":return"directions_bike";case"Plane":return"flight_takeoff";case"Train":return"train";case"Boat":return"directions_boat_filled";case"Truck":return"local_shipping";default:return"nature_people"}},e.getTransportMode=function(e){switch(e){case"Charette":return"v\xe9lo";case"Plane":return"avion";case"Train":return"train";case"Boat":return"bateau";case"Truck":return"camion";default:return e}},e.getTranslation=function(e){switch(e){case"maker":return"Fabricant";case"productor":return"Producteur";case"shop":return"Revendeur";default:return e}},e.displaySlides=function(){var t=Object(j.jsx)(s.a.Fragment,{});return e.props.products&&(t=e.props.products.map((function(t){var a,n,s,r,o,c,i,l,d="product-slide-pastille past-green";return(null===(a=t.TransportCO2Impact)||void 0===a?void 0:a.value)>10&&(d="product-slide-pastille past-orange"),(null===(n=t.TransportCO2Impact)||void 0===n?void 0:n.value)>100&&(d="product-slide-pastille past-red"),Object(j.jsx)(X.a,{children:Object(j.jsxs)("div",{className:"product-slide-container",children:[Object(j.jsxs)("div",{className:"product-slide-icon",children:[Object(j.jsx)("span",{class:"material-icons",children:e.getMaterialIcon(t.transport)}),Object(j.jsxs)("div",{className:"product-slide-name",children:[Object(j.jsx)("span",{className:"product-slide-name-product",children:t.productsOutput[0].productName}),Object(j.jsxs)("span",{className:"product-slide-name-transport",children:["Transport en ",e.getTransportMode(t.transport)]})]})]}),Object(j.jsxs)("div",{className:"product-slide-origin-wrapper",children:[Object(j.jsxs)("div",{className:"product-transport-ui",children:[Object(j.jsx)("div",{className:"transport-ui-circle"}),Object(j.jsx)("div",{className:"transport-ui-tiret"}),Object(j.jsx)("div",{className:"transport-ui-circle circle-bis"})]}),Object(j.jsxs)("div",{className:"product-slide-transport-container",children:[Object(j.jsx)("div",{className:"product-slide-bigname",children:Object(j.jsxs)("span",{children:[t.seller.localisation.city,","," ",t.seller.localisation.country]})}),Object(j.jsxs)("div",{className:"product-slide-lowername2",children:[e.getTranslation(null===(s=t.seller)||void 0===s?void 0:s.type),": ",null===(r=t.seller)||void 0===r?void 0:r.name]}),Object(j.jsx)("div",{className:"product-slide-bigname bigname-lower",children:Object(j.jsxs)("span",{children:[t.buyer.localisation.city,","," ",t.buyer.localisation.country]})}),Object(j.jsxs)("div",{className:"product-slide-lowername2",children:[e.getTranslation(null===(o=t.buyer)||void 0===o?void 0:o.type),": ",null===(c=t.buyer)||void 0===c?void 0:c.name]})]})]}),Object(j.jsx)("div",{className:"product-slide-arrow",children:">"}),Object(j.jsxs)("div",{className:"product-slide-consumption",children:[Object(j.jsx)("div",{className:d}),Object(j.jsxs)("div",{children:[Math.round(t.dist.value)," km "]}),Object(j.jsxs)("div",{children:[(null===(i=t.TransportCO2Impact)||void 0===i?void 0:i.value)>1?Math.round(null===(l=t.TransportCO2Impact)||void 0===l?void 0:l.value):"< 1"," ","kg CO2"," "]})]})]})})}))),t},e.handleMarkerClick=function(t,a){var n,s=document.getElementsByClassName("swiper-container");s[0]&&s[0].scrollIntoView({behavior:"smooth"}),a>=(null===(n=e.props.products)||void 0===n?void 0:n.length)?e.state.swiper.slideTo(a-1,500):e.state.swiper.slideTo(a,500);var r=5;if(e.props.products&&e.props.products[a]){var o=e.props.products[a];r=de([o.buyer.localisation.latitude,o.buyer.localisation.longitude],[o.seller.localisation.latitude,o.seller.localisation.longitude])}e.map.leafletElement.flyTo(t,r,{duration:.5})},e.onSlideChange=function(t){e.setState({currentIndex:t});var a=5;if(e.props.products&&e.props.products[t]){var n=e.props.products[t];a=de([n.buyer.localisation.latitude,n.buyer.localisation.longitude],[n.seller.localisation.latitude,n.seller.localisation.longitude]);var s=(parseFloat(n.seller.localisation.latitude)+parseFloat(n.buyer.localisation.latitude))/2,r=(parseFloat(n.seller.localisation.longitude)+parseFloat(n.buyer.localisation.longitude))/2;e.map.leafletElement.flyTo([s,r],a,{duration:.5})}},e.displayMarker=function(){var t=Object(j.jsx)(s.a.Fragment,{});return e.props.products&&(t=e.props.products.map((function(t,a){var n,r,o,c,i,l,d,u,p,b,m=Object(j.jsx)(s.a.Fragment,{}),v=parseFloat(null===t||void 0===t||null===(n=t.buyer)||void 0===n||null===(r=n.localisation)||void 0===r?void 0:r.latitude),h=parseFloat(null===t||void 0===t||null===(o=t.buyer)||void 0===o||null===(c=o.localisation)||void 0===c?void 0:c.longitude),g=Object(j.jsx)(s.a.Fragment,{}),f=parseFloat(null===t||void 0===t||null===(i=t.seller)||void 0===i||null===(l=i.localisation)||void 0===l?void 0:l.latitude),x=parseFloat(null===t||void 0===t||null===(d=t.seller)||void 0===d||null===(u=d.localisation)||void 0===u?void 0:u.longitude),O=0;a===e.state.currentIndex?(p=new re.a.Icon({iconUrl:"/images/utils/map.png",iconRetinaUrl:"/images/utils/map.png",iconSize:new re.a.Point(32,32),className:"leaflet-mark-icon"}),b=new re.a.Icon({iconUrl:"/images/utils/map.png",iconRetinaUrl:"/images/utils/map3.png",iconSize:new re.a.Point(32,32),className:"leaflet-mark-icon"}),O=5):(p=new re.a.Icon({iconUrl:"/images/utils/map2.png",iconRetinaUrl:"/images/utils/map2.png",iconSize:new re.a.Point(25,25),className:"leaflet-mark-icon"}),b=new re.a.Icon({iconUrl:"/images/utils/map2.png",iconRetinaUrl:"/images/utils/map2.png",iconSize:new re.a.Point(25,25),className:"leaflet-mark-icon"})),v&&h&&(m=Object(j.jsx)(G.a,{zIndexOffset:O,icon:p,position:[v,h],onClick:function(){return e.handleMarkerClick([parseFloat(t.buyer.localisation.latitude),parseFloat(t.buyer.localisation.longitude)],a+1)}})),f&&x&&(g=Object(j.jsx)(G.a,{zIndexOffset:O,icon:b,position:[f,x],onClick:function(){return e.handleMarkerClick([parseFloat(t.seller.localisation.latitude),parseFloat(t.seller.localisation.longitude)],a)}}));var y=document.getElementsByClassName("leaflet-interactive");return y&&y[a]&&a===e.state.currentIndex?y[a].setAttribute("stroke","#78be95"):y&&y[a]&&y[a].setAttribute("stroke","#1b3044"),Object(j.jsxs)(s.a.Fragment,{children:[Object(j.jsx)("div",{className:"test",children:Object(j.jsx)(ce,{positions:ue(f,x,v,h),option:{color:"#1b3044",fill:!1,delay:5e3}})}),m,g]})}))),t},e.render=function(){return Object(j.jsxs)("div",{className:"tracability-container",children:[Object(j.jsx)("div",{className:"product-CO2-total-tracability-container",children:Object(j.jsxs)("span",{className:"product-CO2-total-tracability",children:["Impact total carbone :\xa0",Object(j.jsx)("span",{className:"carbon-total-number",children:parseFloat(e.props.totalCO2Traceability).toFixed(1)}),"kg CO2 soit \xa0",Object(j.jsx)("span",{className:"carbon-total-number",children:parseFloat(.05*e.props.totalCO2Traceability/11*1e3).toFixed(1)}),"kms parcourus en voiture"]})}),Object(j.jsxs)(Y.a,{center:[51.505,-.09],zoom:1,minZoom:1,scrollWheelZoom:!0,dragging:!1,maxBounds:[[-90,-180],[90,180]],maxBoundsViscosity:1,ref:function(t){e.map=t,e.props.getBottomRef(t)},whenCreated:function(t){return e.setState({map:t})},children:[Object(j.jsx)(Z.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a>',url:"https://stamen-tiles-{s}.a.ssl.fastly.net/toner-background/{z}/{x}/{y}{r}.png"}),e.displayMarker()]}),Object(j.jsx)(K.a,{spaceBetween:10,slidesPerView:1.2,centeredSlides:!0,onSlideChange:function(t){return e.onSlideChange(t.activeIndex)},onSwiper:function(t){return e.setState({swiper:t})},children:e.displaySlides()})]})},e}return a}(s.a.Component));function le(e){return e*Math.PI/180}function de(e,t){var a=function(e,t){var a=le(e[1]),n=le(e[0]),s=le(t[1]),r=le(t[0]),o=r-n,c=s-a,i=Math.pow(Math.sin(o/2),2)+Math.cos(n)*Math.cos(r)*Math.pow(Math.sin(c/2),2);return 2*Math.asin(Math.sqrt(i))}(e,t);return 9-Math.sqrt(150*a)}function ue(e,t,a,n){var s=[e,t],r=[a,n],o=r[1]-s[1],c=r[0]-s[0],i=Math.sqrt(Math.pow(o,2)+Math.pow(c,2)),l=Math.atan2(c,o),d=i/2/Math.cos(.314),u=l+.314,p=d*Math.cos(u)+s[1];return["M",s,"Q",[d*Math.sin(u)+s[0],p],r]}var pe=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={swiper:void 0},e.renderListAlternatives=function(t){s.a.Fragment;return t.map((function(t){var a="/products/"+t.id;return"8001505005707"===t.id&&(a+="/24"),t.id!==e.props.barcode?Object(j.jsx)(X.a,{children:Object(j.jsxs)("a",{href:a,className:"product-alternative",children:[Object(j.jsx)("div",{children:Object(j.jsx)("img",{src:t.img_url,className:"product-alternative-image",alt:""})}),Object(j.jsxs)("div",{className:"product-alternative-text",children:[Object(j.jsx)("label",{className:"product-alternative-title",children:t.name}),Object(j.jsx)("label",{className:"product-alternative-brand"}),Object(j.jsx)(be,{item:t})]}),Object(j.jsx)("div",{className:"product-alternative-fleche",children:">"})]})},t.id):Object(j.jsx)(s.a.Fragment,{})}))},e.alternativesloop=function(){var t=Object(j.jsx)(s.a.Fragment,{});if(e.props.alternatives&&"loading"!=e.props.alternatives&&""!=e.props.alternatives){var a=Object(j.jsx)(s.a.Fragment,{}),n=Object(j.jsx)(s.a.Fragment,{}),r=Object(j.jsx)(s.a.Fragment,{}),o=Object(j.jsx)(s.a.Fragment,{});switch(e.props.alternatives.a.sort((function(e,t){return t.eco_score-e.eco_score})),e.props.alternatives.b.sort((function(e,t){return t.eco_score-e.eco_score})),e.props.alternatives.c.sort((function(e,t){return t.eco_score-e.eco_score})),e.props.alternatives.d.sort((function(e,t){return t.eco_score-e.eco_score})),e.props.ecoScore){case"a":break;case"b":a=e.renderListAlternatives(e.props.alternatives.a);break;case"c":a=e.renderListAlternatives(e.props.alternatives.a),n=e.renderListAlternatives(e.props.alternatives.b);break;case"d":a=e.renderListAlternatives(e.props.alternatives.a),n=e.renderListAlternatives(e.props.alternatives.b),r=e.renderListAlternatives(e.props.alternatives.c);break;case"e":a=e.renderListAlternatives(e.props.alternatives.a),n=e.renderListAlternatives(e.props.alternatives.b),r=e.renderListAlternatives(e.props.alternatives.c),o=e.renderListAlternatives(e.props.alternatives.d)}t=Object(j.jsxs)(s.a.Fragment,{children:[a," ",n," ",r," ",o]})}return t},e.render=function(){var t="";return t=""===e.props.alternatives?"Pas d'alternatives disponible":"loading"===e.props.alternatives?"Chargement des alternatives ...":"Alternatives",Object(j.jsxs)(s.a.Fragment,{children:[Object(j.jsx)("span",{className:"title-part-environnement",children:t}),e.props.alternatives&&"loading"!=e.props.alternatives&&""!=e.props.alternatives?Object(j.jsx)(K.a,{spaceBetween:0,slidesPerView:1,centeredSlides:!0,onSwiper:function(t){return e.setState({swiper:t})},children:e.alternativesloop()}):Object(j.jsx)(s.a.Fragment,{})]})},e}return a}(s.a.Component);function be(e){var t,a,n=e.item;return n.eco_score<=33?(t="red",a="Mauvais"):n.eco_score>33&&n.eco_score<67?(t="yellow",a="Moyen"):(t="green",a="Bonne"),Object(j.jsxs)("div",{className:"product-alternative-label-position",children:[Object(j.jsxs)("div",{className:"product-alternative-label",children:[Object(j.jsx)("div",{style:{color:t},children:"\u25cf"}),Object(j.jsxs)("div",{className:"product-alternative-label-text",children:[n.eco_score,"/100"]})]}),Object(j.jsx)("div",{className:"product-alternative-label-level ",children:a})]})}var me=a(101),je=a(321),ve=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={polygon:[],activeCountry:""},e.componentDidMount=function(){e.getCountries()},e.setActiveCountry=function(t){console.log(t),e.setState({activeCountry:t})},e.getCountries=function(){var t;null===(t=e.props.origins)||void 0===t||t.map((function(t){"en:ghana"!=t&&fetch("https://api.lowympact.fr/api/v1/countries/".concat(t)).then((function(e){return e.json()})).then((function(t){var a,n=e.state.polygon;console.log(t),t.success&&(null===(a=t.data)||void 0===a?void 0:a.country)&&(n.push({geo:t.data.country.coordinates,name:t.data.country.name}),e.setState({polygon:n,activeCountry:e.state.activeCountry+t.data.country.name+", "}))}))}))},e.render=function(){return 0==e.state.polygon.length?Object(j.jsx)(s.a.Fragment,{}):Object(j.jsxs)("div",{className:"environnement-map-container",children:[Object(j.jsxs)("div",{className:"product-co2-impact-header",children:[Object(j.jsx)("div",{className:"product-co2-impact-logo",children:Object(j.jsx)("div",{className:"material-icons icon-label-co2-impact",children:"place"})}),Object(j.jsxs)("div",{className:"product-co2-impact-title",children:[Object(j.jsx)("div",{className:"product-co2-impact-title-text",children:"Provenance des ingr\xe9dients"}),Object(j.jsxs)("div",{className:"product-co2-impact-title-label",children:["Pays d'origine : ",e.state.activeCountry]})]})]}),Object(j.jsxs)(Y.a,{center:[51.505,-.09],zoom:-1,minZoom:0,className:"environnement-map",scrollWheelZoom:!0,dragging:!1,maxBounds:[[-90,-180],[90,180]],maxBoundsViscosity:1,whenCreated:function(t){return e.setState({map:t})},children:[Object(j.jsx)(Z.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a>',url:"https://stamen-tiles-{s}.a.ssl.fastly.net/toner-background/{z}/{x}/{y}{r}.png"}),e.state.polygon.map((function(t,a){if(t)return Object(j.jsx)(je.a,{onClick:function(){return e.setActiveCountry(t.name)},color:"color:white",fillColor:e.activeCountry==t.name?"blue":"green",opacity:"1",positions:t.geo},a)}))]})]})},e}return a}(s.a.Component),he=(a(311),a.p+"static/media/train.ddba6d4b.png"),ge=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={visible:!1},e.setVisible=function(){e.setState({visible:!e.state.visible})},e.render=function(){var t,a,n,r,o,c,i,l,d,u,p,b,m,v,h,g,f,x,O,y,S,N,w,k,C,I,P,F;console.log(e.props.dataEcoScore);var _=[{image:"agriculture",name:"Agriculture",percent:(100*parseFloat(null===(t=e.props.dataEcoScore)||void 0===t||null===(a=t.agribalyse)||void 0===a?void 0:a.co2_agriculture)/parseFloat(null===(n=e.props.dataEcoScore)||void 0===n||null===(r=n.agribalyse)||void 0===r?void 0:r.co2_total)).toFixed(0)},{image:"local_shipping",name:"Transport",percent:(100*parseFloat(null===(o=e.props.dataEcoScore)||void 0===o||null===(c=o.agribalyse)||void 0===c?void 0:c.co2_transportation)/parseFloat(null===(i=e.props.dataEcoScore)||void 0===i||null===(l=i.agribalyse)||void 0===l?void 0:l.co2_total)).toFixed(0)},{image:"view_in_ar",name:"Emballage",percent:(100*parseFloat(null===(d=e.props.dataEcoScore)||void 0===d||null===(u=d.agribalyse)||void 0===u?void 0:u.co2_packaging)/parseFloat(null===(p=e.props.dataEcoScore)||void 0===p||null===(b=p.agribalyse)||void 0===b?void 0:b.co2_total)).toFixed(0)},{image:"transform",name:"Transformation",percent:(100*parseFloat(null===(m=e.props.dataEcoScore)||void 0===m||null===(v=m.agribalyse)||void 0===v?void 0:v.co2_processing)/parseFloat(null===(h=e.props.dataEcoScore)||void 0===h||null===(g=h.agribalyse)||void 0===g?void 0:g.co2_total)).toFixed(0)},{image:"store",name:"Distribution",percent:(100*parseFloat(null===(f=e.props.dataEcoScore)||void 0===f||null===(x=f.agribalyse)||void 0===x?void 0:x.co2_distribution)/parseFloat(null===(O=e.props.dataEcoScore)||void 0===O||null===(y=O.agribalyse)||void 0===y?void 0:y.co2_total)).toFixed(0)},{image:"microwave",name:"Consommation",percent:(100*parseFloat(null===(S=e.props.dataEcoScore)||void 0===S||null===(N=S.agribalyse)||void 0===N?void 0:N.co2_consumption)/parseFloat(null===(w=e.props.dataEcoScore)||void 0===w||null===(k=w.agribalyse)||void 0===k?void 0:k.co2_total)).toFixed(0)}];return _=_.map((function(e){return Object(j.jsxs)("div",{className:"empreinte-single",children:[Object(j.jsx)("div",{className:"material-icons",children:e.image}),Object(j.jsxs)("div",{className:"name",children:[e.name," : "]}),Object(j.jsxs)("div",{className:"pourcent",children:[e.percent," %"]})]})})),Object(j.jsx)(s.a.Fragment,{children:Object(j.jsxs)("div",{className:"empreinte-carbone-container",onClick:e.setVisible,children:[Object(j.jsxs)("div",{className:"empreinte-carbone-header",children:[Object(j.jsxs)("div",{className:"header-text",children:[Object(j.jsx)("div",{className:"header-main",children:"Empreinte Carbone"}),Object(j.jsx)("div",{className:"header-small",children:"Estim\xe9e en kg de CO2 \xe9quivalent"})]}),Object(j.jsxs)("div",{className:"empreinte-carbone-number",children:[Object(j.jsxs)("span",{children:[parseFloat(null===(C=e.props.dataEcoScore)||void 0===C||null===(I=C.agribalyse)||void 0===I?void 0:I.co2_total).toFixed(2),"kg"]}),Object(j.jsx)("div",{className:"circle"})]})]}),Object(j.jsxs)("div",{className:"empreinte-carbone-equivalent",children:[Object(j.jsx)("div",{className:"icon-container",children:Object(j.jsx)("div",{className:"material-icons",children:Object(j.jsx)("img",{src:he})})}),Object(j.jsxs)("div",{className:"equivalent-container",children:[Object(j.jsx)("div",{className:"text-small",children:"Soit l'\xe9quivalent..."}),Object(j.jsx)("div",{className:"text-big",children:fe(parseFloat(null===(P=e.props.dataEcoScore)||void 0===P||null===(F=P.agribalyse)||void 0===F?void 0:F.co2_total))})]})]}),Object(j.jsx)("div",{className:"empreinte-carbone-repartition",children:Object(j.jsx)("div",{className:e.state.visible?" animation-appear":"animation-disappear",children:_})}),Object(j.jsx)("div",{className:"arrow",children:Object(j.jsx)("div",{className:"material-icons",children:e.state.visible?"arrow_drop_up":"arrow_drop_down"})})]})})},e}return a}(s.a.Component);function fe(e){return e<.5?"D'un aller Paris-Angers en TGV (300km)":e>=.5&&e<1?"D'un aller Paris-Lyon en TGV (420km)":e>=1&&e<1.5?"D'un aller Lyon-Nantes en TGV (800km)":e>=1.5&&e<2?"D'un aller Lille-Marseille en TGV (960km)":e>=2&&e<2.5?"D'un aller Nantes-Nice en TGV (1350km)":e>=2.5&&e<3?"D'un aller-retour Lyon-Nantes en TGV (1600km)":e>=3&&e<4?"D'un aller-retour Paris-Nice en TGV (2000km)":e>=4&&e<5?"De 3 allers Paris-Nice en TGV (3000km)":e>=5&&e<6?"De 2 aller-retours Paris-Nice en TGV (4000km)":e>=6&&e<8?"De 3 aller-retours Paris-Nice en TGV (6000km)":e>=8&&e<12?"De 4 aller-retours Paris-Nice en TGV (8000km)":e>=12?"De plus de 5 aller-retours Paris-Nice en TGV (>10 000km)":void 0}var xe=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={swiper:void 0,currentIndex:0,width:void 0,showTransport:!1,materials:[]},e.getMaterialIcon=function(t){switch(t){case"Transformation":return"transform";case"Arrow":return e.state.showTransport?"arrow_drop_up":"arrow_drop_down";case"Consommation":return"microwave";case"Distribution":return"store";case"Recyclable":return"check_circle_outline";case"Non recyclable":return"highlight_off";case"Truck":return"local_shipping";case"Packaging":return"inventory_2";case"Agriculture":return"agriculture";case"Transport":return"local_shipping";default:return"view_in_ar"}},e.getColor=function(e){return e>67?"green":e<=33?"red":"yellow"},e.getColorImpact=function(e){return e>70?"green":e<=40?"red":"yellow"},e.getLabel=function(e){return e>67?"Bon":e<=33?"Mauvais":"Moyen"},e.getLabelImpact=function(e){return e>60?"Impact fort":e<=30?"Impact faible":"Impact moyen"},e.getLabelImpactPackaging=function(e){return e>2?"Impact faible":e<-2?"Impact fort":"Impact moyen"},e.getColorImpactPackaging=function(e){return e>2?"green":e<-2?"red":"yellow"},e.updateWindowDimensions=function(){e.setState({width:window.innerWidth})},e.displayCO2Repartition=function(t,a,n){return Object(j.jsxs)("div",{className:"product-co2-impact-container",children:[Object(j.jsxs)("div",{className:"product-co2-impact-header",children:[Object(j.jsx)("div",{className:"product-co2-impact-logo",children:Object(j.jsx)("div",{className:"material-icons icon-label-co2-impact",children:e.getMaterialIcon(n)})}),Object(j.jsxs)("div",{className:"product-co2-impact-title",children:[Object(j.jsxs)("div",{className:"product-co2-impact-title-text",children:["CO2 ",n]}),Object(j.jsx)("div",{className:"product-co2-impact-title-label",children:"R\xe9partition"})]})]}),Object(j.jsxs)("div",{className:"product-co2-impact-content",children:[Object(j.jsxs)("div",{className:"product-transport-impact-content-details-text",children:[parseFloat(a).toFixed(3),"kg C02 eq/kg produit"]}),Object(j.jsx)("div",{className:"product-co2-impact-content-progress",children:Object(j.jsx)(me.a,{percentage:parseFloat(100*t).toFixed(1),strokeWidth:window.innerWidth*(1/60),width:.2*window.innerWidth,fontSize:.04*window.innerWidth,primaryColor:["#FF3333","#33FF63"]})})]})]})},e.displayRepartitionAllItems=function(){var t,a,n,r,o,c,i,l,d,u,p,b,m,v,h,g,f,x,O,y,S,N,w,k,C,I,P,F,_,D,E,T,A,L,M,B,z,R,U,V,W,q,H,J,Q,G,Y,Z,X,K,$,ee,te=Object(j.jsx)(s.a.Fragment,{}),ae=Object(j.jsx)(s.a.Fragment,{}),ne=Object(j.jsx)(s.a.Fragment,{}),se=Object(j.jsx)(s.a.Fragment,{}),re=Object(j.jsx)(s.a.Fragment,{}),oe=Object(j.jsx)(s.a.Fragment,{}),ce=Object(j.jsx)(s.a.Fragment,{});(null===(t=e.props.dataEcoScore)||void 0===t||null===(a=t.agribalyse)||void 0===a?void 0:a.co2_agriculture)&&(te=e.displayCO2Repartition((null===(h=e.props.dataEcoScore)||void 0===h||null===(g=h.agribalyse)||void 0===g?void 0:g.co2_agriculture)/(null===(f=e.props.dataEcoScore)||void 0===f||null===(x=f.agribalyse)||void 0===x?void 0:x.co2_total),null===(O=e.props.dataEcoScore)||void 0===O||null===(y=O.agribalyse)||void 0===y?void 0:y.co2_agriculture,"Agriculture"));(null===(n=e.props.dataEcoScore)||void 0===n||null===(r=n.agribalyse)||void 0===r?void 0:r.co2_transportation)&&(ae=e.displayCO2Repartition((null===(S=e.props.dataEcoScore)||void 0===S||null===(N=S.agribalyse)||void 0===N?void 0:N.co2_transportation)/(null===(w=e.props.dataEcoScore)||void 0===w||null===(k=w.agribalyse)||void 0===k?void 0:k.co2_total),null===(C=e.props.dataEcoScore)||void 0===C||null===(I=C.agribalyse)||void 0===I?void 0:I.co2_transportation,"Transport"));(null===(o=e.props.dataEcoScore)||void 0===o||null===(c=o.agribalyse)||void 0===c?void 0:c.co2_consumption)&&(ne=e.displayCO2Repartition((null===(P=e.props.dataEcoScore)||void 0===P||null===(F=P.agribalyse)||void 0===F?void 0:F.co2_consumption)/(null===(_=e.props.dataEcoScore)||void 0===_||null===(D=_.agribalyse)||void 0===D?void 0:D.co2_total),null===(E=e.props.dataEcoScore)||void 0===E||null===(T=E.agribalyse)||void 0===T?void 0:T.co2_consumption,"Consommation"));(null===(i=e.props.dataEcoScore)||void 0===i||null===(l=i.agribalyse)||void 0===l?void 0:l.co2_distribution)&&(se=e.displayCO2Repartition((null===(A=e.props.dataEcoScore)||void 0===A||null===(L=A.agribalyse)||void 0===L?void 0:L.co2_distribution)/(null===(M=e.props.dataEcoScore)||void 0===M||null===(B=M.agribalyse)||void 0===B?void 0:B.co2_total),null===(z=e.props.dataEcoScore)||void 0===z||null===(R=z.agribalyse)||void 0===R?void 0:R.co2_distribution,"Distribution"));(null===(d=e.props.dataEcoScore)||void 0===d||null===(u=d.agribalyse)||void 0===u?void 0:u.co2_packaging)&&(re=e.displayCO2Repartition((null===(U=e.props.dataEcoScore)||void 0===U||null===(V=U.agribalyse)||void 0===V?void 0:V.co2_packaging)/(null===(W=e.props.dataEcoScore)||void 0===W||null===(q=W.agribalyse)||void 0===q?void 0:q.co2_total),null===(H=e.props.dataEcoScore)||void 0===H||null===(J=H.agribalyse)||void 0===J?void 0:J.co2_packaging,"Emballage"));(null===(p=e.props.dataEcoScore)||void 0===p||null===(b=p.agribalyse)||void 0===b?void 0:b.co2_processing)&&(oe=e.displayCO2Repartition((null===(Q=e.props.dataEcoScore)||void 0===Q||null===(G=Q.agribalyse)||void 0===G?void 0:G.co2_processing)/(null===(Y=e.props.dataEcoScore)||void 0===Y||null===(Z=Y.agribalyse)||void 0===Z?void 0:Z.co2_total),null===(X=e.props.dataEcoScore)||void 0===X||null===(K=X.agribalyse)||void 0===K?void 0:K.co2_processing,"Transformation"));(null===(m=e.props.dataEcoScore)||void 0===m||null===(v=m.agribalyse)||void 0===v?void 0:v.co2_total)&&(ce=Object(j.jsxs)("span",{className:"product-CO2-total",children:["Impact carbone g\xe9n\xe9rique :\xa0",Object(j.jsx)("span",{className:"carbon-total-number",children:parseFloat(null===($=e.props.dataEcoScore)||void 0===$||null===(ee=$.agribalyse)||void 0===ee?void 0:ee.co2_total).toFixed(3)}),"kg C02 eq/kg produit"]}));return Object(j.jsxs)(s.a.Fragment,{children:[ce,te,ae,ne,se,re,oe]})},e.handleShowTransport=function(){e.setState({showTransport:!e.state.showTransport})},e.displayTransportImpact=function(){var t,a,n,r,o,c,i,l,d,u,p=Object(j.jsx)(s.a.Fragment,{}),b=void 0,m=void 0,v=void 0,h=0;(null===(t=e.props.dataEcoScore)||void 0===t||null===(a=t.agribalyse)||void 0===a?void 0:a.co2_transportation)&&(b=.5*(null===(c=e.props.dataEcoScore)||void 0===c||null===(i=c.agribalyse)||void 0===i?void 0:i.co2_transportation),h+=1);(null===(n=e.props.dataEcoScore)||void 0===n||null===(r=n.adjustments)||void 0===r||null===(o=r.origins_of_ingredients)||void 0===o?void 0:o.value_fr)&&(m=.5+(null===(l=e.props.dataEcoScore)||void 0===l||null===(d=l.adjustments)||void 0===d||null===(u=d.origins_of_ingredients)||void 0===u?void 0:u.value_fr)*(-1/40),h+=1);h>0&&(b||(b=0),m||(m=0),(v=(b+m)/h)>1&&(v=1),v<0&&(v=0));var g,f,x=Object(j.jsx)(s.a.Fragment,{}),O=Object(j.jsx)(s.a.Fragment,{});b>0&&(x=Object(j.jsxs)("div",{className:"product-transport-impact-content-details-text",children:[parseFloat(null===(g=e.props.dataEcoScore)||void 0===g||null===(f=g.agribalyse)||void 0===f?void 0:f.co2_transportation).toFixed(3),"kg C02 eq/kg produit"]}));return m>0&&(O=Object(j.jsxs)("div",{className:"product-transport-impact-content-details-score",children:["Score environnemental du transport vers la France :",Object(j.jsx)("span",{style:{color:e.getColorImpact(100-100*m)},children:Math.round(99-100*m)}),"/100"]})),!e.props.displayTranportImpact&&v?(v=Math.round(100*v),Object(j.jsxs)("div",{className:"product-transport-impact-container",onClick:e.handleShowTransport,children:[Object(j.jsxs)("div",{className:"product-transport-impact-header",children:[Object(j.jsx)("div",{className:"product-transport-impact-logo",children:Object(j.jsx)("div",{className:"material-icons icon-label-transport-impact",children:e.getMaterialIcon("Truck")})}),Object(j.jsxs)("div",{className:"product-transport-impact-title",children:[Object(j.jsx)("div",{className:"product-transport-impact-title-text",children:"Impact du transport"}),Object(j.jsx)("div",{className:"product-transport-impact-title-label",children:e.getLabelImpact(v)})]}),Object(j.jsx)("div",{className:"product-transport-impact-color-label",style:{color:e.getColorImpact(100-v)},children:"\u25cf"})]}),Object(j.jsx)("div",{className:"arrow-container",children:Object(j.jsx)("div",{className:"material-icons icon-label-arrow",children:e.getMaterialIcon("Arrow")})}),Object(j.jsxs)("div",{className:e.state.showTransport?"animation-appear":"animation-disappear",children:[Object(j.jsxs)("div",{className:"product-transport-impact-content",children:[Object(j.jsx)("div",{className:"product-transport-impact-content-text",children:"Score total :"}),Object(j.jsxs)("div",{className:"product-transport-impact-content-progress",children:[Object(j.jsx)(me.a,{percentage:100-v,strokeWidth:.02*window.innerWidth,width:window.innerWidth*(1/4),fontSize:0,primaryColor:["#33FF63","#FF3333"]}),Object(j.jsxs)("span",{className:"impact-percentage-progressBar",children:[100-v,"/100"]})]})]}),Object(j.jsxs)("div",{className:"product-transport-impact-content-details",children:[x,O]})]})]})):p},e.displayPackagingDetailImpact=function(){var t,a,n,r=Object(j.jsx)(s.a.Fragment,{});if(null===(t=e.props.dataEcoScore)||void 0===t||null===(a=t.adjustments)||void 0===a||null===(n=a.packaging)||void 0===n?void 0:n.packagings){var o,c,i,l=[],d=s.a.Fragment;null===(o=e.props.dataEcoScore)||void 0===o||null===(c=o.adjustments)||void 0===c||null===(i=c.packaging)||void 0===i||i.packagings.map((function(e){"unknown"!=(null===e||void 0===e?void 0:e.material.split(":")[1])&&l.push(null===e||void 0===e?void 0:e.material.split(":")[1])})),d=l.filter((function(e,t){return l.indexOf(e)==t})).map((function(e){var t="";return l.indexOf(e)<l.length-1&&(t=" ; "),Object(j.jsx)(s.a.Fragment,{children:Object(j.jsxs)("span",{children:[e," ",t]})})})),r=l.length>0?Object(j.jsx)(s.a.Fragment,{children:Object(j.jsx)("div",{className:"product-co2-impact-content",children:Object(j.jsxs)("div",{className:"product-packaging-impact-content-details-text",children:["Mat\xe9riaux utilis\xe9s : \xa0",d]})})}):Object(j.jsx)(s.a.Fragment,{children:Object(j.jsx)("div",{className:"product-co2-impact-content",children:Object(j.jsx)("div",{className:"product-packaging-impact-content-details-text",children:"Mat\xe9riaux utilis\xe9s : \xa0 Inconnu"})})})}return r},e.displayPackagingImpact=function(){var t,a,n,r,o,c,i,l,d,u=Object(j.jsx)(s.a.Fragment,{});return(null===(t=e.props.dataEcoScore)||void 0===t||null===(a=t.adjustments)||void 0===a||null===(n=a.packaging)||void 0===n?void 0:n.value)?Object(j.jsxs)("div",{className:"product-co2-impact-container",children:[Object(j.jsxs)("div",{className:"product-co2-impact-header",children:[Object(j.jsx)("div",{className:"product-co2-impact-logo",children:Object(j.jsx)("div",{className:"material-icons icon-label-co2-impact",children:e.getMaterialIcon("")})}),Object(j.jsxs)("div",{className:"product-co2-impact-title",children:[Object(j.jsx)("div",{className:"product-co2-impact-title-text",children:"Impact de l'emballage"}),Object(j.jsx)("div",{className:"product-co2-impact-title-label",children:e.getLabelImpactPackaging(null===(r=e.props.dataEcoScore)||void 0===r||null===(o=r.adjustments)||void 0===o||null===(c=o.packaging)||void 0===c?void 0:c.value)})]}),Object(j.jsx)("div",{className:"product-transport-impact-color-label",style:{color:e.getColorImpactPackaging(null===(i=e.props.dataEcoScore)||void 0===i||null===(l=i.adjustments)||void 0===l||null===(d=l.packaging)||void 0===d?void 0:d.value)},children:"\u25cf"})]}),e.displayPackagingDetailImpact()]}):u},e.render=function(){return e.props.barcode?Object(j.jsxs)(s.a.Fragment,{children:[Object(j.jsx)(ge,{dataEcoScore:e.props.dataEcoScore}),e.props.origins?Object(j.jsx)(ve,{origins:e.props.origins}):Object(j.jsx)(s.a.Fragment,{}),e.displayPackagingImpact(),Object(j.jsx)(pe,{barcode:e.props.barcode,alternatives:e.props.alternatives,ecoScore:e.props.ecoScore})]}):Object(j.jsx)(s.a.Fragment,{})},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}}]),a}(s.a.Component),Oe=(a(312),s.a.Component,a(163),function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={barcode:e.props.match.params.barcode,bcProductId:e.props.match.params.bcProductId,product:void 0,productImageUrl:void 0,productName:void 0,genericName:void 0,ecoScore:void 0,dataEcoScore:void 0,value:0,connected:!1,productData:void 0,userId:void 0,cart:0,totalCO2Traceability:void 0,alternatives:void 0,countries:[]},e.isFlipping=!1,e.getBottomRef=function(t){e.bottomComponent=t},e.componentDidMount=function(){e.Verify();var t=localStorage.getItem("userId");t&&(e.setState({userId:t}),e.loadHistory(t)),e.loadFromOpenFoodFacts(e.props.match.params.barcode),e.props.match.params.bcProductId&&e.loadProductInformations(e.props.match.params.barcode,e.props.match.params.bcProductId)},e.handleBarCodeUpdate=function(){e.state.barcode!==e.props.match.params.barcode&&(e.setState({barcode:e.props.match.params.barcode,bcProductId:e.props.match.params.bcProductId}),e.loadFromOpenFoodFacts(e.props.match.params.barcode),e.props.match.params.bcProductId&&e.loadProductInformations(e.props.match.params.barcode,e.props.match.params.bcProductId))},e.Verify=function(){var t=!0,a=localStorage.getItem("token");if(a){var n=J.a.decode(a,{complete:!0}),s=new Date;n.payload.exp>=s.getTime()/1e3&&(t=!1)}!1===t&&e.setState({connected:!0})},e.loadProductInformations=function(t,a){fetch("https://api.lowympact.fr/api/v1/products/".concat(t,"?bcProductId=").concat(a),{method:"get",credentials:"include",headers:new Headers({"api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043","Content-Type":"application/json"})}).then((function(e){return e.json()})).then((function(t){var a,n,s;e.setState({products:null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.traceability,impact:null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.impact,totalCO2Traceability:null===t||void 0===t||null===(s=t.data)||void 0===s?void 0:s.transportCO2Impact})}))},e.loadAlternatives=function(t,a){e.setState({alternatives:"loading"}),fetch("https://api.lowympact.fr/api/v1/alternatives/".concat(t)).then((function(e){return e.json()})).then((function(t){var a,n,s,r,o,c,i,l,d,u,p,b,m;t.success&&(null===(a=t.data)||void 0===a?void 0:a.alternativesInfos)?0==(null===(n=t.data)||void 0===n||null===(s=n.alternativesInfos)||void 0===s||null===(r=s.a)||void 0===r?void 0:r.length)&&0==(null===(o=t.data)||void 0===o||null===(c=o.alternativesInfos)||void 0===c||null===(i=c.b)||void 0===i?void 0:i.length)&&0==(null===(l=t.data)||void 0===l||null===(d=l.alternativesInfos)||void 0===d||null===(u=d.c)||void 0===u?void 0:u.length)&&0==(null===(p=t.data)||void 0===p||null===(b=p.alternativesInfos)||void 0===b||null===(m=b.d)||void 0===m?void 0:m.length)?e.setState({alternatives:""}):e.setState({alternatives:t.data.alternativesInfos}):e.setState({alternatives:""})}))},e.loadFromOpenFoodFacts=function(t){var a;fetch("https://world.openfoodfacts.org/api/v0/product/".concat(t,".json/")).then((function(e){return e.json()})).then((function(n){var s,r,o,c,i,l,d,u,p=null===n||void 0===n||null===(s=n.product)||void 0===s?void 0:s.image_url,b=null===n||void 0===n||null===(r=n.product)||void 0===r?void 0:r.product_name,m=null===n||void 0===n||null===(o=n.product)||void 0===o?void 0:o.generic_name,j=null===n||void 0===n||null===(c=n.product)||void 0===c?void 0:c.ecoscore_grade;a=null===n||void 0===n||null===(i=n.product)||void 0===i?void 0:i.ecoscore_data,console.log(n);var v=null===n||void 0===n||null===(l=n.product)||void 0===l?void 0:l.origins_hierarchy;v&&""!=v&&e.setState({origins:v}),(null===n||void 0===n?void 0:n.product)&&e.setState({productData:n.product}),p&&e.setState({productImageUrl:p}),b&&e.setState({productName:b}),m&&e.setState({genericName:m}),!j||"a"!==j&&"b"!==j&&"c"!==j&&"d"!==j&&"e"!==j||e.setState({ecoScore:j}),a&&e.setState({dataEcoScore:a}),1===n.status&&e.saveHistory(),"80135463"===t&&e.setState({productName:"Nutella 200g"});var h="a";switch(null===(d=n.product)||void 0===d?void 0:d.ecoscore_grade){case"b":h="a";break;case"c":h="b";break;case"d":case"e":h="c"}"a"!=(null===(u=n.product)||void 0===u?void 0:u.ecoscore_grade)?e.loadAlternatives(n.product.categories_properties["ciqual_food_code:en"],h):e.setState({alternatives:""})}))},e.loadHistory=function(t){t&&e.state.barcode&&e.state.bcProductId&&fetch("https://api.lowympact.fr/api/v1/users/".concat(t,"/cart/").concat(e.state.barcode,"?bcProductAddress=").concat(e.state.bcProductId),{method:"get",credentials:"include",headers:new Headers({Authorization:localStorage.getItem("token"),"api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043","Content-Type":"application/json"})}).then((function(e){return e.json()})).then((function(t){var a;t.success&&e.setState({cart:null===(a=t.data)||void 0===a?void 0:a.quantity})}))},e.saveHistory=Object(k.a)(w.a.mark((function t(){var a,n,s,r;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ye(2e3);case 2:e.state.connected?e.state.userId&&fetch("https://api.lowympact.fr/api/v1/users/".concat(e.state.userId,"/history"),{method:"put",credentials:"include",headers:new Headers({Authorization:localStorage.getItem("token"),"api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043","Content-Type":"application/json"}),body:JSON.stringify({barcode:e.state.barcode,bcProductAddress:e.state.bcProductId})}).then((function(e){return e.json()})).then((function(e){console.log(e)})):(n=JSON.parse(localStorage.getItem("local_history")),s=null,n?s=null===(r=n)||void 0===r?void 0:r.find((function(t){return t.barcode===e.state.barcode&&t.bcProductId==e.state.bcProductId})):n=[],s&&0!==(null===(a=s)||void 0===a?void 0:a.length)||(n.push({barcode:e.state.barcode,bcProductId:e.state.bcProductId,brand:e.state.productData.brands,image:e.state.productImageUrl,label:e.state.ecoScore,name:e.state.productName}),localStorage.setItem("local_history",JSON.stringify(n))));case 3:case"end":return t.stop()}}),t)}))),e.addToCart=function(){if(e.state.barcode&&e.state.cart>=0){var t,a,n,s,r=-1;if(null===(t=e.state.dataEcoScore)||void 0===t||null===(a=t.agribalyse)||void 0===a?void 0:a.co2_total)r=parseFloat(null===(n=e.state.dataEcoScore)||void 0===n||null===(s=n.agribalyse)||void 0===s?void 0:s.co2_total);var o="unkown";e.state.ecoScore&&(o=e.state.ecoScore),e.flip(),fetch("https://api.lowympact.fr/api/v1/users/".concat(e.state.userId,"/cart"),{method:"put",credentials:"include",headers:new Headers({Authorization:localStorage.getItem("token"),"api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043","Content-Type":"application/json"}),body:JSON.stringify({barcode:e.state.barcode,bcProductAddress:e.state.bcProductId,quantityDelta:1,ecoscore:o,carbonImpact:r})}).then((function(e){return e.json()})).then((function(t){console.log(t),t.success&&e.setState({cart:e.state.cart+1})}))}},e.removeFromCart=function(){if(e.state.barcode&&e.state.cart>0){var t,a;e.flip();var n,s,r=-1;if(null===(t=e.state.dataEcoScore)||void 0===t||null===(a=t.agribalyse)||void 0===a?void 0:a.co2_total)r=parseFloat(null===(n=e.state.dataEcoScore)||void 0===n||null===(s=n.agribalyse)||void 0===s?void 0:s.co2_total);var o="unkown";e.state.ecoScore&&(o=e.state.ecoScore),fetch("https://api.lowympact.fr/api/v1/users/".concat(e.state.userId,"/cart"),{method:"put",credentials:"include",headers:new Headers({Authorization:localStorage.getItem("token"),"api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043","Content-Type":"application/json"}),body:JSON.stringify({barcode:e.state.barcode,bcProductAddress:e.state.bcProductId,quantityDelta:-1,ecoscore:o,carbonImpact:r})}).then((function(e){return e.json()})).then((function(t){console.log(t),t.success&&e.setState({cart:e.state.cart-1})}))}},e.flip=function(){var t=Object(k.a)(w.a.mark((function t(a){return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log(e.imageFlip.style.transform),e.imageFlip&&!e.state.isFlipping&&("rotateY(360deg)"===e.imageFlip.style.transform?e.imageFlip.style.transform="rotateY(0deg)":e.imageFlip.style.transform="rotateY(360deg)");case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.displayImage=function(){e.handleBarCodeUpdate();var t=Object(j.jsx)(s.a.Fragment,{}),a=Object(j.jsx)(s.a.Fragment,{}),n=Object(j.jsx)(s.a.Fragment,{}),r=Object(j.jsx)(s.a.Fragment,{});if(e.state.productImageUrl&&(t=Object(j.jsx)("img",{src:e.state.productImageUrl,className:"product-image",alt:"produit"})),e.state.productName&&(a=Object(j.jsx)("div",{className:"product-name",children:e.state.productName})),e.state.ecoScore){var o="color_score_"+e.state.ecoScore;r=Object(j.jsxs)("div",{className:"product-ecoscore-image",children:[Object(j.jsx)("span",{className:"circle-score "+o,children:"\u2b24 "}),"EcoScore :",Object(j.jsx)("span",{className:"uppercase ",children:" "+e.state.ecoScore})]})}else e.state.genericName&&(n=Object(j.jsx)("div",{className:"product-generic-name",children:e.state.genericName}));return Object(j.jsxs)(s.a.Fragment,{children:[e.state.userId?Object(j.jsxs)("div",{className:e.state.cart>0?"add-to-cart green":"add-to-cart",onClick:e.addToCart,children:[Object(j.jsx)("span",{className:"cart-count",children:e.state.cart>0?e.state.cart:""}),Object(j.jsx)("span",{class:"material-icons",children:"add_shopping_cart"})]}):Object(j.jsx)(s.a.Fragment,{}),e.state.cart>0?Object(j.jsx)("div",{className:"remove-from-cart",onClick:e.removeFromCart,children:Object(j.jsx)("span",{class:"material-icons",children:"remove_shopping_cart"})}):Object(j.jsx)(s.a.Fragment,{}),t,a,Object(j.jsxs)("div",{className:"product-bottom-image-div",children:[n,r]})]})},e.handleChange=function(t,a){if(e.setState({value:a}),1===a){var n=document.getElementsByClassName("swiper-container");n[0]&&n[0].scrollIntoView({behavior:"smooth"})}},e.displayNavbar=function(){var t=Object(j.jsx)(s.a.Fragment,{});return e.state.bcProductId&&(t=Object(j.jsxs)("div",{className:"product-navbar-container",children:[Object(j.jsx)("button",{className:0===e.state.value?"product-navbar-button selected":"product-navbar-button",onClick:function(){return e.handleChange("",0)},children:"Environnement"}),Object(j.jsx)("button",{className:1===e.state.value?"product-navbar-button selected":"product-navbar-button",onClick:function(){return e.handleChange("",1)},children:"Tra\xe7abilit\xe9"}),Object(j.jsx)("div",{className:0===e.state.value?"navbar-under nav-left":"navbar-under nav-right"})]})),t},e.render=function(){var t,a=null===(t=e.state.products)||void 0===t?void 0:t.sort((function(e,t){return e.depth>t.depth?-1:1}));return Object(j.jsx)(s.a.Fragment,{children:Object(j.jsxs)("div",{className:"product-page-container",children:[Object(j.jsxs)("div",{className:"product-header-container",children:[Object(j.jsx)("div",{className:"product-history-link",children:Object(j.jsxs)(u.b,{to:"/history",children:[" ","<"," Historique"]})}),Object(j.jsx)("img",{className:"product-bitmap-image",src:"/images/utils/bitmap.png",alt:""})]}),Object(j.jsx)("div",{className:"product-image-container",ref:function(t){return e.imageFlip=t},children:e.displayImage()}),e.displayNavbar(),0===e.state.value?Object(j.jsx)(xe,{dataEcoScore:e.state.dataEcoScore,ecoScore:e.state.ecoScore,origins:e.state.origins,displayTranportImpact:null!==e.props.match.params.bcProductId&&void 0!==e.props.match.params.bcProductId,barcode:e.props.match.params.barcode,alternatives:e.state.alternatives}):Object(j.jsx)("div",{className:"product-bottom-container",children:Object(j.jsx)(ie,{products:a,getBottomRef:e.getBottomRef,totalCO2Traceability:e.state.totalCO2Traceability})}),Object(j.jsx)(A,{barcode:e.props.match.params.barcode,bcProductId:e.props.match.params.bcProductId})]})})},e}return a}(s.a.Component)),ye=function(e){return new Promise((function(t){return setTimeout(t,e)}))},Se=(a(313),function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={connected:!1},e.disconnect=function(){localStorage.clear(),e.props.history.push("/login")},e.componentDidMount=function(){e.Verify()},e.Verify=function(){var t=!0,a=localStorage.getItem("token");if(a){var n=J.a.decode(a,{complete:!0}),s=new Date;n.payload.exp>=s.getTime()/1e3&&(t=!1)}!1===t&&e.setState({connected:!0})},e.displayConnectedProfil=function(){return Object(j.jsxs)(s.a.Fragment,{children:[Object(j.jsx)("h2",{className:"profil-title",children:"Bienvenue sur ton profil!"}),Object(j.jsx)(u.b,{to:"/stats",className:"profil-button",children:"Statistiques"}),Object(j.jsx)(u.b,{to:"/configuration",className:"profil-button",children:"Configuration"}),Object(j.jsx)("div",{onClick:e.disconnect,className:"profil-button",children:"D\xe9connecter"})]})},e.displayUnconnectedProfil=function(){return Object(j.jsxs)(s.a.Fragment,{children:[Object(j.jsx)("h2",{className:"profil-title",children:"Non connect\xe9"}),Object(j.jsx)("p",{children:"Connecte toi pour que ton historique soit sauvegard\xe9 !"}),Object(j.jsx)(u.b,{to:"/login",className:"profil-button",children:"Me Connecter"})]})},e}return Object(i.a)(a,[{key:"render",value:function(){return Object(j.jsxs)("div",{children:[Object(j.jsx)(u.b,{to:"/",children:Object(j.jsx)(B,{})}),Object(j.jsxs)(x.a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"profil-screen",children:[Object(j.jsx)("div",{className:"profil-picture",children:Object(j.jsx)("div",{class:"material-icons",children:"person"})}),this.state.connected?this.displayConnectedProfil():this.displayUnconnectedProfil()]}),Object(j.jsx)(A,{})]})}}]),a}(s.a.Component));var Ne=function(){return Object(j.jsx)("div",{children:"Cr\xe9er mon compte"})},we=new RegExp("^[a-zA-Z0-9._:$!%-]+@[a-zA-Z0-9.-]+.[a-zA-Z]$"),ke=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={userName:"",email:"",password:"",confirmPassword:"",errors:[],redirect:!1,submit:!1},e.signUser=Object(k.a)(w.a.mark((function t(){var a;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://api.lowympact.fr/api/v1/users/",{method:"post",credentials:"include",headers:new Headers({"api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043","Content-Type":"application/json"}),body:JSON.stringify({username:e.state.userName,email:e.state.email,password:e.state.password})}).then((function(e){return e.json()})).then((function(t){console.log(t);var a=[];return t.success?(localStorage.setItem("token",t.token),localStorage.setItem("userId",t._id),e.props.history.push("/history")):a.push("Il y a d\xe9j\xe0 un compte avec ce mail ou une erreur r\xe9seau."),e.setState({errors:a}),a}));case 2:return a=t.sent,t.abrupt("return",a);case 4:case"end":return t.stop()}}),t)}))),e.handleSubmit=function(){var t=Object(k.a)(w.a.mark((function t(a){var n;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),0!==(n=e.validate()).length){t.next=6;break}return t.next=5,e.signUser();case 5:n=t.sent;case 6:0===n.length&&e.setState({redirect:!0});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.displayErrors=function(){s.a.Fragment;return e.state.errors.map((function(e){return Object(j.jsx)("p",{children:e})}))},e}return Object(i.a)(a,[{key:"validate",value:function(){var e=[];return 0===this.state.userName.length&&e.push("Saissez votre nom"),0===this.state.email.length&&e.push("Saissez votre adresse e-mail"),!1===we.test(this.state.email)&&e.push("Saissez une adresse e-mail valide"),this.state.password.length<6&&e.push("Entre un mot de passe. 6 car\xe0cteres minimum requis"),this.state.password!==this.state.confirmPassword&&e.push("Les mots de passe ne correspondent pas"),this.setState({errors:e}),e}},{key:"render",value:function(){var e=this;return this.state.redirect?Object(j.jsx)(p.a,{to:"/history"}):Object(j.jsxs)(s.a.Fragment,{children:[Object(j.jsx)(u.b,{to:"/login",children:Object(j.jsx)(B,{})}),Object(j.jsx)("div",{className:"logo-fruits",children:Object(j.jsx)("img",{src:m,className:"logo",alt:"Fruits"})}),Object(j.jsx)(u.b,{className:"back-button",to:"/login",children:"< Retour"}),Object(j.jsxs)("div",{className:"signup-container",children:[Object(j.jsxs)("form",{className:"forms",children:[Object(j.jsxs)("label",{children:["nom",Object(j.jsx)("input",{className:"input-forms",value:this.state.userName,onChange:function(t){return e.setState({userName:t.target.value})},type:"text"})]}),Object(j.jsxs)("label",{children:["email",Object(j.jsx)("input",{className:"input-forms",value:this.state.email,onChange:function(t){return e.setState({email:t.target.value})},type:"email"})]}),Object(j.jsxs)("label",{children:["mot de passe",Object(j.jsx)("input",{className:"input-forms",value:this.state.password,onChange:function(t){return e.setState({password:t.target.value})},type:"password"})]}),Object(j.jsxs)("label",{children:["confirmer mot de passe",Object(j.jsx)("input",{className:"input-forms",value:this.state.passwordConfirm,onChange:function(t){return e.setState({confirmPassword:t.target.value})},type:"password"})]})]}),Object(j.jsx)("label",{className:"errors-signup",children:this.displayErrors()}),Object(j.jsx)("div",{className:"button-signup",onClick:this.handleSubmit,children:Object(j.jsx)(Ne,{})})]})]})}}]),a}(n.Component);var Ce=function(){return Object(j.jsx)("div",{children:"Me connecter"})};var Ie=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleSubmit=function(e){e.preventDefault();var t=n.state,a=function(e,t){var a=[];return 0===e.length&&a.push(Object(j.jsx)("p",{children:"Saissez votre adresse e-mail"})),0===t.length&&a.push(Object(j.jsx)("p",{children:"Saissez votre mot de passe"})),a}(t.email,t.password);n.setState({errors:a}),0===a.length&&n.Connect()},n.componentDidMount=function(){n.Verify()},n.Verify=function(){var e=!0,t=localStorage.getItem("token");if(t){var a=J.a.decode(t,{complete:!0}),s=new Date;a.payload.exp>=s.getTime()/1e3&&(e=!1)}!1===e&&n.setState({redirect:!0})},n.Connect=function(){fetch("https://api.lowympact.fr/api/v1/users/login",{method:"POST",headers:{"Content-Type":"application/json","api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043"},body:JSON.stringify({email:n.state.email,password:n.state.password})}).then((function(e){return e.json()})).then((function(e){if("No user found"===e.error){n.setState({loginSuccessful:!1});var t=n.state.errors;t.push(Object(j.jsx)("p",{children:"Utilisateur Inconnu"})),n.setState({errors:t})}else if("Incorrect password"!==e.error&&e.success)localStorage.setItem("token",e.token),localStorage.setItem("userId",e._id),n.setState({loginSuccessful:!0,redirect:!0});else{n.setState({loginSuccessful:!1});var a=n.state.errors;a.push(Object(j.jsx)("p",{children:"Mot de passe Incorrect"})),n.setState({errors:a})}}))},n.onPasswordChange=function(){n.setState({password:n.passwordInput.value,email:n.emailInput.value})},n.state={email:"",password:"",errors:[],redirect:!1,loginSuccessful:null},n}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return this.state.redirect?Object(j.jsx)(p.a,{to:"/history"}):Object(j.jsxs)(s.a.Fragment,{children:[Object(j.jsx)(u.b,{to:"/login",children:Object(j.jsx)(B,{})}),Object(j.jsx)("div",{className:"logo-fruits",children:Object(j.jsx)("img",{src:m,className:"logo",alt:"Fruits"})}),Object(j.jsx)(u.b,{className:"back-button",to:"/login",children:"< Retour"}),Object(j.jsxs)("div",{className:"signin-container",children:[Object(j.jsxs)("form",{className:"forms",children:[Object(j.jsxs)("label",{children:["email",Object(j.jsx)("input",{className:"input-forms",value:this.state.email,onChange:this.onPasswordChange,ref:function(t){return e.emailInput=t},type:"email"})]}),Object(j.jsxs)("label",{children:["mot de passe",Object(j.jsx)("input",{className:"input-forms",value:this.state.password,onChange:this.onPasswordChange,ref:function(t){return e.passwordInput=t},type:"password"})]})]}),Object(j.jsx)("label",{className:"errors-signin",children:this.state.errors}),Object(j.jsx)("div",{className:"button-signin",onClick:this.handleSubmit,children:Object(j.jsx)(Ce,{})})]})]})}}]),a}(n.Component),Pe=a(170);var Fe=function(){return Object(j.jsx)("div",{children:"Changer mot de passe"})},_e=(a(314),{id:0,email:"bububu@bababa.com",password:"123456"});var De=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleChange=function(e){e.preventDefault();var t=n.state,a=t.currentPassword,s=t.newPassword,r=t.confirmPassword,o=function(e,t){var a=[];return e.length<6&&a.push(Object(j.jsx)("p",{children:"Entre un mot de passe. 6 caract\xe8res minimum requis"})),e!==t&&a.push(Object(j.jsx)("p",{children:"Les mots de passe ne correspondent pas"})),a}(s,r);console.log(n.state.user.email,a,s,r,o),n.setState({errors:o}),0===o.length&&n.changeUserInfo(n.state.user._id,a,s)},n.changeUserInfo=function(e,t,a){console.log("hey"),fetch("https://api.lowympact.fr/api/v1/users/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json","api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043",authorization:localStorage.getItem("token")},body:JSON.stringify({currentPassword:t,newPassword:a})}).then((function(e){return e.json()})).then((function(e){console.log(e),!1===e.success?n.setState({errors:[].concat(Object(Pe.a)(n.state.errors),[e.error])}):n.setState({redirect:!0})}))},n.Verify=function(){var e=!0,t=localStorage.getItem("token");if(t){var a=J.a.decode(t,{complete:!0}),s=new Date;a.payload.exp>=s.getTime()/1e3&&(e=!1)}!0===e&&n.setState({redirect:!0})},n.componentDidMount=function(){n.Verify();var e=localStorage.getItem("userId");e&&n.loadUserInfo(e)},n.loadUserInfo=function(e){fetch("https://api.lowympact.fr/api/v1/users/".concat(e),{method:"GET",headers:{"Content-Type":"application/json","api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043",authorization:localStorage.getItem("token")}}).then((function(e){return e.json()})).then((function(e){console.log(e),n.setState({user:e.data})}))},n.state={user:_e,currentPassword:"",newPassword:"",confirmPassword:"",errors:[],redirect:!1},n}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return this.state.redirect?Object(j.jsx)(p.a,{to:"/profil"}):(console.log(this.state.redirect),Object(j.jsxs)("div",{className:"screen",children:[Object(j.jsx)(u.b,{to:"/",children:Object(j.jsx)(B,{})}),Object(j.jsx)(A,{}),Object(j.jsx)("div",{className:"logo-fruits",children:Object(j.jsx)("img",{src:m,className:"logo",alt:"Fruits"})}),Object(j.jsx)(u.b,{className:"back-button",to:"/profil",children:"< Retour"}),Object(j.jsx)("div",{className:"configuration-screen-title"}),Object(j.jsx)("div",{className:"errors-change-password",children:this.state.errors}),Object(j.jsxs)("div",{className:"configuration-container",children:[Object(j.jsxs)("div",{className:"configuration-email-block",children:[Object(j.jsx)("div",{children:"email"}),Object(j.jsx)("div",{children:this.state.user.email})]}),Object(j.jsxs)("form",{className:"configuration-form",children:[Object(j.jsx)("label",{children:Object(j.jsx)("input",{placeholder:"mot de passe actuel",className:"input-forms",value:this.state.currentPassword,onChange:function(t){return e.setState({currentPassword:t.target.value})},type:"password"})}),Object(j.jsx)("label",{children:Object(j.jsx)("input",{value:this.state.newPassword,className:"input-forms",onChange:function(t){return e.setState({newPassword:t.target.value})},type:"password",placeholder:"nouveau mot de passe"})}),Object(j.jsx)("label",{children:Object(j.jsx)("input",{placeholder:"confirmation de mdp",className:"input-forms",value:this.state.confirmPassword,onChange:function(t){return e.setState({confirmPassword:t.target.value})},type:"password"})}),Object(j.jsx)(u.b,{className:"button-change-password",onClick:this.handleChange,to:"",children:Object(j.jsx)(Fe,{})})]})]})]}))}}]),a}(n.Component),Ee=a(102),Te=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={swiper:void 0,selectedSegment:void 0},e.displayChart=function(){var t=Object(j.jsx)(s.a.Fragment,{});if(e.props.ecoScoreData&&e.props.cartedProduct>0){var a=[{title:"EcoScore A",value:e.props.ecoScoreData.a,color:"#1e8f4f"},{title:"EcoScore B",value:e.props.ecoScoreData.b,color:"#5fad0c"},{title:"EcoScore C",value:e.props.ecoScoreData.c,color:"#ecb10f"},{title:"EcoScore D",value:e.props.ecoScoreData.d,color:"#ff6f1e"},{title:"EcoScore E",value:e.props.ecoScoreData.e,color:"#df1e1f"},{title:"EcoScore Inconnu",value:e.props.ecoScoreData.unknown,color:"#000000"}];t=Object(j.jsx)(Ee.PieChart,{data:a,lineWidth:30,paddingAngle:1,radius:Ee.PieChart.defaultProps.radius-3,animate:!0,animationDuration:700,label:function(e){var t=e.dataEntry;return"".concat(Math.round(t.percentage),"%")},labelStyle:function(t){return t===e.state.selectedSegment?{fontSize:"6px",fontFamily:"comfortaa",fill:a[t].color}:{fontSize:"0px",fontFamily:"comfortaa",fill:a[t].color}},labelPosition:60,segmentsStyle:{transition:"stroke .3s ease-out",cursor:"pointer"},segmentsShift:function(t){return t===e.state.selectedSegment?3:0},onClick:function(t,a){a===e.state.selectedSegment?(e.setState({selectedSegment:void 0}),e.state.swiper.slideTo(0,500)):(e.setState({selectedSegment:a}),e.state.swiper.slideTo(a+1,500))}})}else t=Object(j.jsx)(x.a.div,{className:"stats-no-product",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:Object(j.jsxs)("div",{children:[Object(j.jsx)("img",{src:m,className:"logo",alt:"Fruits"}),Object(j.jsx)("p",{className:"logo-text",children:"Commence \xe0 scanner des produits !"})]})});return t},e.onSlideChange=function(t){0===t?e.setState({selectedSegment:void 0}):e.setState({selectedSegment:t-1})},e.displaySlides=function(){var t=Object(j.jsx)(s.a.Fragment,{});return e.props.ecoScoreData&&e.props.cartedProduct>0&&(t=Object(j.jsxs)(s.a.Fragment,{children:[Object(j.jsx)(X.a,{children:Object(j.jsx)("div",{className:"stats-slider",children:Object(j.jsx)("img",{className:"stats-ecoscore-full",src:"/images/utils/ecoScoreFull.png",alt:""})})}),Object(j.jsx)(X.a,{children:Object(j.jsxs)("div",{className:"stats-slider",children:[Object(j.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore A : ",e.props.ecoScoreData.a," ",e.props.ecoScoreData.a>1?" produits":" produit"]}),Object(j.jsx)("img",{className:"stats-ecoscore-image",src:"/images/utils/ecoScoreA.png",alt:""})]})}),Object(j.jsx)(X.a,{children:Object(j.jsxs)("div",{className:"stats-slider",children:[Object(j.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore B : ",e.props.ecoScoreData.b," ",e.props.ecoScoreData.b>1?" produits":" produit"]}),Object(j.jsx)("img",{className:"stats-ecoscore-image",src:"/images/utils/ecoScoreB.png",alt:""})]})}),Object(j.jsx)(X.a,{children:Object(j.jsxs)("div",{className:"stats-slider",children:[Object(j.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore C : ",e.props.ecoScoreData.c," ",e.props.ecoScoreData.c>1?" produits":" produit"]}),Object(j.jsx)("img",{className:"stats-ecoscore-image",src:"/images/utils/ecoScoreC.png",alt:""})]})}),Object(j.jsx)(X.a,{children:Object(j.jsxs)("div",{className:"stats-slider",children:[Object(j.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore D : ",e.props.ecoScoreData.d," ",e.props.ecoScoreData.d>1?" produits":" produit"]}),Object(j.jsx)("img",{className:"stats-ecoscore-image",src:"/images/utils/ecoScoreD.png",alt:""})]})}),Object(j.jsx)(X.a,{children:Object(j.jsxs)("div",{className:"stats-slider",children:[Object(j.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore E : ",e.props.ecoScoreData.e," ",e.props.ecoScoreData.e>1?" produits":" produit"]}),Object(j.jsx)("img",{className:"stats-ecoscore-image",src:"/images/utils/ecoScoreE.png",alt:""})]})}),Object(j.jsx)(X.a,{children:Object(j.jsx)("div",{className:"stats-slider",children:Object(j.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore Inconnu : ",e.props.ecoScoreData.unknown," ",e.props.ecoScoreData.unknown>1?" produits":" produit"]})})})]})),t},e.render=function(){return Object(j.jsxs)(s.a.Fragment,{children:[Object(j.jsx)("div",{className:"stats-chart-pie",children:e.displayChart()}),Object(j.jsx)("div",{className:"stats-chart-slider",children:Object(j.jsx)(K.a,{spaceBetween:0,slidesPerView:1,centeredSlides:!0,onSlideChange:function(t){return e.onSlideChange(t.activeIndex)},onSwiper:function(t){return e.setState({swiper:t})},children:e.displaySlides()})})]})},e}return a}(s.a.Component),Ae=a(169),Le=a.n(Ae),Me=["Janvier","F\xe9vrier","Mars","Avril","Mai","Juin","Juillet","Ao\xfbt","Septembre","Octobre","Novembre","D\xe9cembre"],Be=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={selectedSegment:0,options:{chart:{toolbar:{show:!1},dropShadow:{enabled:!0,top:0,left:0,blur:2,opacity:.5}},plotOptions:{bar:{borderRadius:5,horizontal:!0}},xaxis:{categories:["Janvier","F\xe9vrier","Mars","Avril","Mai"],labels:{style:{fontSize:"12px",fontFamily:"Comfortaa",fontColor:"#1b3044"}},title:{text:"CO\u2082 \xe9quivalent (kg)",style:{fontSize:"12px",fontFamily:"Comfortaa",fontColor:"#1b3044"}}},yaxis:{labels:{style:{fontSize:"12px",fontFamily:"Comfortaa",fontColor:"#1b3044"}}},dataLabels:{enabled:!0,style:{fontSize:"10px",fontFamily:"Comfortaa"}},noData:{text:"Chargement..."},fill:{colors:["#ff914d"]},grid:{xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}}}}},e.displayChart=function(){var t=Object(j.jsx)(s.a.Fragment,{});if(e.props.carbonImpactData&&e.props.cartedProduct>0){var a,n=e.props.carbonImpactData.data.length,r=[];switch(e.props.carbonImpactData.unit){case"weekly":var o=new Date;o.setHours(0,0,0,0),o.setDate(o.getDate()+4-(o.getDay()||7));var c=new Date(o.getFullYear(),0,1);a=Math.ceil(((o-c)/864e5+1)/7);for(var i=n-1;i>=0;i--)r.push("Semaine "+(a-i));break;case"monthly":a=(new Date).getMonth();for(var l=(new Date).getFullYear(),d=n-1;d>=0;d--){var u=a-d;u<0?r.push(Me[u+12]+" "+(l-1)):r.push(Me[u]+" "+l)}break;case"yearly":a=(new Date).getFullYear();for(var p=n-1;p>=0;p--)r.push((a-p).toString())}e.state.options.xaxis.categories=r;var b=[{name:"CO\u2082 \xe9quivalent (kg)",data:[]}],v=e.props.carbonImpactData.data;console.log(v),v.sort((function(e,t){return e.offset>t.offset?1:-1})),console.log(v);for(var h=0;h<v.length;h++){var g=0===e.state.selectedSegment?v[h].impact.toFixed(2):(v[h].impact/v[h].nbProducts).toFixed(2);b[0].data.push(g)}t=Object(j.jsx)(s.a.Fragment,{children:Object(j.jsx)("div",{className:"stats-chart-bar",children:Object(j.jsx)(Le.a,{options:e.state.options,series:b,type:"bar",height:350})})})}else t=Object(j.jsx)(x.a.div,{className:"stats-no-product",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:Object(j.jsxs)("div",{children:[Object(j.jsx)("img",{src:m,className:"logo",alt:"Fruits"}),Object(j.jsx)("p",{className:"logo-text",children:"Commence \xe0 scanner des produits !"})]})});return t},e.onSlideChange=function(t){e.setState({selectedSegment:0===e.state.selectedSegment?1:0})},e.displaySlides=function(){var t=Object(j.jsx)(s.a.Fragment,{});return e.props.carbonImpactData&&e.props.cartedProduct>0&&(t=Object(j.jsxs)(s.a.Fragment,{children:[Object(j.jsx)(X.a,{children:Object(j.jsx)("div",{className:"stats-slider",children:Object(j.jsxs)("span",{className:"stats-slider-text",children:[">"," Impact Carbone total"]})})}),Object(j.jsx)(X.a,{children:Object(j.jsx)("div",{className:"stats-slider",children:Object(j.jsxs)("span",{className:"stats-slider-text",children:[">"," Impact Carbone par produit"]})})})]})),t},e.render=function(){return Object(j.jsxs)(s.a.Fragment,{children:[e.displayChart(),Object(j.jsx)("div",{className:"stats-chart-slider",children:Object(j.jsx)(K.a,{spaceBetween:0,slidesPerView:1,centeredSlides:!0,onSlideChange:function(t){return e.onSlideChange(t.activeIndex)},onSwiper:function(t){return e.setState({swiper:t})},children:e.displaySlides()})})]})},e}return a}(s.a.Component),ze=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={ecoScoreData:void 0,carbonImpactData:void 0,username:void 0,scannedProduct:void 0,cartedProduct:void 0,userId:void 0,value:0},e.Verify=function(){var t=!0,a=localStorage.getItem("token");if(a){var n=J.a.decode(a,{complete:!0}),s=new Date;n.payload.exp>=s.getTime()/1e3&&(t=!1)}!1===t&&e.setState({connected:!0})},e.componentDidMount=function(){e.Verify();var t=localStorage.getItem("userId");t&&e.setState({userId:t}),e.loadUserData(t),e.loadEcoScoreData(t,"fromBeginning"),e.loadCarbonImpactData(t,"fromBeginning")},e.loadUserData=function(t){fetch("https://api.lowympact.fr/api/v1/users/".concat(t),{method:"get",credentials:"include",headers:new Headers({authorization:localStorage.getItem("token"),"api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043","Content-Type":"application/json"})}).then((function(e){return e.json()})).then((function(t){var a;console.log(t),e.setState({username:null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.username,scannedProduct:null===t||void 0===t?void 0:t.scannedProduct,cartedProduct:null===t||void 0===t?void 0:t.cartedProduct})}))},e.loadEcoScoreData=function(t,a){fetch("https://api.lowympact.fr/api/v1/users/".concat(t,"/statistics?typeStatistic=ecoscore&typeAggregate=").concat(a),{method:"get",credentials:"include",headers:new Headers({authorization:localStorage.getItem("token"),"api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043","Content-Type":"application/json"})}).then((function(e){return e.json()})).then((function(t){var a;console.log(t),e.setState({ecoScoreData:null===t||void 0===t||null===(a=t.statistics)||void 0===a?void 0:a.ecoscore})}))},e.loadCarbonImpactData=function(t,a){fetch("https://api.lowympact.fr/api/v1/users/".concat(t,"/statistics?typeStatistic=carbonImpact&typeAggregate=").concat(a),{method:"get",credentials:"include",headers:new Headers({authorization:localStorage.getItem("token"),"api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043","Content-Type":"application/json"})}).then((function(e){return e.json()})).then((function(t){var a;console.log(t),e.setState({carbonImpactData:null===t||void 0===t||null===(a=t.statistics)||void 0===a?void 0:a.carbonImpact})}))},e.displayStats=function(){var t=Object(j.jsx)(s.a.Fragment,{}),a=Object(j.jsx)(s.a.Fragment,{});return void 0!==e.state.scannedProduct&&(t=Object(j.jsxs)("div",{className:"stats-header-text",children:[Object(j.jsx)("span",{className:"circle-stats color_score_stats",children:"\u2b24 "}),e.state.scannedProduct>1?"Produits scann\xe9s :":"Produit scann\xe9 :",Object(j.jsxs)("span",{className:"uppercase ",children:[" ",e.state.scannedProduct]})]})),void 0!==e.state.cartedProduct&&(a=Object(j.jsxs)("div",{className:"stats-header-text",children:[Object(j.jsx)("span",{className:"circle-stats color_score_stats",children:"\u2b24 "}),e.state.cartedProduct>1?"Produits achet\xe9s :":"Produit achet\xe9 :",Object(j.jsxs)("span",{className:"uppercase ",children:[" ",e.state.cartedProduct]})]})),Object(j.jsxs)(s.a.Fragment,{children:[t,a]})},e.handleChange=function(t,a){e.setState({value:a})},e.displayNavbar=function(){return Object(j.jsxs)("div",{className:"stats-navbar-container",children:[Object(j.jsx)("button",{className:0===e.state.value?"stats-navbar-button selected":"stats-navbar-button",onClick:function(){return e.handleChange("",0)},children:"EcoScore"}),Object(j.jsx)("button",{className:1===e.state.value?"stats-navbar-button selected":"stats-navbar-button",onClick:function(){return e.handleChange("",1)},children:"Impact Carbone"}),Object(j.jsx)("div",{className:0===e.state.value?"navbar-under nav-left":"navbar-under nav-right"})]})},e.render=function(){return Object(j.jsx)(s.a.Fragment,{children:Object(j.jsxs)("div",{className:"stats-page-container",children:[Object(j.jsxs)("div",{className:"stats-header-container",children:[Object(j.jsx)("div",{className:"stats-profil-link",children:Object(j.jsxs)(u.b,{to:"/profil",children:[" ","<"," Profil"]})}),Object(j.jsx)("img",{className:"stats-bitmap-image",src:"/images/utils/bitmap.png",alt:""})]}),Object(j.jsx)("div",{className:"stats-welcome",children:Object(j.jsx)("span",{className:"stats-welcome-text",children:e.state.username?e.state.username+", voici ton r\xe9capitulatif Lowympact...":""})}),Object(j.jsx)("div",{className:"stats-text-container",children:e.displayStats()}),e.displayNavbar(),0===e.state.value?Object(j.jsx)(Te,{ecoScoreData:e.state.ecoScoreData,scannedProduct:e.state.scannedProduct,cartedProduct:e.state.cartedProduct}):Object(j.jsx)(Be,{carbonImpactData:e.state.carbonImpactData,scannedProduct:e.state.scannedProduct,cartedProduct:e.state.cartedProduct}),Object(j.jsx)(A,{})]})})},e}return a}(s.a.Component),Re=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return Object(j.jsx)(u.a,{children:Object(j.jsx)(b.a,{exitBeforeEnter:!0,children:Object(j.jsxs)(p.d,{children:[Object(j.jsx)(p.b,{path:"/history",component:R,exact:!0},1),Object(j.jsx)(p.b,{path:"/profil",component:Se,exact:!0},2),Object(j.jsx)(p.b,{path:"/login",component:Q,exact:!0}),Object(j.jsx)(p.b,{path:"/",component:Q,exact:!0},1),Object(j.jsx)(p.b,{path:"/products/:barcode/:bcProductId",component:Oe,exact:!0}),Object(j.jsx)(p.b,{path:"/products/:barcode",component:Oe,exact:!0}),Object(j.jsx)(p.b,{path:"/signup",component:ke,exact:!0}),Object(j.jsx)(p.b,{path:"/signin",component:Ie,exact:!0}),Object(j.jsx)(p.b,{path:"/configuration",component:De,exact:!0}),Object(j.jsx)(p.b,{path:"/stats",component:ze,exact:!0}),Object(j.jsx)(p.b,{path:"/test",component:T,exact:!0}),Object(j.jsx)(p.b,{path:"/error404",component:U}),Object(j.jsx)(p.a,{to:"/error404"})]})})})}}]),a}(n.Component),Ue=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,327)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,r=t.getLCP,o=t.getTTFB;a(e),n(e),s(e),r(e),o(e)}))};o.a.render(Object(j.jsx)(s.a.StrictMode,{children:Object(j.jsx)(Re,{})}),document.getElementById("root")),Ue()},65:function(e,t,a){}},[[316,1,2]]]);
//# sourceMappingURL=main.605b0d01.chunk.js.map