(this.webpackJsonplowympact=this.webpackJsonplowympact||[]).push([[8],{302:function(e,t,n){},324:function(e,t,n){"use strict";n.r(t);var a=n(12),s=n(15),r=n(14),c=n(13),i=n(0),o=n.n(i),d=n(50),l=n(48),u=(n(302),n(16)),j=n(55),b=n.n(j),h=n(1),p=function(e){Object(r.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),c=0;c<s;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={connected:!1},e.disconnect=function(){localStorage.clear(),e.props.history.push("/login")},e.componentDidMount=function(){e.Verify()},e.Verify=function(){var t=!0,n=localStorage.getItem("token");if(n){var a=b.a.decode(n,{complete:!0}),s=new Date;a.payload.exp>=s.getTime()/1e3&&(t=!1)}!1===t&&e.setState({connected:!0})},e.displayConnectedProfil=function(){return Object(h.jsxs)(o.a.Fragment,{children:[Object(h.jsx)("h2",{className:"profil-title",children:"Bienvenue sur ton profil!"}),Object(h.jsx)(u.b,{to:"/stats",className:"profil-button",children:"Statistiques"}),Object(h.jsx)(u.b,{to:"/avis",className:"profil-button",children:"Donnez votre avis !"}),Object(h.jsx)(u.b,{to:"/configuration",className:"profil-button",children:"Configuration"}),Object(h.jsxs)("div",{onClick:e.disconnect,className:"profil-button-disconnect",children:[Object(h.jsx)("div",{className:"material-icons",children:"logout"}),Object(h.jsx)("p",{children:"D\xe9connexion"})]})]})},e.displayUnconnectedProfil=function(){return Object(h.jsxs)(o.a.Fragment,{children:[Object(h.jsx)("h2",{className:"profil-title",children:"Non connect\xe9"}),Object(h.jsx)("p",{children:"Connecte toi pour que ton historique soit sauvegard\xe9 !"}),Object(h.jsx)(u.b,{to:"/login",className:"profil-button",children:"Me Connecter"})]})},e}return Object(s.a)(n,[{key:"render",value:function(){return Object(h.jsxs)("div",{children:[Object(h.jsx)(u.b,{to:"/",children:Object(h.jsx)(l.a,{})}),Object(h.jsxs)("div",{className:"profil-screen",children:[Object(h.jsx)("div",{className:"profil-picture",children:Object(h.jsx)("div",{className:"material-icons",children:"person"})}),this.state.connected?this.displayConnectedProfil():this.displayUnconnectedProfil()]}),Object(h.jsx)(d.a,{})]})}}]),n}(o.a.Component);t.default=p},40:function(e,t,n){"use strict";t.a=n.p+"static/media/logo.b235ef42.svg"},44:function(e,t,n){"use strict";t.a=n.p+"static/media/bitmap.6f490d5b.png"},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){"use strict";n(49);var a=n(40),s=n(44),r=n(0),c=n.n(r),i=n(1);t.a=function(e){return Object(i.jsxs)("div",{children:[Object(i.jsx)("div",{children:Object(i.jsx)("img",{src:s.a,className:"blob-top",alt:"Blob"})}),e.history?Object(i.jsx)(c.a.Fragment,{}):Object(i.jsxs)(c.a.Fragment,{children:[Object(i.jsx)("div",{children:Object(i.jsx)("img",{src:s.a,className:"blob-left",alt:"Blob"})}),Object(i.jsx)("div",{children:Object(i.jsx)("img",{src:s.a,className:"blob-right",alt:"Blob"})})," "]}),Object(i.jsxs)("div",{className:"header-container",children:[Object(i.jsx)("img",{src:a.a,className:"header-logo",alt:"Logo"}),Object(i.jsx)("span",{children:"Lowympact"})]})]})}},49:function(e,t,n){},50:function(e,t,n){"use strict";var a=n(12),s=n(15),r=n(14),c=n(13),i=(n(45),n(0)),o=n.n(i),d=(n(46),n(1));var l=function(){return Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{className:"button-logo",children:Object(d.jsx)("span",{className:"material-icons",children:"history"})}),Object(d.jsx)("div",{children:"Historique"})]})};var u=function(){return Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{children:Object(d.jsx)("span",{className:"material-icons",children:"person"})}),Object(d.jsx)("div",{children:"Profil"})]})};var j=function(){return Object(d.jsx)("div",{children:Object(d.jsx)("div",{className:"navbar-scan-icon",children:Object(d.jsx)("span",{className:"material-icons",children:"qr_code_scanner"})})})},b=n(38),h=n.n(b),p=n(39),g=n(75),f=n(76),m=n.n(f),v=n(77),x=n.n(v),O=function(e){Object(r.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),c=0;c<s;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={error:!1,noBackCamera:!1,usedCamera:0,devices:[],processingImage:0,text:0,mutlipleTracks:!1},e.switchCamera=function(){var t=e.state.usedCamera+1;t>=e.state.devices.length&&(t=0),e.setState({usedCamera:t}),m.a.stop(),e.QuaggaInit(e.state.devices[t].deviceId)},e.componentDidMount=Object(p.a)(h.a.mark((function t(){var n,a,s,r,c,i;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=window.location.search,a=new URLSearchParams(n),"false"!=a.get("camera")){t.next=7;break}e.setState({error:!0,text:1}),t.next=23;break;case 7:if(!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)){t.next=22;break}return t.next=10,navigator.mediaDevices.enumerateDevices().then((function(e){return e.filter((function(e){return"videoinput"===e.kind}))}));case 10:return s=t.sent,e.setState({devices:s}),0===(r=s.filter((function(e){return null!=e.label.match(/back/)}))).length&&(e.setState({noBackCamera:!0}),r=s),c=r.map(function(){var t=Object(p.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:n.deviceId}}}).then((function(t){var n=t.getVideoTracks().map((function(e){return e.getCapabilities()}));return t.getTracks().forEach((function(e){return e.stop()})),n.length>1&&e.setState({mutlipleTracks:!0}),n[0]}),(function(e){return console.log(e)}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=17,Promise.all(c);case 17:(i=t.sent).sort((function(e,t){return(e.width.max+e.height.max)/2>(t.width.max+t.height.max)/2?-1:1})),i[0]?e.QuaggaInit(i[0]):e.QuaggaInit({}),t.next=23;break;case 22:e.setState({error:!0,text:3});case 23:case"end":return t.stop()}}),t)}))),e.QuaggaInit=function(t){m.a.init({inputStream:{type:"LiveStream",constraints:Object(g.a)({},t)},locator:{patchSize:"normal",halfSample:!1},locate:!1,area:{top:"40%",right:"25%",left:"25%",bottom:"40%"},numOfWorkers:window.navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader"]},multiple:!1,singleChannel:!1},(function(n){if(n)return e.setState({error:!0,text:n+" "+JSON.stringify(t)}),!1;m.a.start()})),e.props.setQuagga(m.a),m.a.onDetected(e._onDetected)},e._onDetected=function(){var t=Object(p.a)(h.a.mark((function t(n){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.props.onDetected(n);case 2:a=t.sent,console.log(a),a&&m.a.stop();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onDrop=function(t){try{if(1!=e.state.processingImage){e.setState({processingImage:1}),console.log(t[t.length-1]);var n=new FileReader;n.readAsDataURL(t[t.length-1]),n.onloadend=function(){m.a.decodeSingle({decoder:{readers:["ean_reader"]},locate:!0,src:n.result},(function(t){var n;(console.log(t),t)?(e._onDetected(t),e.setState({processingImage:2}),console.log("result",null===(n=t.codeResult)||void 0===n?void 0:n.code)):(console.log("not detected"),e.setState({processingImage:3}))}))}}}catch(a){console.log(a),e.setState({processingImage:4})}},e.setImport=function(){e.setState({error:!e.state.error})},e}return Object(s.a)(n,[{key:"componentWillUnmount",value:function(){m.a.offDetected(this._onDetected)}},{key:"render",value:function(){var e=Object(d.jsx)(o.a.Fragment,{});return 1==this.state.processingImage&&(e=Object(d.jsx)(o.a.Fragment,{children:Object(d.jsx)("p",{children:"Chargement en cours..."})})),2==this.state.processingImage&&(e=Object(d.jsx)(o.a.Fragment,{children:Object(d.jsx)("p",{children:"Ce produit n'existe pas dans la base de donn\xe9es"})})),3==this.state.processingImage&&(e=Object(d.jsx)(o.a.Fragment,{children:Object(d.jsx)("p",{children:"Code barre non trouv\xe9 sur l'image, merci de r\xe9essayer"})})),4==this.state.processingImage&&(e=Object(d.jsx)(o.a.Fragment,{children:Object(d.jsxs)("p",{children:["Mauvais format ou fichier trop grand, merci de r\xe9essayer. ",Object(d.jsx)("br",{}),"Taille max : 5mb ",Object(d.jsx)("br",{}),"Formats: jpg, png, gif"]})})),Object(d.jsxs)(o.a.Fragment,{children:[Object(d.jsx)("div",{id:"interactive",className:this.state.error?"hidden":"viewport"}),this.state.error?Object(d.jsxs)("div",{className:"scan-error",children:[Object(d.jsx)(x.a,{withIcon:!0,withPreview:!1,buttonText:Object(d.jsxs)("div",{className:"button-import",children:[Object(d.jsx)("div",{className:"material-icons",children:"add_a_photo"}),Object(d.jsx)("p",{children:"Prendre une photo"})]}),onChange:this.onDrop,label:"",imgExtension:[".jpg",".gif",".png",".jpeg"],maxFileSize:5242880,labelClass:"import-label"}),Object(d.jsx)("p",{className:"red",children:e}),Object(d.jsxs)("p",{className:"error-message-import",children:["code d'erreur : "+this.state.text,Object(d.jsx)("br",{})]})]}):Object(d.jsx)(o.a.Fragment,{}),this.state.mutlipleTracks?Object(d.jsx)("h1",{className:"debug",children:"If you see this, tell me"}):""]})}}]),n}(i.Component),w=n(78),y=n.n(w),S=(n(79),n(2)),N=(n(47),function(e){Object(r.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),c=0;c<s;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={scanning:!0,status:"",results:[],usedCameraId:"3f6fc4177028f25c3e8215f4444838450630b8d656c627ef511346545d37f302",devices:[],reading:!1,barcode:void 0,bcProductId:void 0,Quagga:void 0},e.setQuagga=function(t){e.state.Quagga&&e.state.Quagga.stop(),e.setState({Quagga:t})},e._scan=function(){e.setState({scanning:!e.state.scanning,status:""})},e._onDetected=function(){var t=Object(p.a)(h.a.mark((function t(n){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=18;break}if(!n.codeResult||!n.codeResult.code){t.next=18;break}return e.setState({results:[n],scanning:!0,status:"waiting"}),t.next=5,fetch("https://world.openfoodfacts.org/api/v0/product/".concat(n.codeResult.code,".json/"));case 5:return a=t.sent,t.next=8,a.json();case 8:if(0===t.sent.status){t.next=16;break}return e.setState({scanning:!1,status:"found",barcode:n.codeResult.code}),e.props.showScanner(!1),e.state.Quagga&&e.state.Quagga.stop(),t.abrupt("return",!0);case 16:return e.setState({scanning:!0,status:"not found"}),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleScan=function(t){if(t){var n=t.split("/");n.length>1&&e.setState({scanning:!1,barcode:n[4],bcProductId:n[5],status:"found"}),e.state.Quagga&&e.state.Quagga.stop()}},e.handleError=function(e){console.error(e)},e.displayQrCode=function(){return"found"!==e.state.status?Object(d.jsx)(y.a,{delay:300,onError:e.handleError,onScan:e.handleScan,style:{width:"100%"},showViewFinder:!1}):Object(d.jsx)(o.a.Fragment,{})},e.displayBarCode=function(){return"found"!==e.state.status?Object(d.jsxs)(o.a.Fragment,{children:[Object(d.jsx)("div",{className:"header",children:Object(d.jsx)("ul",{className:"results",children:e.state.results.map((function(t,n){var a;return Object(d.jsxs)("div",{children:["waiting"===e.state.status?"V\xe9rification du code : "+(null===t||void 0===t||null===(a=t.codeResult)||void 0===a?void 0:a.code):"","not found"===e.state.status?"Code non trouv\xe9, merci de r\xe9essayer":""]},t.codeResult.code+n)}))})}),e.state.scanning?Object(d.jsx)(O,{onDetected:e._onDetected,setQuagga:e.setQuagga,usedCameraId:e.usedCameraId}):null]}):Object(d.jsx)(o.a.Fragment,{})},e.switchReader=function(){e.state.reading?e.setState({reading:!1}):(e.state.Quagga&&e.state.Quagga.stop(),e.setState({reading:!0}))},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return this.state.barcode&&this.state.bcProductId&&(this.props.barcode!==this.state.barcode||this.props.bcProductId!==this.state.bcProductId)?Object(d.jsx)(S.a,{to:"/products/"+this.state.barcode+"/"+this.state.bcProductId}):this.state.barcode&&this.props.barcode!==this.state.barcode?Object(d.jsx)(S.a,{to:"/products/"+this.state.barcode}):Object(d.jsxs)("div",{className:"code-reader-container",children:[Object(d.jsx)("span",{className:"close",onClick:function(){e.state.Quagga&&e.state.Quagga.stop(),e.props.showScanner(!1)},children:"\xd7"}),this.displayBarCode()]})}}]),n}(i.Component)),k=n(16),C=function(e){Object(r.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),c=0;c<s;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={showScanner:!1,barcode:void 0,bcProductId:void 0,height:0},e.updateWindowDimensions=function(){e.setState({height:window.innerHeight})},e.handleScannerButton=function(t){e.setState({showScanner:t})},e.render=function(){return e.state.height<550?Object(d.jsx)(o.a.Fragment,{}):e.state.showScanner?Object(d.jsx)(N,{showScanner:e.handleScannerButton,history:e.props.history}):Object(d.jsx)(o.a.Fragment,{children:Object(d.jsxs)("div",{className:"navbar-container",children:[Object(d.jsx)(k.b,{to:"/history",className:"/history"===window.location.pathname?"navbar-link navbar-text-left navbar-selected":"navbar-link navbar-text-left ",children:Object(d.jsx)(l,{})}),Object(d.jsx)("div",{onClick:function(){return e.handleScannerButton(!0)},children:Object(d.jsx)("div",{className:"navbar-circle",children:Object(d.jsx)(j,{})})}),Object(d.jsx)("span",{className:"navbar-scan-text",children:"Scan"}),Object(d.jsx)(k.b,{to:"/profil",className:"/profil"===window.location.pathname?"navbar-link navbar-text-right navbar-selected":"navbar-link navbar-text-right ",children:Object(d.jsx)(u,{})})]})})},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}}]),n}(o.a.Component);t.a=C},56:function(e,t){},57:function(e,t){},59:function(e,t){},60:function(e,t){},62:function(e,t){},63:function(e,t){},64:function(e,t){},65:function(e,t){},66:function(e,t){},67:function(e,t){},68:function(e,t){},69:function(e,t){}}]);
//# sourceMappingURL=8.4f6d634d.chunk.js.map