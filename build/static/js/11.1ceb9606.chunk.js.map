{"version":3,"sources":["components/Button/ButtonSignup.js","pages/Signup.js"],"names":["ButtonSignup","validEmail","RegExp","Signup","state","userName","email","password","confirmPassword","errors","redirect","submit","signUser","a","fetch","method","credentials","headers","Headers","body","JSON","stringify","username","then","response","json","res","success","localStorage","setItem","token","_id","props","history","push","setState","handleSubmit","e","preventDefault","validate","length","displayErrors","Fragment","map","error","this","test","to","Header","className","src","fruits","alt","value","onChange","evt","target","type","passwordConfirm","onClick","Component"],"mappings":"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","file":"static/js/11.1ceb9606.chunk.js","sourcesContent":["import React from \"react\";\n\nfunction ButtonSignup() {\n  return (\n  <div>\n    Créer mon compte\n  </div>\n  );\n}\n\nexport default ButtonSignup;","import React, { Component } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport ButtonSignup from \"../components/Button/ButtonSignup\";\nimport fruits from \"../assets/images/fruits-vegetables-basket-by-oblik-studio.svg\";\nimport Header from \"../components/Header/Header\";\nimport \"./Login.css\";\nimport { Link } from \"react-router-dom\";\n\nexport const validEmail = new RegExp(\"^[a-zA-Z0-9._:$!%-]+@[a-zA-Z0-9.-]+.[a-zA-Z]$\");\n\nclass Signup extends Component {\n    state = {\n        userName: \"\",\n        email: \"\",\n        password: \"\",\n        confirmPassword: \"\",\n        errors: [],\n        redirect: false,\n        submit: false,\n    };\n\n    validate() {\n        var errors = [];\n        if (this.state.userName.length === 0) {\n            errors.push(\"Saissez votre nom\");\n        }\n        if (this.state.email.length === 0) {\n            errors.push(\"Saissez votre adresse e-mail\");\n        }\n        if (validEmail.test(this.state.email) === false) {\n            errors.push(\"Saissez une adresse e-mail valide\");\n        }\n        if (this.state.password.length < 6) {\n            errors.push(\"Entre un mot de passe. 6 caràcteres minimum requis\");\n        }\n        if (this.state.password !== this.state.confirmPassword) {\n            errors.push(\"Les mots de passe ne correspondent pas\");\n        }\n        this.setState({ errors: errors });\n        return errors;\n    }\n\n    signUser = async () => {\n        let errors = await fetch(`https://api.lowympact.fr/api/v1/users/`, {\n            method: \"post\",\n            credentials: \"include\",\n            headers: new Headers({\n                \"api-key\": \"99d8fb95-abdd-4885-bf6c-3a81d8874043\",\n                \"Content-Type\": \"application/json\",\n            }),\n            body: JSON.stringify({\n                username: this.state.userName,\n                email: this.state.email,\n                password: this.state.password,\n            }),\n        })\n            .then((response) => response.json())\n            .then((res) => {\n                //console.log(res);\n                let errors = [];\n\n                if (!res.success) {\n                    errors.push(\"Il y a déjà un compte avec ce mail ou une erreur réseau.\");\n                } else {\n                    localStorage.setItem(\"token\", res.token);\n                    localStorage.setItem(\"userId\", res._id);\n                    this.props.history.push(\"/history\");\n                }\n                this.setState({ errors: errors });\n                return errors;\n            });\n        return errors;\n    };\n\n    handleSubmit = async (e) => {\n        e.preventDefault();\n        let errors = this.validate();\n        ////console.log(\"errors: \" + errors);\n        if (errors.length === 0) {\n            errors = await this.signUser();\n        }\n        if (errors.length === 0) {\n            this.setState({ redirect: true });\n        }\n    };\n\n    displayErrors = () => {\n        let errors = <React.Fragment></React.Fragment>;\n        errors = this.state.errors.map((error) => {\n            return <p>{error}</p>;\n        });\n        return errors;\n    };\n\n    render() {\n        if (this.state.redirect) {\n            return <Redirect to=\"/history\" />;\n        }\n        ////console.log(\"render\");\n        return (\n            <React.Fragment>\n                <Link to=\"/login\">\n                    <Header />\n                </Link>\n                <div className=\"logo-fruits\">\n                    <img src={fruits} className=\"logo\" alt=\"Fruits\" />\n                </div>\n                <Link className=\"back-button\" to=\"/login\">\n                    {\"< Retour\"}\n                </Link>\n                <div className=\"signup-container\">\n                    <form className=\"forms\">\n                        <label>\n                            nom\n                            <input\n                                className=\"input-forms\"\n                                value={this.state.userName}\n                                onChange={(evt) =>\n                                    this.setState({\n                                        userName: evt.target.value,\n                                    })\n                                }\n                                type=\"text\"\n                            />\n                        </label>\n                        <label>\n                            email\n                            <input\n                                className=\"input-forms\"\n                                value={this.state.email}\n                                onChange={(evt) => this.setState({ email: evt.target.value })}\n                                type=\"email\"\n                            />\n                        </label>\n                        <label>\n                            mot de passe\n                            <input\n                                className=\"input-forms\"\n                                value={this.state.password}\n                                onChange={(evt) =>\n                                    this.setState({\n                                        password: evt.target.value,\n                                    })\n                                }\n                                type=\"password\"\n                            />\n                        </label>\n                        <label>\n                            confirmer mot de passe\n                            <input\n                                className=\"input-forms\"\n                                value={this.state.passwordConfirm}\n                                onChange={(evt) =>\n                                    this.setState({\n                                        confirmPassword: evt.target.value,\n                                    })\n                                }\n                                type=\"password\"\n                            />\n                        </label>\n                    </form>\n                    <label className=\"errors-signup\">{this.displayErrors()}</label>\n                    <div className=\"button-signup\" onClick={this.handleSubmit}>\n                        <ButtonSignup />\n                    </div>\n                </div>\n            </React.Fragment>\n        );\n    }\n}\nexport default Signup;\n"],"sourceRoot":""}