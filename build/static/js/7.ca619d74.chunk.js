(this.webpackJsonplowympact=this.webpackJsonplowympact||[]).push([[7],{301:function(e,t,a){},337:function(e,t,a){"use strict";a.r(t);var s=a(12),c=a(14),r=a(13),o=a(1),n=a.n(o),i=a(43),l=a(330),d=a(334),p=(a(300),a(324)),u=a(47),j=a(293),m=a(2),b=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(){var e;Object(s.a)(this,a);for(var c=arguments.length,r=new Array(c),o=0;o<c;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={swiper:void 0,selectedSegment:void 0},e.displayChart=function(){var t=Object(m.jsx)(n.a.Fragment,{});if(e.props.ecoScoreData&&e.props.cartedProduct>0){var a=[{title:"EcoScore A",value:e.props.ecoScoreData.a,color:"#1e8f4f"},{title:"EcoScore B",value:e.props.ecoScoreData.b,color:"#5fad0c"},{title:"EcoScore C",value:e.props.ecoScoreData.c,color:"#ecb10f"},{title:"EcoScore D",value:e.props.ecoScoreData.d,color:"#ff6f1e"},{title:"EcoScore E",value:e.props.ecoScoreData.e,color:"#df1e1f"},{title:"EcoScore Inconnu",value:e.props.ecoScoreData.unknown,color:"#000000"}];t=Object(m.jsx)(p.PieChart,{data:a,lineWidth:30,paddingAngle:1,radius:p.PieChart.defaultProps.radius-3,animate:!0,animationDuration:700,label:function(e){var t=e.dataEntry;return"".concat(Math.round(t.percentage),"%")},labelStyle:function(t){return t==e.state.selectedSegment?{fontSize:"6px",fontFamily:"comfortaa",fill:a[t].color}:{fontSize:"0px",fontFamily:"comfortaa",fill:a[t].color}},labelPosition:60,segmentsStyle:{transition:"stroke .3s ease-out",cursor:"pointer"},segmentsShift:function(t){return t==e.state.selectedSegment?3:0},onClick:function(t,a){a==e.state.selectedSegment?(e.setState({selectedSegment:void 0}),e.state.swiper.slideTo(0,500)):(e.setState({selectedSegment:a}),e.state.swiper.slideTo(a+1,500))}})}else t=Object(m.jsx)(j.a.div,{className:"stats-no-product",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:Object(m.jsxs)("div",{children:[Object(m.jsx)("img",{src:u.a,className:"logo",alt:"Fruits"}),Object(m.jsx)("p",{className:"logo-text",children:"Commence \xe0 scanner des produits !"})]})});return t},e.onSlideChange=function(t){0==t?e.setState({selectedSegment:void 0}):e.setState({selectedSegment:t-1})},e.displaySlides=function(){var t=Object(m.jsx)(n.a.Fragment,{});return e.props.ecoScoreData&&e.props.cartedProduct>0&&(t=Object(m.jsxs)(n.a.Fragment,{children:[Object(m.jsx)(l.a,{children:Object(m.jsx)("div",{className:"stats-slider",children:Object(m.jsx)("img",{className:"stats-ecoscore-full",src:"/images/utils/ecoScoreFull.png",alt:""})})}),Object(m.jsx)(l.a,{children:Object(m.jsxs)("div",{className:"stats-slider",children:[Object(m.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore A : ",e.props.ecoScoreData.a," ",e.props.ecoScoreData.a>1?" produits":" produit"]}),Object(m.jsx)("img",{className:"stats-ecoscore-image",src:"/images/utils/ecoScoreA.png",alt:""})]})}),Object(m.jsx)(l.a,{children:Object(m.jsxs)("div",{className:"stats-slider",children:[Object(m.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore B : ",e.props.ecoScoreData.b," ",e.props.ecoScoreData.b>1?" produits":" produit"]}),Object(m.jsx)("img",{className:"stats-ecoscore-image",src:"/images/utils/ecoScoreB.png",alt:""})]})}),Object(m.jsx)(l.a,{children:Object(m.jsxs)("div",{className:"stats-slider",children:[Object(m.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore C : ",e.props.ecoScoreData.c," ",e.props.ecoScoreData.c>1?" produits":" produit"]}),Object(m.jsx)("img",{className:"stats-ecoscore-image",src:"/images/utils/ecoScoreC.png",alt:""})]})}),Object(m.jsx)(l.a,{children:Object(m.jsxs)("div",{className:"stats-slider",children:[Object(m.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore D : ",e.props.ecoScoreData.d," ",e.props.ecoScoreData.d>1?" produits":" produit"]}),Object(m.jsx)("img",{className:"stats-ecoscore-image",src:"/images/utils/ecoScoreD.png",alt:""})]})}),Object(m.jsx)(l.a,{children:Object(m.jsxs)("div",{className:"stats-slider",children:[Object(m.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore E : ",e.props.ecoScoreData.e," ",e.props.ecoScoreData.e>1?" produits":" produit"]}),Object(m.jsx)("img",{className:"stats-ecoscore-image",src:"/images/utils/ecoScoreE.png",alt:""})]})}),Object(m.jsx)(l.a,{children:Object(m.jsx)("div",{className:"stats-slider",children:Object(m.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore Inconnu : ",e.props.ecoScoreData.unknown," ",e.props.ecoScoreData.unknown>1?" produits":" produit"]})})})]})),t},e.render=function(){return Object(m.jsxs)(n.a.Fragment,{children:[Object(m.jsx)("div",{className:"stats-chart-pie",children:e.displayChart()}),Object(m.jsx)("div",{className:"stats-chart-slider",children:Object(m.jsx)(d.a,{spaceBetween:0,slidesPerView:1,centeredSlides:!0,onSlideChange:function(t){return e.onSlideChange(t.activeIndex)},onSwiper:function(t){return e.setState({swiper:t})},children:e.displaySlides()})})]})},e}return a}(n.a.Component),h=a(325),v=a.n(h),f=["Janvier","F\xe9vrier","Mars","Avril","Mai","Juin","Juillet","Ao\xfbt","Septembre","Octobre","Novembre","D\xe9cembre"],g=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(){var e;Object(s.a)(this,a);for(var c=arguments.length,r=new Array(c),o=0;o<c;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={selectedSegment:0,options:{chart:{toolbar:{show:!1},dropShadow:{enabled:!0,top:0,left:0,blur:2,opacity:.5}},plotOptions:{bar:{borderRadius:5,horizontal:!0}},xaxis:{categories:["Janvier","F\xe9vrier","Mars","Avril","Mai"],labels:{style:{fontSize:"12px",fontFamily:"Comfortaa",fontColor:"#1b3044"}},title:{text:"CO\u2082 \xe9quivalent (kg)",style:{fontSize:"12px",fontFamily:"Comfortaa",fontColor:"#1b3044"}}},yaxis:{labels:{style:{fontSize:"12px",fontFamily:"Comfortaa",fontColor:"#1b3044"}}},dataLabels:{enabled:!0,style:{fontSize:"10px",fontFamily:"Comfortaa"}},noData:{text:"Chargement..."},fill:{colors:["#ff914d"]},grid:{xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}}}}},e.displayChart=function(){var t=Object(m.jsx)(n.a.Fragment,{});if(e.props.carbonImpactData&&e.props.cartedProduct>0){var a,s=e.props.carbonImpactData.data.length,c=[];switch(e.props.carbonImpactData.unit){case"weekly":var r=new Date;r.setHours(0,0,0,0),r.setDate(r.getDate()+4-(r.getDay()||7));var o=new Date(r.getFullYear(),0,1);a=Math.ceil(((r-o)/864e5+1)/7);for(var i=s-1;i>=0;i--)c.push("Semaine "+(a-i));break;case"monthly":a=(new Date).getMonth();for(var l=(new Date).getFullYear(),d=s-1;d>=0;d--){var p=a-d;p<0?c.push(f[p+12]+" "+(l-1)):c.push(f[p]+" "+l)}break;case"yearly":a=(new Date).getFullYear();for(var b=s-1;b>=0;b--)c.push((a-b).toString());break;default:a=(new Date).getFullYear();for(var h=s-1;h>=0;h--)c.push((a-h).toString())}e.state.options.xaxis.categories=c;var g=[{name:"CO\u2082 \xe9quivalent (kg)",data:[]}],x=e.props.carbonImpactData.data;x.sort((function(e,t){return e.offset>t.offset?1:-1}));for(var S=0;S<x.length;S++){var O=0===e.state.selectedSegment?x[S].impact.toFixed(2):(x[S].impact/x[S].nbProducts).toFixed(2);g[0].data.push(O)}t=Object(m.jsx)(n.a.Fragment,{children:Object(m.jsx)("div",{className:"stats-chart-bar",children:Object(m.jsx)(v.a,{options:e.state.options,series:g,type:"bar",height:350})})})}else t=Object(m.jsx)(j.a.div,{className:"stats-no-product",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:Object(m.jsxs)("div",{children:[Object(m.jsx)("img",{src:u.a,className:"logo",alt:"Fruits"}),Object(m.jsx)("p",{className:"logo-text",children:"Commence \xe0 scanner des produits !"})]})});return t},e.onSlideChange=function(t){e.setState({selectedSegment:0===e.state.selectedSegment?1:0})},e.displaySlides=function(){var t=Object(m.jsx)(n.a.Fragment,{});return e.props.carbonImpactData&&e.props.cartedProduct>0&&(t=Object(m.jsxs)(n.a.Fragment,{children:[Object(m.jsx)(l.a,{children:Object(m.jsx)("div",{className:"stats-slider",children:Object(m.jsxs)("span",{className:"stats-slider-text",children:[">"," Impact Carbone total"]})})}),Object(m.jsx)(l.a,{children:Object(m.jsx)("div",{className:"stats-slider",children:Object(m.jsxs)("span",{className:"stats-slider-text",children:[">"," Impact Carbone par produit"]})})})]})),t},e.render=function(){return Object(m.jsxs)(n.a.Fragment,{children:[e.displayChart(),Object(m.jsx)("div",{className:"stats-chart-slider",children:Object(m.jsx)(d.a,{spaceBetween:0,slidesPerView:1,centeredSlides:!0,onSlideChange:function(t){return e.onSlideChange(t.activeIndex)},onSwiper:function(t){return e.setState({swiper:t})},children:e.displaySlides()})})]})},e}return a}(n.a.Component),x=(a(301),a(11)),S=a(56),O=a.n(S),y=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(){var e;Object(s.a)(this,a);for(var c=arguments.length,r=new Array(c),o=0;o<c;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={ecoScoreData:void 0,carbonImpactData:void 0,username:void 0,scannedProduct:void 0,cartedProduct:void 0,userId:void 0,value:0},e.Verify=function(){var t=!0,a=localStorage.getItem("token");if(a){var s=O.a.decode(a,{complete:!0}),c=new Date;s.payload.exp>=c.getTime()/1e3&&(t=!1)}!1===t&&e.setState({connected:!0})},e.componentDidMount=function(){e.Verify();var t=localStorage.getItem("userId");t&&e.setState({userId:t}),e.loadUserData(t),e.loadEcoScoreData(t,"fromBeginning"),e.loadCarbonImpactData(t,"fromBeginning")},e.loadUserData=function(t){fetch("https://api.lowympact.fr/api/v1/users/".concat(t),{method:"get",credentials:"include",headers:new Headers({authorization:localStorage.getItem("token"),"api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043","Content-Type":"application/json"})}).then((function(e){return e.json()})).then((function(t){var a;e.setState({username:null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.username,scannedProduct:null===t||void 0===t?void 0:t.scannedProduct,cartedProduct:null===t||void 0===t?void 0:t.cartedProduct})}))},e.loadEcoScoreData=function(t,a){fetch("https://api.lowympact.fr/api/v1/users/".concat(t,"/statistics?typeStatistic=ecoscore&typeAggregate=").concat(a),{method:"get",credentials:"include",headers:new Headers({authorization:localStorage.getItem("token"),"api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043","Content-Type":"application/json"})}).then((function(e){return e.json()})).then((function(t){var a;e.setState({ecoScoreData:null===t||void 0===t||null===(a=t.statistics)||void 0===a?void 0:a.ecoscore})}))},e.loadCarbonImpactData=function(t,a){fetch("https://api.lowympact.fr/api/v1/users/".concat(t,"/statistics?typeStatistic=carbonImpact&typeAggregate=").concat(a),{method:"get",credentials:"include",headers:new Headers({authorization:localStorage.getItem("token"),"api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043","Content-Type":"application/json"})}).then((function(e){return e.json()})).then((function(t){var a;e.setState({carbonImpactData:null===t||void 0===t||null===(a=t.statistics)||void 0===a?void 0:a.carbonImpact})}))},e.displayStats=function(){var t=Object(m.jsx)(n.a.Fragment,{}),a=Object(m.jsx)(n.a.Fragment,{});return void 0!==e.state.scannedProduct&&(t=Object(m.jsxs)("div",{className:"stats-header-text",children:[Object(m.jsx)("span",{className:"circle-stats color_score_stats",children:"\u2b24 "}),e.state.scannedProduct>1?"Produits scann\xe9s :":"Produit scann\xe9 :",Object(m.jsxs)("span",{className:"uppercase ",children:[" ",e.state.scannedProduct]})]})),void 0!==e.state.cartedProduct&&(a=Object(m.jsxs)("div",{className:"stats-header-text",children:[Object(m.jsx)("span",{className:"circle-stats color_score_stats",children:"\u2b24 "}),e.state.cartedProduct>1?"Produits achet\xe9s :":"Produit achet\xe9 :",Object(m.jsxs)("span",{className:"uppercase ",children:[" ",e.state.cartedProduct]})]})),Object(m.jsxs)(n.a.Fragment,{children:[t,a]})},e.handleChange=function(t,a){e.setState({value:a})},e.displayNavbar=function(){return Object(m.jsxs)("div",{className:"stats-navbar-container",children:[Object(m.jsx)("button",{className:0===e.state.value?"stats-navbar-button selected":"stats-navbar-button",onClick:function(){return e.handleChange("",0)},children:"EcoScore"}),Object(m.jsx)("button",{className:1===e.state.value?"stats-navbar-button selected":"stats-navbar-button",onClick:function(){return e.handleChange("",1)},children:"Impact Carbone"}),Object(m.jsx)("div",{className:0===e.state.value?"navbar-under nav-left":"navbar-under nav-right"})]})},e.render=function(){return Object(m.jsx)(n.a.Fragment,{children:Object(m.jsxs)("div",{className:"stats-page-container",children:[Object(m.jsxs)("div",{className:"stats-header-container",children:[Object(m.jsx)("div",{className:"stats-profil-link",children:Object(m.jsxs)(x.b,{to:"/profil",children:[" ","<"," Profil"]})}),Object(m.jsx)("img",{className:"stats-bitmap-image",src:"/images/utils/bitmap.png",alt:""})]}),Object(m.jsx)("div",{className:"stats-welcome",children:Object(m.jsx)("span",{className:"stats-welcome-text",children:e.state.username?e.state.username+", voici ton r\xe9capitulatif Lowympact...":""})}),Object(m.jsx)("div",{className:"stats-text-container",children:e.displayStats()}),e.displayNavbar(),0===e.state.value?Object(m.jsx)(b,{ecoScoreData:e.state.ecoScoreData,scannedProduct:e.state.scannedProduct,cartedProduct:e.state.cartedProduct}):Object(m.jsx)(g,{carbonImpactData:e.state.carbonImpactData,scannedProduct:e.state.scannedProduct,cartedProduct:e.state.cartedProduct}),Object(m.jsx)(i.a,{})]})})},e}return a}(n.a.Component);t.default=y}}]);
//# sourceMappingURL=7.ca619d74.chunk.js.map