(this.webpackJsonplowympact=this.webpackJsonplowympact||[]).push([[0],{150:function(e,t,n){},151:function(e,t,n){},152:function(e,t,n){},153:function(e,t,n){},155:function(e,t,n){},167:function(e,t,n){},168:function(e,t,n){},174:function(e,t){},176:function(e,t){},189:function(e,t){},191:function(e,t){},219:function(e,t){},221:function(e,t){},222:function(e,t){},227:function(e,t){},229:function(e,t){},248:function(e,t){},260:function(e,t){},263:function(e,t){},281:function(e,t,n){},283:function(e,t,n){},284:function(e,t,n){},285:function(e,t,n){},286:function(e,t,n){},287:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(141),s=n.n(o),c=(n(150),n(8)),i=n(14),l=n(10),d=n(9),u=n(6),p=n(12),j=(n(151),n.p+"static/media/fruits-vegetables-basket-by-oblik-studio.7d5e1c64.svg"),b=(n(152),n(153),n(0));var h=function(){return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:"button-logo",children:Object(b.jsx)("span",{class:"material-icons",children:"history"})}),Object(b.jsx)("div",{children:"Historique"})]})};var m=function(){return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{children:Object(b.jsx)("span",{class:"material-icons",children:"person"})}),Object(b.jsx)("div",{children:"Profil"})]})};var f=function(){return Object(b.jsx)("div",{children:Object(b.jsx)("div",{className:"navbar-scan-icon",children:Object(b.jsx)("span",{class:"material-icons",children:"qr_code_scanner"})})})},v=n(45),g=(n(155),Object(v.configure)("ASHf6Cx7DGz5BbkR5RWee94Ezm55DtkCAFB5HoNVQLhPf8gUhk8ypmZ72tbfAdIo33/I2gZR9pcXcdBwQGyYu69PkahqLA0dEEN5WFtpVEjMfQMiBhwmRWIJQgn+E54DiwJm/5CjsV1+Uy7AJWXnvrLiuwxG2D/b7b1QoPFJfkKp2OSreWJXnV/kJ+rtqFyNOu2wQb5Rq5IFXOU/tnjlTvJp8Kxl4jezOVoWlQZreaLKfxfBforPArJErC16cldrqFULYUdsPqb4Vn27hWUmPQTfaX/SbeDCl1h++IPmcvRpzwM9hY0ti7zzfhBKg3TgEYTMiPUipakmM21mU92xYjA9kmKO6bOjzY4XqyrWBUzv/C1TwJfK1aZDDLH8BOmqqJILi2Ty9fN84y09vBgv0dfXhQa3Q0/UW0Hnv0Xge2am3RY5dmE6pfWaxYyA3fDj920DpnlUNcAsfdErnvpZz8H1eftw6D2w3ps6q3jNFc/CTkALFZOk9Sy2u+lOfzvjKrcz5d1yoSo1sVhFsLWNUoaoHTP6NPnQaawC1YwPRp90T+2yNfx+iESAhn3qfn2pOEpBG0rHdZNLLj1yeNJU9Pjt7dznNeCJwG2SzSQvPZU5HzLuIu+siWjUPStB9WWMfVluWN3opv+ReRWBjBsaRFPBmit6LNbRk3QLT6To50yVZg8Zy1NuDFUoE+Ms2ytVn9fs30n1DeNYJLCWjQJ4ktQaz2mIFTOFvRVrJqPkTBwzOaAjWoPxOr097hga8bRhPAqV6ir7ojSffUeCjL/jmp1x1uSE4OaQe3Y32oC0XOVJqA==",{engineLocation:"https://cdn.jsdelivr.net/npm/scandit-sdk@5.x/build/"}).catch((function(e){alert(e)}))),O={position:"absolute",top:"0",bottom:"0",left:"0",right:"0",margin:"auto",maxWidth:"1280px",maxHeight:"80%"},x=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).ref=r.a.createRef(),a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;g.then((function(){v.BarcodePicker.create(e.ref.current,e.props).then((function(t){e.barcodePicker=t,null!=e.props.onScan&&t.on("scan",e.props.onScan),null!=e.props.onError&&t.on("scanError",e.props.onError)}))}))}},{key:"componentWillUnmount",value:function(){null!=this.barcodePicker&&this.barcodePicker.destroy()}},{key:"componentDidUpdate",value:function(e){JSON.stringify(e.scanSettings)!==JSON.stringify(this.props.scanSettings)&&this.barcodePicker.applyScanSettings(this.props.scanSettings),e.visible!==this.props.visible&&this.barcodePicker.setVisible(this.props.visible)}},{key:"render",value:function(){var e=this;return Object(b.jsx)(r.a.Fragment,{children:Object(b.jsxs)("div",{id:"background-scan",children:[Object(b.jsx)("div",{ref:this.ref,style:O}),Object(b.jsx)("span",{class:"close",onClick:function(){e.props.onCrossClicked(!1)},children:"\xd7"}),Object(b.jsx)("div",{id:"scandit-barcode-picker"})]})})}}]),n}(a.Component),y=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={showScanner:!1,barcode:void 0,bcProductId:void 0,height:0},e.updateWindowDimensions=function(){e.setState({height:window.innerHeight})},e.handleScannerButton=function(t){e.setState({showScanner:t})},e.handleBarcode=function(t){if(t){var n=t.split("/");n.length>1?e.setState({barcode:n[4],bcProductId:n[5],showScanner:!1}):e.setState({barcode:n[0],showScanner:!1,bcProductId:void 0})}},e.render=function(){return e.state.height<550?Object(b.jsx)(r.a.Fragment,{}):e.state.barcode&&e.state.bcProductId&&(e.props.barcode!==e.state.barcode||e.props.bcProductId!==e.state.bcProductId)?Object(b.jsx)(p.a,{to:"/products/"+e.state.barcode+"/"+e.state.bcProductId}):e.state.barcode&&e.props.barcode!==e.state.barcode?Object(b.jsx)(p.a,{to:"/products/"+e.state.barcode}):e.state.showScanner?Object(b.jsx)(x,{onCrossClicked:e.handleScannerButton,vibrateOnScan:!0,enableTorchToggle:!0,enablePinchToZoom:!0,enableCameraSwitcher:!0,guiStyle:"viewfinder",scanSettings:new v.ScanSettings({enabledSymbologies:["qr","ean8","ean13","upca","upce","code128","code39","code93","itf"],codeDuplicateFilter:1e3}),onScan:function(t){console.log(t.barcodes[0].data),e.handleBarcode(t.barcodes[0].data)},onError:function(e){console.error(e.message)}}):Object(b.jsx)(r.a.Fragment,{children:Object(b.jsxs)("div",{className:"navbar-container",children:[Object(b.jsx)(u.b,{to:"/history",className:"navbar-link navbar-text-left",children:Object(b.jsx)(h,{})}),Object(b.jsx)("div",{onClick:function(){return e.handleScannerButton(!0)},children:Object(b.jsx)("div",{className:"navbar-circle",children:Object(b.jsx)(f,{})})}),Object(b.jsx)("span",{className:"navbar-scan-text",children:"Scan"}),Object(b.jsx)(u.b,{to:"/profil",className:"navbar-link navbar-text-right",children:Object(b.jsx)(m,{})})]})})},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}}]),n}(r.a.Component),S=(n(167),n.p+"static/media/logo.b235ef42.svg"),w=n.p+"static/media/bitmap.6f490d5b.png";var N=function(){return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{children:Object(b.jsx)("img",{src:w,className:"blob-top",alt:"Blob"})}),Object(b.jsx)("div",{children:Object(b.jsx)("img",{src:w,className:"blob-left",alt:"Blob"})}),Object(b.jsx)("div",{children:Object(b.jsx)("img",{src:w,className:"blob-right",alt:"Blob"})}),Object(b.jsxs)("div",{className:"header-container",children:[Object(b.jsx)("img",{src:S,className:"header-logo",alt:"Logo"}),Object(b.jsx)("span",{children:"Lowympact"})]})]})};n(168);function P(e){var t,n=e.item;"d"===n.label||"e"===n.label?t="red":"c"===n.label?t="yellow":"a"!==n.label&&"b"!==n.label||(t="green");var a="/products/"+n.barcode;return n.bcProductId&&(a+="/"+n.bcProductId),Object(b.jsxs)(u.b,{className:"history-item",to:a,children:[Object(b.jsx)("div",{className:"history-img-container",children:Object(b.jsx)("img",{src:n.image,alt:""})}),Object(b.jsxs)("div",{className:"history-name-container",children:[Object(b.jsx)("div",{className:"history-name",children:n.name}),Object(b.jsx)("div",{className:"history-brand",children:n.brand})]}),Object(b.jsxs)("div",{className:"history-label-container",children:[Object(b.jsx)("div",{style:{color:t},children:"\u25cf"}),Object(b.jsx)("div",{className:"history-label",children:n.label})]}),Object(b.jsx)("div",{style:{marginRight:"10px",color:"rgb(41,72,102)"},children:">"})]})}var k=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).componentDidMount=function(){var e=localStorage.getItem("userId"),t=localStorage.getItem("token");e&&t?(a.setState({userId:e}),a.loadHistoryInformations(e)):a.loadLocalStorageHistory(e)},a.loadHistoryInformations=function(e){fetch("https://api.lowympact.fr/api/v1/users/history/".concat(e),{method:"get",credentials:"include",headers:new Headers({authorization:localStorage.getItem("token"),"Content-Type":"application/json","api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043"})}).then((function(e){return e.json()})).then((function(e){console.log(e),a.setState({items:null===e||void 0===e?void 0:e.data})}))},a.loadLocalStorageHistory=function(){var e=JSON.parse(localStorage.getItem("local_history"));a.setState({items:e})},a.state={items:void 0,userId:void 0},a}return Object(i.a)(n,[{key:"render",value:function(){if(this.state.items){var e=this.state.items.map((function(e){return Object(b.jsx)("div",{children:Object(b.jsx)(P,{item:e})},e.id)}));return 0===Object.keys(this.state.items).length?Object(b.jsxs)("div",{children:[Object(b.jsx)(N,{}),Object(b.jsx)(y,{}),Object(b.jsx)("div",{className:"App",children:Object(b.jsxs)("div",{children:[Object(b.jsx)("img",{src:j,className:"logo",alt:"Fruits"}),Object(b.jsx)("p",{className:"logo-text",children:"Commencer \xe0 scanner des produits!"})]})})]}):Object(b.jsxs)("div",{children:[Object(b.jsxs)("div",{className:"screen",children:[Object(b.jsx)("div",{className:"screen-title",children:"Historique:"}),e]}),Object(b.jsx)(N,{}),Object(b.jsx)(y,{})]})}return Object(b.jsxs)("div",{children:[Object(b.jsx)(N,{}),Object(b.jsx)(y,{}),Object(b.jsx)("div",{className:"App",children:Object(b.jsxs)("div",{children:[Object(b.jsx)("img",{src:j,className:"logo",alt:"Fruits"}),Object(b.jsx)("p",{className:"logo-text",children:"Commencer \xe0 scanner des produits!"})]})})]})}}]),n}(a.Component);var C=function(){return Object(b.jsx)("div",{className:"App",children:Object(b.jsxs)("header",{className:"App-header",children:[Object(b.jsx)("img",{src:S,className:"logo",alt:"logo"}),Object(b.jsx)("h1",{children:"Erreur 404"}),Object(b.jsx)(u.b,{to:"/",children:"Retourner \xe0 l'accueil"})]})})};n(46);var I=function(){return Object(b.jsx)("div",{children:"Cr\xe9er un compte"})};var _=function(){return Object(b.jsx)("div",{children:"Me connecter"})};var F=function(){return Object(b.jsxs)("div",{children:["Continuer sans compte ",">"]})},L=n(25),T=n.n(L),M=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).componentDidMount=function(){e.Verify()},e.Verify=function(){var t=!0,n=localStorage.getItem("token");if(n){var a=T.a.decode(n,{complete:!0}),r=new Date;console.log(a,r.getTime()/1e3),a.payload.exp>=r.getTime()/1e3&&(t=!1)}!1===t&&(console.log("here"),e.props.history.push("/history"))},e.render=function(){return Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)("div",{className:"login-logo",children:Object(b.jsx)("img",{src:S,className:"logo",alt:"Logo"})}),Object(b.jsx)("div",{className:"login-lowympact",children:"Lowympact"}),Object(b.jsx)(u.b,{to:"/signup",className:"button-account",children:Object(b.jsx)(I,{})}),Object(b.jsx)(u.b,{to:"/signin",className:"button-connect",children:Object(b.jsx)(_,{})}),Object(b.jsx)(u.b,{to:"/history",className:"button-no-account",children:Object(b.jsx)(F,{})}),Object(b.jsx)("div",{className:"logo-fruits",children:Object(b.jsx)("img",{src:j,className:"logo",alt:"Fruits"})})]})},e}return n}(r.a.Component),D=n(82),B=n.n(D),U=n(142),E=n(290),z=n(292),A=n(293),V=(n(281),n(289)),W=n(291),q=n(144),H=n(22),J=n.n(H),R=n(294),Q=n(27),Z=n(4),Y=n.n(Z);Y.a.Curve=Y.a.Path.extend({options:{},initialize:function(e,t){Y.a.setOptions(this,t),this._initialUpdate=!0,this._setPath(e)},getPath:function(){return this._coords},setPath:function(e,t){return this._initialUpdate=!0,this._setPath(e),this.redraw()},getBounds:function(){return this._bounds},_setPath:function(e){this._coords=e,this._bounds=this._computeBounds()},_computeBounds:function(){for(var e,t,n,a=new Y.a.LatLngBounds,r=0;r<this._coords.length;r++)if("string"==typeof(n=this._coords[r])||n instanceof String)t=n;else if("H"==t)a.extend([e.lat,n[0]]),e=new Y.a.latLng(e.lat,n[0]);else if("V"==t)a.extend([n[0],e.lng]),e=new Y.a.latLng(n[0],e.lng);else if("C"==t){var o=new Y.a.latLng(n[0],n[1]);n=this._coords[++r];var s=new Y.a.latLng(n[0],n[1]);n=this._coords[++r];var c=new Y.a.latLng(n[0],n[1]);a.extend(o),a.extend(s),a.extend(c),c.controlPoint1=o,c.controlPoint2=s,e=c}else if("S"==t){s=new Y.a.latLng(n[0],n[1]);n=this._coords[++r];c=new Y.a.latLng(n[0],n[1]),o=e;if(e.controlPoint2){var i=e.lat-e.controlPoint2.lat,l=e.lng-e.controlPoint2.lng;o=new Y.a.latLng(e.lat+i,e.lng+l)}a.extend(o),a.extend(s),a.extend(c),c.controlPoint1=o,c.controlPoint2=s,e=c}else if("Q"==t){var d=new Y.a.latLng(n[0],n[1]);n=this._coords[++r];c=new Y.a.latLng(n[0],n[1]);a.extend(d),a.extend(c),c.controlPoint=d,e=c}else if("T"==t){c=new Y.a.latLng(n[0],n[1]),d=e;if(e.controlPoint){i=e.lat-e.controlPoint.lat,l=e.lng-e.controlPoint.lng;d=new Y.a.latLng(e.lat+i,e.lng+l)}a.extend(d),a.extend(c),c.controlPoint=d,e=c}else a.extend(n),e=new Y.a.latLng(n[0],n[1]);return a},getCenter:function(){return this._bounds.getCenter()},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updatecurve(this)},_project:function(){var e,t,n,a;this._points=[];for(var r=0;r<this._coords.length;r++)if("string"==typeof(e=this._coords[r])||e instanceof String)this._points.push(e),n=e;else{switch(e.length){case 2:a=this._map.latLngToLayerPoint(e),t=e;break;case 1:"H"==n?(a=this._map.latLngToLayerPoint([t[0],e[0]]),t=[t[0],e[0]]):(a=this._map.latLngToLayerPoint([e[0],t[1]]),t=[e[0],t[1]])}this._points.push(a)}}}),Y.a.curve=function(e,t){return new Y.a.Curve(e,t)},Y.a.SVG.include({_updatecurve:function(e){if(this._setPath(e,this._curvePointsToPath(e._points)),e.options.animate){var t=e._path,n=t.getTotalLength();e.options.dashArray||(t.style.strokeDasharray=n+" "+n),e._initialUpdate&&(t.animate([{strokeDashoffset:n},{strokeDashoffset:0}],e.options.animate),e._initialUpdate=!1)}},_curvePointsToPath:function(e){for(var t,n,a="",r=0;r<e.length;r++)if("string"==typeof(t=e[r])||t instanceof String)a+=n=t;else switch(n){case"H":a+=t.x+" ";break;case"V":a+=t.y+" ";break;default:a+=t.x+","+t.y+" "}return a||"M0 0"}});var X=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"createLeafletElement",value:function(e){var t=e.positions,n=e.option,a=Object(q.a)(e,["positions","option"]);return Y.a.curve(t,n,this.getOptions(a))}},{key:"updateLeafletElement",value:function(e,t){t.positions!==e.positions&&this.leafletElement.setPath(t.positions),this.setStyleIfChanged(e,t)}}]),n}(R.a);X.propTypes={children:J.a.oneOfType([J.a.arrayOf(J.a.node),J.a.node]),option:J.a.object,positions:J.a.array.isRequired};var G=Object(Q.b)(X),K=(n(282),function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).map=void 0,e.state={zoom:12,swiper:void 0,currentIndex:0,map:void 0},e.getMaterialIcon=function(e){switch(e){case"Charette":return"directions_bike";case"Plane":return"flight_takeoff";case"Train":return"train";case"Boat":return"directions_boat_filled";case"Truck":return"local_shipping";default:return"nature_people"}},e.getTransportMode=function(e){switch(e){case"Charette":return"v\xe9lo";case"Plane":return"avion";case"Train":return"train";case"Boat":return"bateau";case"Truck":return"camion";default:return e}},e.displaySlides=function(){var t=Object(b.jsx)(r.a.Fragment,{});return e.props.products&&(t=e.props.products.map((function(t){var n,a;return Object(b.jsx)(V.a,{children:Object(b.jsxs)("div",{className:"product-slide-container",children:[Object(b.jsx)("div",{className:"product-slide-icon",children:Object(b.jsx)("span",{class:"material-icons",children:e.getMaterialIcon(t.transport)})}),Object(b.jsxs)("div",{className:"product-slide-wrapper",children:[Object(b.jsxs)("div",{className:"product-slide-name",children:["Transport en"," ",e.getTransportMode(t.transport)]}),Object(b.jsxs)("div",{className:"product-slide-lowername",children:["De ",null===(n=t.seller)||void 0===n?void 0:n.name]}),Object(b.jsxs)("div",{className:"product-slide-lowername",children:["\xc0 ",null===(a=t.buyer)||void 0===a?void 0:a.name]})]})]})})}))),t},e.handleMarkerClick=function(t,n){var a;window.scroll({top:2e3,behavior:"smooth"}),console.log(n),n>=(null===(a=e.props.products)||void 0===a?void 0:a.length)?e.state.swiper.slideTo(n-1,500):e.state.swiper.slideTo(n,500);var r=6;if(e.props.products&&e.props.products[n]){var o=e.props.products[n];console.log([o.buyer.localisation.latitude,o.buyer.localisation.longitude],[o.seller.localisation.latitude,o.seller.localisation.longitude]),r=ee([o.buyer.localisation.latitude,o.buyer.localisation.longitude],[o.seller.localisation.latitude,o.seller.localisation.longitude])}e.map.leafletElement.flyTo(t,r,{duration:.5})},e.onSlideChange=function(t){e.setState({currentIndex:t});var n=6;if(e.props.products&&e.props.products[t]){var a=e.props.products[t];n=ee([a.buyer.localisation.latitude,a.buyer.localisation.longitude],[a.seller.localisation.latitude,a.seller.localisation.longitude]),e.map.leafletElement.flyTo([a.seller.localisation.latitude,a.seller.localisation.longitude],n,{duration:.5})}},e.displayMarker=function(){var t=Object(b.jsx)(r.a.Fragment,{});return e.props.products&&(t=e.props.products.map((function(t,n){var a,o,s,c,i,l,d,u,p,j=Object(b.jsx)(r.a.Fragment,{}),h=parseFloat(null===t||void 0===t||null===(a=t.buyer)||void 0===a||null===(o=a.localisation)||void 0===o?void 0:o.latitude),m=parseFloat(null===t||void 0===t||null===(s=t.buyer)||void 0===s||null===(c=s.localisation)||void 0===c?void 0:c.longitude),f=Object(b.jsx)(r.a.Fragment,{}),v=parseFloat(null===t||void 0===t||null===(i=t.seller)||void 0===i||null===(l=i.localisation)||void 0===l?void 0:l.latitude),g=parseFloat(null===t||void 0===t||null===(d=t.seller)||void 0===d||null===(u=d.localisation)||void 0===u?void 0:u.longitude);return p=n===e.state.currentIndex?new Y.a.Icon({iconUrl:"/images/utils/map.png",iconRetinaUrl:"/images/utils/map.png",iconSize:new Y.a.Point(30,30),className:"leaflet-mark-icon"}):new Y.a.Icon({iconUrl:"/images/utils/map2.png",iconRetinaUrl:"/images/utils/map2.png",iconSize:new Y.a.Point(25,25),className:"leaflet-mark-icon"}),h&&m&&(j=Object(b.jsx)(E.a,{icon:p,position:[h,m],onClick:function(){return e.handleMarkerClick([parseFloat(t.buyer.localisation.latitude),parseFloat(t.buyer.localisation.longitude)],n+1)}})),v&&g&&(f=Object(b.jsx)(E.a,{icon:p,position:[v,g],onClick:function(){return e.handleMarkerClick([parseFloat(t.seller.localisation.latitude),parseFloat(t.seller.localisation.longitude)],n)}})),Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)(G,{positions:te(v,g,h,m),option:{color:"#1b3044",fill:!1,delay:5e3}}),j,f]})}))),t},e.render=function(){return Object(b.jsxs)("div",{children:[Object(b.jsxs)(z.a,{center:[51.505,-.09],zoom:1,minZoom:1,scrollWheelZoom:!0,maxBounds:[[-90,-180],[90,180]],maxBoundsViscosity:1,ref:function(t){e.map=t},whenCreated:function(t){return e.setState({map:t})},children:[Object(b.jsx)(A.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a>',url:"https://stamen-tiles-{s}.a.ssl.fastly.net/toner-background/{z}/{x}/{y}{r}.png"}),e.displayMarker()]}),Object(b.jsx)(W.a,{spaceBetween:10,slidesPerView:1.2,centeredSlides:!0,onSlideChange:function(t){return e.onSlideChange(t.activeIndex)},onSwiper:function(t){return e.setState({swiper:t})},children:e.displaySlides()})]})},e}return n}(r.a.Component));function $(e){return e*Math.PI/180}function ee(e,t){return 10-10*function(e,t){var n=$(e[1]),a=$(e[0]),r=$(t[1]),o=$(t[0]),s=o-a,c=r-n,i=Math.pow(Math.sin(s/2),2)+Math.cos(a)*Math.cos(o)*Math.pow(Math.sin(c/2),2);return 2*Math.asin(Math.sqrt(i))*6371*1e3}(e,t)/1915087}function te(e,t,n,a){var r=[e,t],o=[n,a],s=o[1]-r[1],c=o[0]-r[0],i=Math.sqrt(Math.pow(s,2)+Math.pow(c,2)),l=Math.atan2(c,s),d=i/2/Math.cos(.314),u=l+.314,p=d*Math.cos(u)+r[1];return["M",r,"Q",[d*Math.sin(u)+r[0],p],o]}n(283);var ne=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).displayPackaging=function(){var t,n,a;r.a.Fragment;return null===(t=e.props.dataEcoScore)||void 0===t||null===(n=t.adjustments)||void 0===n||null===(a=n.packaging)||void 0===a?void 0:a.packagings.map((function(e){return Object(b.jsx)("div",{children:Object(b.jsxs)("p",{children:["Mat\xe9riel : ",null===e||void 0===e?void 0:e.material]})})}))},e.render=function(){var t,n,a,o;return Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsxs)("div",{children:[Object(b.jsxs)("p",{children:["Note du transport des ingr\xe9dients :",null===(t=e.props.dataEcoScore)||void 0===t||null===(n=t.adjustments)||void 0===n||null===(a=n.origins_of_ingredients)||void 0===a?void 0:a.transportation_value_fr]}),Object(b.jsxs)("p",{children:["Note de l'\xe9co score : ",null===(o=e.props.dataEcoScore)||void 0===o?void 0:o.score," "]})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("p",{children:"Informations emballages "}),e.displayPackaging()]})]})},e}return n}(r.a.Component),ae=(n(284),function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={barcode:e.props.match.params.barcode,bcProductId:e.props.match.params.bcProductId,product:void 0,productImageUrl:void 0,productName:void 0,genericName:void 0,ecoScore:void 0,dataEcoScore:void 0,value:0,connected:!1,productData:void 0},e.handleBarCodeUpdate=function(){e.state.barcode!==e.props.match.params.barcode&&(e.setState({barcode:e.props.match.params.barcode,bcProductId:e.props.match.params.bcProductId}),e.loadFromOpenFoodFacts(e.props.match.params.barcode),e.props.match.params.bcProductId&&e.loadProductInformations(e.props.match.params.barcode,e.props.match.params.bcProductId))},e.Verify=function(){var t=!0,n=localStorage.getItem("token");if(n){var a=T.a.decode(n,{complete:!0}),r=new Date;a.payload.exp>=r.getTime()/1e3&&(t=!1)}!1===t&&e.setState({connected:!0})},e.componentDidMount=function(){e.Verify()},e.componentDidMount=function(){e.loadFromOpenFoodFacts(e.props.match.params.barcode),e.props.match.params.bcProductId&&e.loadProductInformations(e.props.match.params.barcode,e.props.match.params.bcProductId)},e.loadProductInformations=function(t,n){fetch("https://api.lowympact.fr/api/v1/products/".concat(t,"?bcProductId=").concat(n),{method:"get",credentials:"include",headers:new Headers({Authorization:"Bearer 99d8fb95-abdd-4885-bf6c-3a81d8874043","Content-Type":"application/json"})}).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({products:t.data.traceability,impact:t.data.impact})}))},e.loadFromOpenFoodFacts=function(t){fetch("https://world.openfoodfacts.org/api/v0/product/".concat(t,".json/")).then((function(e){return e.json()})).then((function(t){var n,a,r,o,s;console.log(t);var c=null===t||void 0===t||null===(n=t.product)||void 0===n?void 0:n.image_url,i=null===t||void 0===t||null===(a=t.product)||void 0===a?void 0:a.product_name,l=null===t||void 0===t||null===(r=t.product)||void 0===r?void 0:r.generic_name,d=null===t||void 0===t||null===(o=t.product)||void 0===o?void 0:o.ecoscore_grade,u=null===t||void 0===t||null===(s=t.product)||void 0===s?void 0:s.ecoscore_data;(null===t||void 0===t?void 0:t.product)&&e.setState({productData:t.product}),c&&e.setState({productImageUrl:c}),i&&e.setState({productName:i}),l&&e.setState({genericName:l}),!d||"a"!==d&&"b"!==d&&"c"!==d&&"d"!==d&&"e"!==d||e.setState({ecoScore:d}),u&&e.setState({dataEcoScore:u}),1===t.status&&e.saveHistory()}))},e.saveHistory=Object(U.a)(B.a.mark((function t(){var n,a,r,o;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,re(2e3);case 2:e.state.connected||(a=JSON.parse(localStorage.getItem("local_history")),r=null,a?r=null===(o=a)||void 0===o?void 0:o.find((function(t){return t.barcode===e.state.barcode&&t.bcProductId==e.state.bcProductId})):a=[],r&&0!==(null===(n=r)||void 0===n?void 0:n.length)||(a.push({barcode:e.state.barcode,bcProductId:e.state.bcProductId,brand:e.state.productData.brands,image:e.state.productImageUrl,label:e.state.ecoScore,name:e.state.productName}),localStorage.setItem("local_history",JSON.stringify(a))));case 3:case"end":return t.stop()}}),t)}))),e.flip=function(e){"rotateY(360deg)"===e.target.style.transform?e.target.style.transform="rotateY(0deg)":e.target.style.transform="rotateY(360deg)"},e.displayImage=function(){e.handleBarCodeUpdate();var t=Object(b.jsx)(r.a.Fragment,{}),n=Object(b.jsx)(r.a.Fragment,{}),a=Object(b.jsx)(r.a.Fragment,{}),o=Object(b.jsx)(r.a.Fragment,{});if(e.state.productImageUrl&&(t=Object(b.jsx)("img",{src:e.state.productImageUrl,className:"product-image",alt:"produit"})),e.state.productName&&(n=Object(b.jsx)("div",{className:"product-name",children:e.state.productName})),e.state.ecoScore){var s="color_score_"+e.state.ecoScore;o=Object(b.jsxs)("div",{className:"product-ecoscore",children:[Object(b.jsx)("span",{className:"circle-score "+s,children:"\u2b24 "}),"EcoScore :",Object(b.jsx)("span",{className:"uppercase ",children:" "+e.state.ecoScore})]})}else e.state.genericName&&(a=Object(b.jsx)("div",{className:"product-generic-name",children:e.state.genericName}));return Object(b.jsxs)(r.a.Fragment,{children:[t,n,Object(b.jsxs)("div",{className:"product-bottom-image-div",children:[a,o]})]})},e.handleChange=function(t,n){e.setState({value:n})},e.displayNavbar=function(){var t=Object(b.jsx)(r.a.Fragment,{});return e.state.bcProductId&&(t=Object(b.jsxs)("div",{className:"product-navbar-container",children:[Object(b.jsxs)("button",{className:0===e.state.value?"product-navbar-button selected":"product-navbar-button",onClick:function(){return e.handleChange("",0)},children:[Object(b.jsx)("span",{class:"material-icons",children:"nature_people"}),"Environnement"]}),Object(b.jsxs)("button",{className:1===e.state.value?"product-navbar-button selected":"product-navbar-button",onClick:function(){return e.handleChange("",1)},children:[Object(b.jsx)("span",{class:"material-icons",children:"travel_explore"}),"Tra\xe7abilit\xe9"]})]})),t},e.render=function(){return Object(b.jsx)(r.a.Fragment,{children:Object(b.jsxs)("div",{className:"product-page-container",children:[Object(b.jsxs)("div",{className:"product-header-container",children:[Object(b.jsx)("div",{className:"product-history-link",children:Object(b.jsxs)(u.b,{to:"/history",children:[" ","<"," Historique"]})}),Object(b.jsx)("img",{className:"product-bitmap-image",src:"/images/utils/bitmap.png",alt:""})]}),Object(b.jsx)("div",{className:"product-image-container",onClick:e.flip,children:e.displayImage()}),e.displayNavbar(),0===e.state.value?Object(b.jsx)(ne,{dataEcoScore:e.state.dataEcoScore}):Object(b.jsx)("div",{className:"product-bottom-container",children:Object(b.jsx)(K,{products:e.state.products})}),Object(b.jsx)(y,{barcode:e.props.match.params.barcode,bcProductId:e.props.match.params.bcProductId})]})})},e}return n}(r.a.Component)),re=function(e){return new Promise((function(t){return setTimeout(t,e)}))},oe=(n(285),function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={connected:!1},e.disconnect=function(){localStorage.clear(),e.props.history.push("/login")},e.componentDidMount=function(){e.Verify()},e.Verify=function(){var t=!0,n=localStorage.getItem("token");if(n){var a=T.a.decode(n,{complete:!0}),r=new Date;a.payload.exp>=r.getTime()/1e3&&(t=!1)}!1===t&&e.setState({connected:!0})},e.displayConnectedProfil=function(){return Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)("h2",{className:"profil-title",children:"Bienvenue sur ton profil!"}),Object(b.jsx)(u.b,{to:"/configuration",className:"profil-button",children:"Configuration"}),Object(b.jsx)("div",{onClick:e.disconnect,className:"profil-button",children:"D\xe9connecter"})]})},e.displayUnconnectedProfil=function(){return Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)("h2",{className:"profil-title",children:"Non connect\xe9"}),Object(b.jsx)("p",{children:"Connecte toi pour que ton historique soit sauvegard\xe9 !"}),Object(b.jsx)(u.b,{to:"/login",className:"profil-button",children:"Me Connecter"})]})},e}return Object(i.a)(n,[{key:"render",value:function(){return Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)(u.b,{to:"/",children:Object(b.jsx)(N,{})}),Object(b.jsxs)("div",{className:"profil-screen",children:[Object(b.jsx)("div",{className:"profil-picture",children:Object(b.jsx)("div",{class:"material-icons",children:"person"})}),this.state.connected?this.displayConnectedProfil():this.displayUnconnectedProfil()]}),Object(b.jsx)(y,{})]})}}]),n}(r.a.Component));var se=function(){return Object(b.jsx)("div",{children:"Cr\xe9er mon compte"})},ce=new RegExp("^[a-zA-Z0-9._:$!%-]+@[a-zA-Z0-9.-]+.[a-zA-Z]$");var ie=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).handleSubmit=function(e){e.preventDefault();var t=a.state,n=t.email,r=t.password,o=t.confirmPassword,s=function(e,t,n){var a=[];return 0===e.length&&a.push(Object(b.jsx)("p",{children:"Saissez votre adresse e-mail"})),!1===ce.test(e)&&a.push(Object(b.jsx)("p",{children:"Saissez une adresse e-mail valide"})),t.length<6&&a.push(Object(b.jsx)("p",{children:"Entre un mot de passe. 6 car\xe0cteres minimum requis"})),t!==n&&a.push(Object(b.jsx)("p",{children:"Les mots de passe ne correspondent pas"})),a}(n,r,o);console.log(n,r,o,s),a.setState({errors:s}),0===s.length&&a.setState({redirect:!0})},a.state={email:"",password:"",confirmPassword:"",errors:[],redirect:!1},a}return Object(i.a)(n,[{key:"render",value:function(){var e=this;return this.state.redirect?Object(b.jsx)(p.a,{to:"/history"}):Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)(u.b,{to:"/login",children:Object(b.jsx)(N,{})}),Object(b.jsx)("div",{className:"logo-fruits",children:Object(b.jsx)("img",{src:j,className:"logo",alt:"Fruits"})}),Object(b.jsx)(u.b,{className:"back-button",to:"/login",children:"< retour"}),Object(b.jsxs)("form",{children:[Object(b.jsxs)("label",{children:["email",Object(b.jsx)("input",{value:this.state.email,onChange:function(t){return e.setState({email:t.target.value})},type:"text"})]}),Object(b.jsxs)("label",{children:["mot de passe",Object(b.jsx)("input",{value:this.state.password,onChange:function(t){return e.setState({password:t.target.value})},type:"password"})]}),Object(b.jsxs)("label",{children:["confirmer mot de passe",Object(b.jsx)("input",{value:this.state.passwordConfirm,onChange:function(t){return e.setState({confirmPassword:t.target.value})},type:"password"})]})]}),Object(b.jsx)("label",{className:"errors-signup",children:this.state.errors}),Object(b.jsx)("div",{className:"button-signup",onClick:this.handleSubmit,children:Object(b.jsx)(se,{})})]})}}]),n}(a.Component);var le=function(){return Object(b.jsx)("div",{children:"Me connecter"})};var de=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).handleSubmit=function(e){e.preventDefault();var t=a.state,n=t.email,r=t.password,o=function(e,t){var n=[];return 0===e.length&&n.push(Object(b.jsx)("p",{children:"Saissez votre adresse e-mail"})),0===t.length&&n.push(Object(b.jsx)("p",{children:"Saissez votre mot de passe"})),n}(n,r);console.log(n,r,o),a.setState({errors:o}),0===o.length&&a.Connect()},a.componentDidMount=function(){a.Verify()},a.Verify=function(){var e=!0,t=localStorage.getItem("token");if(t){var n=T.a.decode(t,{complete:!0}),r=new Date;n.payload.exp>=r.getTime()/1e3&&(e=!1)}!1===e&&a.setState({redirect:!0})},a.Connect=function(){fetch("https://api.lowympact.fr/api/v1/users/login",{method:"POST",headers:{"Content-Type":"application/json","api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043"},body:JSON.stringify({email:a.state.email,password:a.state.password})}).then((function(e){return e.json()})).then((function(e){if(console.log(e),"No user found"===e.error){a.setState({loginSuccessful:!1});var t=a.state.errors;t.push(Object(b.jsx)("p",{children:"Utilisateur Inconnu"})),a.setState({errors:t})}else if("Incorrect password"!==e.error&&e.success)localStorage.setItem("token",e.token),localStorage.setItem("userId",e._id),a.setState({loginSuccessful:!0,redirect:!0});else{a.setState({loginSuccessful:!1});var n=a.state.errors;n.push(Object(b.jsx)("p",{children:"Mot de passe Incorrect"})),a.setState({errors:n})}}))},a.state={email:"",password:"",errors:[],redirect:!1,loginSuccessful:null},a}return Object(i.a)(n,[{key:"render",value:function(){var e=this;return this.state.redirect?Object(b.jsx)(p.a,{to:"/history"}):Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)("div",{children:Object(b.jsx)("img",{src:w,className:"blob-top",alt:"Blob"})}),Object(b.jsx)(u.b,{to:"/login",children:Object(b.jsx)(N,{})}),Object(b.jsx)("div",{className:"logo-fruits",children:Object(b.jsx)("img",{src:j,className:"logo",alt:"Fruits"})}),Object(b.jsx)(u.b,{className:"back-button",to:"/login",children:"< retour"}),Object(b.jsxs)("form",{children:[Object(b.jsxs)("label",{children:["email",Object(b.jsx)("input",{value:this.state.email,onChange:function(t){return e.setState({email:t.target.value})},type:"text"})]}),Object(b.jsxs)("label",{children:["mot de passe",Object(b.jsx)("input",{value:this.state.password,onChange:function(t){return e.setState({password:t.target.value})},type:"password"})]})]}),Object(b.jsx)("label",{className:"errors-signin",children:this.state.errors}),Object(b.jsx)("div",{className:"button-signin",onClick:this.handleSubmit,children:Object(b.jsx)(le,{})})]})}}]),n}(a.Component);var ue=function(){return Object(b.jsx)("div",{children:"Changer mot de passe"})},pe=(n(286),{id:0,email:"bububu@bababa.com",password:"123456"});var je=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).handleChange=function(e){e.preventDefault();var t=a.state,n=t.currentPassword,r=t.newPassword,o=t.confirmPassword,s=function(e,t,n,a){var r=[];return e!==t&&r.push(Object(b.jsx)("p",{children:"Le mot de passe actueil n'est pas correct"})),n.length<6&&r.push(Object(b.jsx)("p",{children:"Entre un mot de passe. 6 car\xe0cteres minimum requis"})),n!==a&&r.push(Object(b.jsx)("p",{children:"Les mots de passe ne correspondent pas"})),r}(a.state.user.password,n,r,o);console.log(a.state.user.mail,a.state.user.password,n,r,o,s),a.setState({errors:s}),0===s.length&&a.setState({redirect:!0})},a.Verify=function(){var e=!0,t=localStorage.getItem("token");if(t){var n=T.a.decode(t,{complete:!0}),r=new Date;n.payload.exp>=r.getTime()/1e3&&(e=!1)}!0===e&&a.setState({redirect:!0})},a.componentDidMount=function(){a.Verify();var e=localStorage.getItem("userId");e&&a.loadUserInfo(e)},a.loadUserInfo=function(e){fetch("https://api.lowympact.fr/api/v1/users/".concat(e),{method:"GET",headers:{"Content-Type":"application/json","api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043",authorization:localStorage.getItem("token")}}).then((function(e){return e.json()})).then((function(e){console.log(e),a.setState({user:e.data})}))},a.state={user:pe,currentPassword:"",newPassword:"",confirmPassword:"",errors:[],redirect:!1},a}return Object(i.a)(n,[{key:"render",value:function(){var e=this;return this.state.redirect?Object(b.jsx)(p.a,{to:"/profil"}):(console.log(this.state.redirect),Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)(u.b,{to:"/",children:Object(b.jsx)(N,{})}),Object(b.jsx)(y,{}),Object(b.jsx)("div",{className:"logo-fruits",children:Object(b.jsx)("img",{src:j,className:"logo",alt:"Fruits"})}),Object(b.jsx)(u.b,{className:"back-button",to:"/profil",children:"< retour"}),Object(b.jsx)("div",{className:"errors-change-password",children:this.state.errors}),Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:"email",children:"email"}),Object(b.jsx)("div",{className:"user-email",children:this.state.user.email})]}),Object(b.jsxs)("form",{className:"forms",children:[Object(b.jsx)("label",{children:Object(b.jsx)("input",{placeholder:"mot de passe actuel",value:this.state.currentPassword,onChange:function(t){return e.setState({currentPassword:t.target.value})},type:"password"})}),Object(b.jsx)("label",{children:Object(b.jsx)("input",{value:this.state.newPassword,onChange:function(t){return e.setState({newPassword:t.target.value})},type:"password",placeholder:"nouveau mot de passe"})}),Object(b.jsx)("label",{children:Object(b.jsx)("input",{placeholder:"confirmation de mdp",value:this.state.passwordConfirm,onChange:function(t){return e.setState({confirmPassword:t.target.value})},type:"password"})}),Object(b.jsx)(u.b,{className:"button-change-password",onClick:this.handleChange,to:"",children:Object(b.jsx)(ue,{})})]})]}))}}]),n}(a.Component),be=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return Object(b.jsx)(u.a,{children:Object(b.jsxs)(p.d,{children:[Object(b.jsx)(p.b,{path:"/",component:M,exact:!0}),Object(b.jsx)(p.b,{path:"/history",component:k,exact:!0}),Object(b.jsx)(p.b,{path:"/login",component:M,exact:!0}),Object(b.jsx)(p.b,{path:"/profil",component:oe,exact:!0}),Object(b.jsx)(p.b,{path:"/products/:barcode/:bcProductId",component:ae,exact:!0}),Object(b.jsx)(p.b,{path:"/products/:barcode",component:ae,exact:!0}),Object(b.jsx)(p.b,{path:"/signup",component:ie,exact:!0}),Object(b.jsx)(p.b,{path:"/signin",component:de,exact:!0}),Object(b.jsx)(p.b,{path:"/configuration",component:je,exact:!0}),Object(b.jsx)(p.b,{path:"/error404",component:C}),Object(b.jsx)(p.a,{to:"/error404"})]})})}}]),n}(a.Component),he=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,295)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),o(e),s(e)}))};s.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(be,{})}),document.getElementById("root")),he()},46:function(e,t,n){}},[[287,1,2]]]);
//# sourceMappingURL=main.f680ba36.chunk.js.map