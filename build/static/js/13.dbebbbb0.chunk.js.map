{"version":3,"sources":["../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","components/Button/ButtonChangePassword.js","assets/users/users.js","pages/ProfileConfiguration.js","assets/images/fruits-vegetables-basket-by-oblik-studio.svg"],"names":["_arrayLikeToArray","arr","len","length","i","arr2","Array","_unsupportedIterableToArray","o","minLen","n","Object","prototype","toString","call","slice","constructor","name","from","test","_toConsumableArray","isArray","arrayLikeToArray","iter","Symbol","iterator","unsupportedIterableToArray","TypeError","ButtonChangePassword","USERS","id","email","password","ProfileConfiguration","props","handleChange","e","preventDefault","state","currentPassword","newPassword","errors","confirmPassword","push","validate","setState","changeUserInfo","user","_id","userId","fetch","method","headers","authorization","localStorage","getItem","body","JSON","stringify","then","response","json","res","success","error","redirect","Verify","isExpired","token","decodedToken","jwt","decode","complete","dateNow","Date","payload","exp","getTime","componentDidMount","loadUserInfo","data","this","to","className","Header","Navbar","src","fruits","alt","placeholder","value","onChange","evt","target","type","onClick","Component"],"mappings":"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","file":"static/js/13.dbebbbb0.chunk.js","sourcesContent":["export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","import arrayWithoutHoles from \"@babel/runtime/helpers/esm/arrayWithoutHoles\";\nimport iterableToArray from \"@babel/runtime/helpers/esm/iterableToArray\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableSpread from \"@babel/runtime/helpers/esm/nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import React from \"react\";\n\nfunction ButtonChangePassword() {\n  return (\n  <div>\n    Changer mot de passe\n  </div>\n  );\n}\n\nexport default ButtonChangePassword;","export const USERS =\n    {\n        id: 0,\n        email: \"bububu@bababa.com\",\n        password: \"123456\"\n    };","import React, { Component } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport ButtonChangePassword from \"../components/Button/ButtonChangePassword\";\nimport fruits from \"../assets/images/fruits-vegetables-basket-by-oblik-studio.svg\";\nimport Header from \"../components/Header/Header\";\nimport Navbar from \"../components/Navbar/Navbar\";\nimport \"./ProfileConfiguration.css\";\nimport { USERS } from \"../assets/users/users\";\nimport jwt from \"jsonwebtoken\";\nimport { Link } from \"react-router-dom\";\n\nfunction validate(newPassword, confirmPassword) {\n    const errors = [];\n    if (newPassword.length < 6) {\n        errors.push(<p>Entre un mot de passe. 6 caract√®res minimum requis</p>);\n    }\n    if (newPassword !== confirmPassword) {\n        errors.push(<p>Les mots de passe ne correspondent pas</p>);\n    }\n    return errors;\n}\n\nclass ProfileConfiguration extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            user: USERS,\n            currentPassword: \"\",\n            newPassword: \"\",\n            confirmPassword: \"\",\n            errors: [],\n            redirect: false,\n        };\n    }\n\n    handleChange = (e) => {\n        e.preventDefault();\n        const { currentPassword, newPassword, confirmPassword } = this.state;\n        const errors = validate(newPassword, confirmPassword);\n        //console.log(this.state.user.email, currentPassword, newPassword, confirmPassword, errors);\n        this.setState({ errors });\n        if (errors.length === 0) {\n            this.changeUserInfo(this.state.user._id, currentPassword, newPassword);\n        }\n    };\n\n    changeUserInfo = (userId, currentPassword, newPassword) => {\n        //console.log(\"hey\");\n        fetch(\n            `https://api.lowympact.fr/api/v1/users/${userId}`,\n            // `http://localhost:8080/api/v1/users/login`,\n            {\n                method: \"PUT\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    \"api-key\": \"99d8fb95-abdd-4885-bf6c-3a81d8874043\",\n                    authorization: localStorage.getItem(\"token\"),\n                },\n                body: JSON.stringify({\n                    currentPassword: currentPassword,\n                    newPassword: newPassword,\n                }),\n            }\n        )\n            .then((response) => response.json())\n            .then((res) => {\n                //console.log(res);\n                if (res.success === false) {\n                    this.setState({\n                        errors: [...this.state.errors, res.error],\n                    });\n                } else {\n                    this.setState({ redirect: true });\n                }\n            });\n    };\n\n    Verify = () => {\n        let isExpired = true;\n        const token = localStorage.getItem(\"token\");\n        if (token) {\n            var decodedToken = jwt.decode(token, { complete: true });\n            var dateNow = new Date();\n            if (decodedToken.payload.exp >= dateNow.getTime() / 1000) {\n                isExpired = false;\n            }\n        }\n        if (isExpired === true) {\n            this.setState({ redirect: true }); // redirection vers la page login\n        }\n    };\n\n    componentDidMount = () => {\n        this.Verify();\n        let userId = localStorage.getItem(\"userId\");\n        if (userId) {\n            this.loadUserInfo(userId);\n        }\n    };\n\n    loadUserInfo = (userId) => {\n        fetch(\n            `https://api.lowympact.fr/api/v1/users/${userId}`,\n            // `http://localhost:8080/api/v1/users/login`,\n            {\n                method: \"GET\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    \"api-key\": \"99d8fb95-abdd-4885-bf6c-3a81d8874043\",\n                    authorization: localStorage.getItem(\"token\"),\n                },\n            }\n        )\n            .then((response) => response.json())\n            .then((res) => {\n                //console.log(res);\n\n                this.setState({ user: res.data });\n            });\n    };\n\n    render() {\n        if (this.state.redirect) {\n            return <Redirect to=\"/profil\" />;\n        }\n        //console.log(this.state.redirect);\n        return (\n            <div className=\"screen\">\n                <Link to=\"/\">\n                    <Header />\n                </Link>\n                <Navbar />\n                <div className=\"logo-fruits\">\n                    <img src={fruits} className=\"logo\" alt=\"Fruits\" />\n                </div>\n                <Link className=\"back-button\" to=\"/profil\">\n                    {\"< Retour\"}\n                </Link>\n                <div className=\"configuration-screen-title\"></div>\n                <div className=\"errors-change-password\">{this.state.errors}</div>\n                <div className=\"configuration-container\">\n                    <div className=\"configuration-email-block\">\n                        <div>email</div>\n                        <div>{this.state.user.email}</div>\n                    </div>\n                    <form className=\"configuration-form\">\n                        <label>\n                            {/* Mot de passe actuel */}\n                            <input\n                                placeholder=\"mot de passe actuel\"\n                                className=\"input-forms\"\n                                value={this.state.currentPassword}\n                                onChange={(evt) =>\n                                    this.setState({\n                                        currentPassword: evt.target.value,\n                                    })\n                                }\n                                type=\"password\"\n                            />\n                        </label>\n                        <label>\n                            {/* Nouveau mot de passe */}\n                            <input\n                                value={this.state.newPassword}\n                                className=\"input-forms\"\n                                onChange={(evt) =>\n                                    this.setState({\n                                        newPassword: evt.target.value,\n                                    })\n                                }\n                                type=\"password\"\n                                placeholder=\"nouveau mot de passe\"\n                            />\n                        </label>\n                        <label>\n                            {/* Confirmation de mot de passe */}\n                            <input\n                                placeholder=\"confirmation de mdp\"\n                                className=\"input-forms\"\n                                value={this.state.confirmPassword}\n                                onChange={(evt) =>\n                                    this.setState({\n                                        confirmPassword: evt.target.value,\n                                    })\n                                }\n                                type=\"password\"\n                            />\n                        </label>\n                        <Link className=\"button-change-password\" onClick={this.handleChange} to=\"\">\n                            <ButtonChangePassword />\n                        </Link>\n                    </form>\n                </div>\n            </div>\n        );\n    }\n}\nexport default ProfileConfiguration;\n","export default __webpack_public_path__ + \"static/media/fruits-vegetables-basket-by-oblik-studio.7d5e1c64.svg\";"],"sourceRoot":""}