(this.webpackJsonplowympact=this.webpackJsonplowympact||[]).push([[10],{340:function(e,t,s){"use strict";s.r(t);var a=s(12),r=s(21),n=s(14),o=s(13),c=s(1),i=s.n(c),l=s(6),u=s(2);var d=function(){return Object(u.jsx)("div",{children:"Me connecter"})},p=s(47),h=s(42),j=(s(66),s(93),s(11)),b=s(56),m=s.n(b);var f=function(e){Object(n.a)(s,e);var t=Object(o.a)(s);function s(e){var r;return Object(a.a)(this,s),(r=t.call(this,e)).handleSubmit=function(e){e.preventDefault();var t=r.state,s=function(e,t){var s=[];return 0===e.length&&s.push(Object(u.jsx)("p",{children:"Saissez votre adresse e-mail"})),0===t.length&&s.push(Object(u.jsx)("p",{children:"Saissez votre mot de passe"})),s}(t.email,t.password);r.setState({errors:s}),0===s.length&&r.Connect()},r.componentDidMount=function(){r.Verify()},r.Verify=function(){var e=!0,t=localStorage.getItem("token");if(t){var s=m.a.decode(t,{complete:!0}),a=new Date;s.payload.exp>=a.getTime()/1e3&&(e=!1)}!1===e&&r.setState({redirect:!0})},r.Connect=function(){fetch("https://api.lowympact.fr/api/v1/users/login",{method:"POST",headers:{"Content-Type":"application/json","api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043"},body:JSON.stringify({email:r.state.email,password:r.state.password})}).then((function(e){return e.json()})).then((function(e){if("No user found"===e.error){r.setState({loginSuccessful:!1});var t=r.state.errors;t.push(Object(u.jsx)("p",{children:"Utilisateur Inconnu"})),r.setState({errors:t})}else if("Incorrect password"!==e.error&&e.success)localStorage.setItem("token",e.token),localStorage.setItem("userId",e._id),r.setState({loginSuccessful:!0,redirect:!0});else{r.setState({loginSuccessful:!1});var s=r.state.errors;s.push(Object(u.jsx)("p",{children:"Mot de passe Incorrect"})),r.setState({errors:s})}}))},r.onPasswordChange=function(){r.setState({password:r.passwordInput.value,email:r.emailInput.value})},r.state={email:"",password:"",errors:[],redirect:!1,loginSuccessful:null},r}return Object(r.a)(s,[{key:"render",value:function(){var e=this;return this.state.redirect?Object(u.jsx)(l.a,{to:"/history"}):Object(u.jsxs)(i.a.Fragment,{children:[Object(u.jsx)(j.b,{to:"/login",children:Object(u.jsx)(h.a,{})}),Object(u.jsx)("div",{className:"logo-fruits",children:Object(u.jsx)("img",{src:p.a,className:"logo",alt:"Fruits"})}),Object(u.jsx)(j.b,{className:"back-button",to:"/login",children:"< Retour"}),Object(u.jsxs)("div",{className:"signin-container",children:[Object(u.jsxs)("form",{className:"forms",children:[Object(u.jsxs)("label",{children:["email",Object(u.jsx)("input",{className:"input-forms",value:this.state.email,onChange:this.onPasswordChange,ref:function(t){return e.emailInput=t},type:"email"})]}),Object(u.jsxs)("label",{children:["mot de passe",Object(u.jsx)("input",{className:"input-forms",value:this.state.password,onChange:this.onPasswordChange,ref:function(t){return e.passwordInput=t},type:"password"})]})]}),Object(u.jsx)("label",{className:"errors-signin",children:this.state.errors}),Object(u.jsx)("div",{className:"button-signin",onClick:this.handleSubmit,children:Object(u.jsx)(d,{})})]})]})}}]),s}(c.Component);t.default=f}}]);
//# sourceMappingURL=10.7ee0f1fc.chunk.js.map