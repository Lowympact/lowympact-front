(this.webpackJsonplowympact=this.webpackJsonplowympact||[]).push([[7],{327:function(e,t,s){},343:function(e,t,s){"use strict";s.r(t);var a=s(7),n=s(15),r=s(9),c=s(8),o=s(1),i=s.n(o),l=s(11),u=s(0);var d=function(){return Object(u.jsx)("div",{children:"Me connecter"})},p=s(66),j=s(38),h=(s(63),s(327),s(14)),b=s(53),m=s.n(b),f=s(93);var g=function(e){Object(r.a)(s,e);var t=Object(c.a)(s);function s(e){var n;return Object(a.a)(this,s),(n=t.call(this,e)).handleSubmit=function(e){e.preventDefault();var t=n.state,s=function(e,t){var s=[];return 0===e.length&&s.push(Object(u.jsx)("p",{children:"Saissez votre adresse e-mail"})),0===t.length&&s.push(Object(u.jsx)("p",{children:"Saissez votre mot de passe"})),s}(t.email,t.password);n.setState({errors:s}),0===s.length&&n.Connect()},n.componentDidMount=function(){n.Verify()},n.Verify=function(){var e=!0,t=localStorage.getItem("token");if(t){var s=m.a.decode(t,{complete:!0}),a=new Date;s.payload.exp>=a.getTime()/1e3&&(e=!1)}!1===e&&n.setState({redirect:!0})},n.Connect=function(){fetch("https://api.lowympact.fr/api/v1/users/login",{method:"POST",headers:{"Content-Type":"application/json","api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043"},body:JSON.stringify({email:n.state.email,password:n.state.password})}).then((function(e){return e.json()})).then((function(e){if("No user found"===e.error){n.setState({loginSuccessful:!1});var t=n.state.errors;t.push(Object(u.jsx)("p",{children:"Utilisateur Inconnu"})),n.setState({errors:t})}else if("Incorrect password"!==e.error&&e.success)localStorage.setItem("token",e.token),localStorage.setItem("userId",e._id),n.setState({loginSuccessful:!0,redirect:!0});else{n.setState({loginSuccessful:!1});var s=n.state.errors;s.push(Object(u.jsx)("p",{children:"Mot de passe Incorrect"})),n.setState({errors:s})}}))},n.onPasswordChange=function(){n.setState({password:n.passwordInput.value,email:n.emailInput.value})},n.state={email:"",password:"",errors:[],redirect:!1,loginSuccessful:null},n}return Object(n.a)(s,[{key:"render",value:function(){var e=this;return this.state.redirect?Object(u.jsx)(l.a,{to:"/history"}):Object(u.jsxs)(i.a.Fragment,{children:[Object(u.jsx)(h.b,{to:"/login",children:Object(u.jsx)(j.a,{})}),Object(u.jsx)("div",{className:"logo-fruits",children:Object(u.jsx)("img",{src:p.a,className:"logo",alt:"Fruits"})}),Object(u.jsx)(h.b,{className:"back-button",to:"/login",children:"< Retour"}),Object(u.jsxs)("div",{className:"signin-container",children:[Object(u.jsxs)("form",{className:"forms",children:[Object(u.jsxs)("label",{children:["email",Object(u.jsx)("input",{className:"input-forms",value:this.state.email,onChange:this.onPasswordChange,ref:function(t){return e.emailInput=t},type:"email"})]}),Object(u.jsxs)("label",{children:["mot de passe",Object(u.jsx)("input",{className:"input-forms",value:this.state.password,onChange:this.onPasswordChange,ref:function(t){return e.passwordInput=t},type:"password"})]})]}),Object(u.jsx)("label",{className:"errors-signin",children:this.state.errors}),Object(u.jsx)("div",{className:"button-signin",onClick:this.handleSubmit,children:Object(u.jsx)(d,{})})]}),Object(u.jsx)(f.a,{})]})}}]),s}(o.Component);t.default=g}}]);
//# sourceMappingURL=7.55159dfc.chunk.js.map