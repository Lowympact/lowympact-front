(this.webpackJsonplowympact=this.webpackJsonplowympact||[]).push([[13],{100:function(e,t,a){},329:function(e,t,a){},344:function(e,t,a){"use strict";a.r(t);var s=a(12),n=a(14),c=a(13),r=a(0),o=a.n(r),i=a(42),l=a(336),d=a(341),u=(a(112),a(326)),p=a(44),j=a(1),b=function(e){Object(n.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={swiper:void 0,selectedSegment:void 0},e.displayChart=function(){var t=Object(j.jsx)(o.a.Fragment,{});if(e.props.ecoScoreData&&e.props.cartedProduct>0){var a=[{title:"EcoScore A",value:e.props.ecoScoreData.a,color:"#1e8f4f"},{title:"EcoScore B",value:e.props.ecoScoreData.b,color:"#5fad0c"},{title:"EcoScore C",value:e.props.ecoScoreData.c,color:"#ecb10f"},{title:"EcoScore D",value:e.props.ecoScoreData.d,color:"#ff6f1e"},{title:"EcoScore E",value:e.props.ecoScoreData.e,color:"#df1e1f"},{title:"EcoScore Inconnu",value:e.props.ecoScoreData.unknown,color:"#000000"}];t=Object(j.jsx)(u.PieChart,{data:a,lineWidth:30,paddingAngle:1,radius:u.PieChart.defaultProps.radius-3,animate:!0,animationDuration:700,label:function(e){var t=e.dataEntry;return"".concat(Math.round(t.percentage),"%")},labelStyle:function(t){return t==e.state.selectedSegment?{fontSize:"6px",fontFamily:"comfortaa",fill:a[t].color}:{fontSize:"0px",fontFamily:"comfortaa",fill:a[t].color}},labelPosition:60,segmentsStyle:{transition:"stroke .3s ease-out",cursor:"pointer"},segmentsShift:function(t){return t==e.state.selectedSegment?3:0},onClick:function(t,a){a==e.state.selectedSegment?(e.setState({selectedSegment:void 0}),e.state.swiper.slideTo(0,500)):(e.setState({selectedSegment:a}),e.state.swiper.slideTo(a+1,500))}})}else t=Object(j.jsx)("div",{className:"stats-no-product",children:Object(j.jsxs)("div",{children:[Object(j.jsx)("img",{src:p.a,className:"logo",alt:"Fruits"}),Object(j.jsx)("p",{className:"logo-text",children:"Commence \xe0 scanner des produits !"})]})});return t},e.onSlideChange=function(t){0==t?e.setState({selectedSegment:void 0}):e.setState({selectedSegment:t-1})},e.displaySlides=function(){var t=Object(j.jsx)(o.a.Fragment,{});return e.props.ecoScoreData&&e.props.cartedProduct>0&&(t=Object(j.jsxs)(o.a.Fragment,{children:[Object(j.jsx)(l.a,{children:Object(j.jsx)("div",{className:"stats-slider",children:Object(j.jsx)("img",{className:"stats-ecoscore-full",src:"/images/utils/ecoScoreFull.png",alt:""})})}),Object(j.jsx)(l.a,{children:Object(j.jsxs)("div",{className:"stats-slider",children:[Object(j.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore A : ",e.props.ecoScoreData.a," ",e.props.ecoScoreData.a>1?" produits":" produit"]}),Object(j.jsx)("img",{className:"stats-ecoscore-image",src:"/images/utils/ecoScoreA.png",alt:""})]})}),Object(j.jsx)(l.a,{children:Object(j.jsxs)("div",{className:"stats-slider",children:[Object(j.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore B : ",e.props.ecoScoreData.b," ",e.props.ecoScoreData.b>1?" produits":" produit"]}),Object(j.jsx)("img",{className:"stats-ecoscore-image",src:"/images/utils/ecoScoreB.png",alt:""})]})}),Object(j.jsx)(l.a,{children:Object(j.jsxs)("div",{className:"stats-slider",children:[Object(j.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore C : ",e.props.ecoScoreData.c," ",e.props.ecoScoreData.c>1?" produits":" produit"]}),Object(j.jsx)("img",{className:"stats-ecoscore-image",src:"/images/utils/ecoScoreC.png",alt:""})]})}),Object(j.jsx)(l.a,{children:Object(j.jsxs)("div",{className:"stats-slider",children:[Object(j.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore D : ",e.props.ecoScoreData.d," ",e.props.ecoScoreData.d>1?" produits":" produit"]}),Object(j.jsx)("img",{className:"stats-ecoscore-image",src:"/images/utils/ecoScoreD.png",alt:""})]})}),Object(j.jsx)(l.a,{children:Object(j.jsxs)("div",{className:"stats-slider",children:[Object(j.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore E : ",e.props.ecoScoreData.e," ",e.props.ecoScoreData.e>1?" produits":" produit"]}),Object(j.jsx)("img",{className:"stats-ecoscore-image",src:"/images/utils/ecoScoreE.png",alt:""})]})}),Object(j.jsx)(l.a,{children:Object(j.jsx)("div",{className:"stats-slider",children:Object(j.jsxs)("span",{className:"stats-slider-text",children:[">"," EcoScore Inconnu : ",e.props.ecoScoreData.unknown," ",e.props.ecoScoreData.unknown>1?" produits":" produit"]})})})]})),t},e.render=function(){return Object(j.jsxs)(o.a.Fragment,{children:[Object(j.jsx)("div",{className:"stats-chart-pie",children:e.displayChart()}),Object(j.jsx)("div",{className:"stats-chart-slider",children:Object(j.jsx)(d.a,{spaceBetween:0,slidesPerView:1,centeredSlides:!0,onSlideChange:function(t){return e.onSlideChange(t.activeIndex)},onSwiper:function(t){return e.setState({swiper:t})},children:e.displaySlides()})})]})},e}return a}(o.a.Component),m=a(327),h=a.n(m),g=["Janvier","F\xe9vrier","Mars","Avril","Mai","Juin","Juillet","Ao\xfbt","Septembre","Octobre","Novembre","D\xe9cembre"],f=function(e){Object(n.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={selectedSegment:0,options:{chart:{toolbar:{show:!1},dropShadow:{enabled:!0,top:0,left:0,blur:2,opacity:.5}},plotOptions:{bar:{borderRadius:5,horizontal:!0}},xaxis:{categories:["Janvier","F\xe9vrier","Mars","Avril","Mai"],labels:{style:{fontSize:"12px",fontFamily:"Comfortaa",fontColor:"#1b3044"}},title:{text:"CO\u2082 \xe9quivalent (kg)",style:{fontSize:"12px",fontFamily:"Comfortaa",fontColor:"#1b3044"}}},yaxis:{labels:{style:{fontSize:"12px",fontFamily:"Comfortaa",fontColor:"#1b3044"}}},dataLabels:{enabled:!0,style:{fontSize:"10px",fontFamily:"Comfortaa"}},noData:{text:"Chargement..."},fill:{colors:["#ff914d"]},grid:{xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}}}}},e.displayChart=function(){var t=Object(j.jsx)(o.a.Fragment,{});if(e.props.carbonImpactData&&e.props.cartedProduct>0){var a,s=e.props.carbonImpactData.data.length,n=[];switch(e.props.carbonImpactData.unit){case"weekly":var c=new Date;c.setHours(0,0,0,0),c.setDate(c.getDate()+4-(c.getDay()||7));var r=new Date(c.getFullYear(),0,1);a=Math.ceil(((c-r)/864e5+1)/7);for(var i=s-1;i>=0;i--)n.push("Semaine "+(a-i));break;case"monthly":a=(new Date).getMonth();for(var l=(new Date).getFullYear(),d=s-1;d>=0;d--){var u=a-d;u<0?n.push(g[u+12]+" "+(l-1)):n.push(g[u]+" "+l)}break;case"yearly":a=(new Date).getFullYear();for(var b=s-1;b>=0;b--)n.push((a-b).toString());break;default:a=(new Date).getFullYear();for(var m=s-1;m>=0;m--)n.push((a-m).toString())}e.state.options.xaxis.categories=n;var f=[{name:"CO\u2082 \xe9quivalent (kg)",data:[]}],v=e.props.carbonImpactData.data;v.sort((function(e,t){return e.offset>t.offset?1:-1}));for(var x=0;x<v.length;x++){var O=0===e.state.selectedSegment?v[x].impact.toFixed(2):(v[x].impact/v[x].nbProducts).toFixed(2);f[0].data.push(O)}t=Object(j.jsx)(o.a.Fragment,{children:Object(j.jsx)("div",{className:"stats-chart-bar",children:Object(j.jsx)(h.a,{options:e.state.options,series:f,type:"bar",height:350})})})}else t=Object(j.jsx)("div",{className:"stats-no-product",children:Object(j.jsxs)("div",{children:[Object(j.jsx)("img",{src:p.a,className:"logo",alt:"Fruits"}),Object(j.jsx)("p",{className:"logo-text",children:"Commence \xe0 scanner des produits !"})]})});return t},e.onSlideChange=function(t){e.setState({selectedSegment:0===e.state.selectedSegment?1:0})},e.displaySlides=function(){var t=Object(j.jsx)(o.a.Fragment,{});return e.props.carbonImpactData&&e.props.cartedProduct>0&&(t=Object(j.jsxs)(o.a.Fragment,{children:[Object(j.jsx)(l.a,{children:Object(j.jsx)("div",{className:"stats-slider",children:Object(j.jsxs)("span",{className:"stats-slider-text",children:[">"," Impact Carbone total"]})})}),Object(j.jsx)(l.a,{children:Object(j.jsx)("div",{className:"stats-slider",children:Object(j.jsxs)("span",{className:"stats-slider-text",children:[">"," Impact Carbone par produit"]})})})]})),t},e.render=function(){return Object(j.jsxs)(o.a.Fragment,{children:[e.displayChart(),Object(j.jsx)("div",{className:"stats-chart-slider",children:Object(j.jsx)(d.a,{spaceBetween:0,slidesPerView:1,centeredSlides:!0,onSlideChange:function(t){return e.onSlideChange(t.activeIndex)},onSwiper:function(t){return e.setState({swiper:t})},children:e.displaySlides()})})]})},e}return a}(o.a.Component),v=(a(100),a(16)),x=a(55),O=a.n(x),S=(a(329),function(e){Object(n.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={ecoScoreData:void 0,carbonImpactData:void 0,username:void 0,scannedProduct:void 0,cartedProduct:void 0,userId:void 0,value:0},e.Verify=function(){var t=!0,a=localStorage.getItem("token");if(a){var s=O.a.decode(a,{complete:!0}),n=new Date;s.payload.exp>=n.getTime()/1e3&&(t=!1)}!1===t&&e.setState({connected:!0})},e.componentDidMount=function(){e.Verify();var t=localStorage.getItem("userId");t&&e.setState({userId:t}),e.loadUserData(t),e.loadEcoScoreData(t,"fromBeginning"),e.loadCarbonImpactData(t,"fromBeginning")},e.loadUserData=function(t){fetch("https://api.lowympact.fr/api/v1/users/".concat(t),{method:"get",credentials:"include",headers:new Headers({authorization:localStorage.getItem("token"),"api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043","Content-Type":"application/json"})}).then((function(e){return e.json()})).then((function(t){var a;e.setState({username:null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.username,scannedProduct:null===t||void 0===t?void 0:t.scannedProduct,cartedProduct:null===t||void 0===t?void 0:t.cartedProduct})}))},e.loadEcoScoreData=function(t,a){fetch("https://api.lowympact.fr/api/v1/users/".concat(t,"/statistics?typeStatistic=ecoscore&typeAggregate=").concat(a),{method:"get",credentials:"include",headers:new Headers({authorization:localStorage.getItem("token"),"api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043","Content-Type":"application/json"})}).then((function(e){return e.json()})).then((function(t){var a;e.setState({ecoScoreData:null===t||void 0===t||null===(a=t.statistics)||void 0===a?void 0:a.ecoscore})}))},e.loadCarbonImpactData=function(t,a){fetch("https://api.lowympact.fr/api/v1/users/".concat(t,"/statistics?typeStatistic=carbonImpact&typeAggregate=").concat(a),{method:"get",credentials:"include",headers:new Headers({authorization:localStorage.getItem("token"),"api-key":"99d8fb95-abdd-4885-bf6c-3a81d8874043","Content-Type":"application/json"})}).then((function(e){return e.json()})).then((function(t){var a;e.setState({carbonImpactData:null===t||void 0===t||null===(a=t.statistics)||void 0===a?void 0:a.carbonImpact})}))},e.displayStats=function(){var t=Object(j.jsx)(o.a.Fragment,{}),a=Object(j.jsx)(o.a.Fragment,{});return void 0!==e.state.scannedProduct&&(t=Object(j.jsxs)("div",{className:"stats-header-text",children:[Object(j.jsx)("span",{className:"circle-stats color_score_stats",children:"\u2b24 "}),e.state.scannedProduct>1?"Produits scann\xe9s :":"Produit scann\xe9 :",Object(j.jsxs)("span",{className:"uppercase ",children:[" ",e.state.scannedProduct]})]})),void 0!==e.state.cartedProduct&&(a=Object(j.jsxs)("div",{className:"stats-header-text",children:[Object(j.jsx)("span",{className:"circle-stats color_score_stats",children:"\u2b24 "}),e.state.cartedProduct>1?"Produits achet\xe9s :":"Produit achet\xe9 :",Object(j.jsxs)("span",{className:"uppercase ",children:[" ",e.state.cartedProduct]})]})),Object(j.jsxs)(o.a.Fragment,{children:[t,a]})},e.handleChange=function(t,a){e.setState({value:a})},e.displayNavbar=function(){return Object(j.jsxs)("div",{className:"stats-navbar-container",children:[Object(j.jsx)("button",{className:0===e.state.value?"stats-navbar-button selected":"stats-navbar-button",onClick:function(){return e.handleChange("",0)},children:"EcoScore"}),Object(j.jsx)("button",{className:1===e.state.value?"stats-navbar-button selected":"stats-navbar-button",onClick:function(){return e.handleChange("",1)},children:"Impact Carbone"}),Object(j.jsx)("div",{className:0===e.state.value?"navbar-under nav-left":"navbar-under nav-right"})]})},e.render=function(){return Object(j.jsx)(o.a.Fragment,{children:Object(j.jsxs)("div",{className:"stats-page-container",children:[Object(j.jsxs)("div",{className:"stats-header-container",children:[Object(j.jsx)("div",{className:"stats-profil-link",children:Object(j.jsxs)(v.b,{to:"/profil",children:[" ","<"," Profil"]})}),Object(j.jsx)("img",{className:"stats-bitmap-image",src:"/images/utils/bitmap.png",alt:""})]}),Object(j.jsx)("div",{className:"stats-welcome",children:Object(j.jsx)("span",{className:"stats-welcome-text",children:e.state.username?e.state.username+", voici ton r\xe9capitulatif Lowympact...":""})}),Object(j.jsx)("div",{className:"stats-text-container",children:e.displayStats()}),e.displayNavbar(),0===e.state.value?Object(j.jsx)(b,{ecoScoreData:e.state.ecoScoreData,scannedProduct:e.state.scannedProduct,cartedProduct:e.state.cartedProduct}):Object(j.jsx)(f,{carbonImpactData:e.state.carbonImpactData,scannedProduct:e.state.scannedProduct,cartedProduct:e.state.cartedProduct}),Object(j.jsx)(i.a,{})]})})},e}return a}(o.a.Component));t.default=S},42:function(e,t,a){"use strict";var s=a(36),n=a.n(s),c=a(37),r=a(12),o=a(15),i=a(14),l=a(13),d=(a(49),a(0)),u=a.n(d),p=(a(50),a(1));var j=function(){return Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{className:"button-logo",children:Object(p.jsx)("span",{className:"material-icons",children:"history"})}),Object(p.jsx)("div",{children:"Historique"})]})};var b=function(){return Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{children:Object(p.jsx)("span",{className:"material-icons",children:"person"})}),Object(p.jsx)("div",{children:"Profil"})]})};var m=function(){return Object(p.jsx)("div",{children:Object(p.jsx)("div",{className:"navbar-scan-icon",children:Object(p.jsx)("span",{className:"material-icons",children:"qr_code_scanner"})})})},h=a(80),g=a(81),f=a.n(g),v=a(82),x=a.n(v),O=function(e){Object(i.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(r.a)(this,a);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={error:!1,noBackCamera:!1,usedCamera:0,devices:[],processingImage:0,text:0,mutlipleTracks:!1,no_permission:!1},e.switchCamera=function(){var t=e.state.usedCamera+1;t>=e.state.devices.length&&(t=0),e.setState({usedCamera:t}),f.a.stop(),e.QuaggaInit(e.state.devices[t].deviceId)},e.componentDidMount=Object(c.a)(n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.QuaggaInit(e.props.capabilities);case 1:case"end":return t.stop()}}),t)}))),e.QuaggaInit=function(t){console.log(t),0==Object.keys(t).length&&e.setState({text:"vide"}),f.a.init({inputStream:{type:"LiveStream",constraints:Object(h.a)({},t)},locator:{patchSize:"normal",halfSample:!1},locate:!1,area:{top:"40%",right:"25%",left:"25%",bottom:"40%"},numOfWorkers:window.navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader"]},multiple:!1,singleChannel:!1},(function(a){if(a)return console.log(a),"NotAllowedError: Permission denied"==a&&e.setState({no_permission:!0}),e.setState({error:!0,text:a+" "+JSON.stringify(t)}),!1;f.a.start()})),e.props.setQuagga(f.a),console.log(f.a.CameraAccess),f.a.onDetected(e._onDetected)},e._onDetected=function(){var t=Object(c.a)(n.a.mark((function t(a){var s;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.props.onDetected(a);case 2:s=t.sent,console.log(s),s&&f.a.stop();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onDrop=function(t){try{if(1!=e.state.processingImage){e.setState({processingImage:1}),console.log(t[t.length-1]);var a=new FileReader;a.readAsDataURL(t[t.length-1]),a.onloadend=function(){f.a.decodeSingle({decoder:{readers:["ean_reader"]},locate:!0,src:a.result},(function(t){var a;(console.log(t),t)?(e._onDetected(t),e.setState({processingImage:2}),console.log("result",null===(a=t.codeResult)||void 0===a?void 0:a.code)):(console.log("not detected"),e.setState({processingImage:3}))}))}}}catch(s){console.log(s),e.setState({processingImage:4})}},e.setImport=function(){e.setState({error:!e.state.error})},e}return Object(o.a)(a,[{key:"componentWillUnmount",value:function(){f.a.offDetected(this._onDetected)}},{key:"render",value:function(){var e=Object(p.jsx)(u.a.Fragment,{});return 1==this.state.processingImage&&(e=Object(p.jsx)(u.a.Fragment,{children:Object(p.jsx)("p",{children:"Chargement en cours..."})})),2==this.state.processingImage&&(e=Object(p.jsx)(u.a.Fragment,{children:Object(p.jsx)("p",{children:"Ce produit n'existe pas dans la base de donn\xe9es"})})),3==this.state.processingImage&&(e=Object(p.jsx)(u.a.Fragment,{children:Object(p.jsx)("p",{children:"Code barre non trouv\xe9 sur l'image, merci de r\xe9essayer"})})),4==this.state.processingImage&&(e=Object(p.jsx)(u.a.Fragment,{children:Object(p.jsxs)("p",{children:["Mauvais format ou fichier trop grand, merci de r\xe9essayer. ",Object(p.jsx)("br",{}),"Taille max : 5mb ",Object(p.jsx)("br",{}),"Formats: jpg, png, gif"]})})),Object(p.jsx)(u.a.Fragment,{children:Object(p.jsxs)("div",{className:"interactive-wrapper",children:[Object(p.jsx)("div",{id:"interactive",className:this.state.error?"hidden":"viewport"}),Object(p.jsx)("button",{className:"code-switch-camera",onClick:this.setImport,children:Object(p.jsx)("span",{className:"material-icons green",children:this.state.error?"flip":"upload_file"})}),this.state.error?Object(p.jsxs)("div",{className:"scan-error",children:[Object(p.jsx)(x.a,{withIcon:!0,withPreview:!1,buttonText:Object(p.jsxs)("div",{className:"button-import",children:[Object(p.jsx)("div",{className:"material-icons",children:"add_a_photo"}),Object(p.jsx)("p",{children:"Importer une photo"})]}),onChange:this.onDrop,label:"",imgExtension:[".jpg",".gif",".png",".jpeg"],maxFileSize:5242880,labelClass:"import-label"}),Object(p.jsx)("p",{className:"red",children:e}),Object(p.jsxs)("p",{className:"error-message-import",children:[this.state.no_permission?Object(p.jsx)("div",{className:"no-permission",children:"L'acc\xe8s \xe0 votre cam\xe9ra est bloqu\xe9 : Vous pouvez l'autoriser dans les param\xe8tres de votre navigateur pour acc\xe9der au scanner"}):Object(p.jsx)(u.a.Fragment,{}),Object(p.jsx)("br",{})]})]}):Object(p.jsx)(u.a.Fragment,{}),this.state.mutlipleTracks?Object(p.jsx)("h1",{className:"debug",children:"If you see this, tell me"}):"",Object(p.jsx)("div",{className:"debug",children:this.state.text})]})})}}]),a}(d.Component),S=a(83),w=a.n(S),y=(a(84),a(2)),N=(a(51),function(e){Object(i.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(r.a)(this,a);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={scanning:!0,status:"",results:[],usedCameraId:"3f6fc4177028f25c3e8215f4444838450630b8d656c627ef511346545d37f302",devices:[],reading:!1,barcode:void 0,bcProductId:void 0,Quagga:void 0},e.setQuagga=function(t){e.state.Quagga&&e.state.Quagga.stop(),e.setState({Quagga:t})},e._scan=function(){e.setState({scanning:!e.state.scanning,status:""})},e._onDetected=function(){var t=Object(c.a)(n.a.mark((function t(a){var s;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=18;break}if(!a.codeResult||!a.codeResult.code){t.next=18;break}return e.setState({results:[a],scanning:!0,status:"waiting"}),t.next=5,fetch("https://world.openfoodfacts.org/api/v0/product/".concat(a.codeResult.code,".json/"));case 5:return s=t.sent,t.next=8,s.json();case 8:if(0===t.sent.status){t.next=16;break}return e.setState({scanning:!1,status:"found",barcode:a.codeResult.code}),e.props.showScanner(!1),e.state.Quagga&&e.state.Quagga.stop(),t.abrupt("return",!0);case 16:return e.setState({scanning:!0,status:"not found"}),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleScan=function(t){if(t){var a=t.split("/");a.length>1&&e.setState({scanning:!1,barcode:a[4],bcProductId:a[5],status:"found"}),e.state.Quagga&&e.state.Quagga.stop()}},e.handleError=function(e){console.error(e)},e.displayQrCode=function(){return"found"!==e.state.status?Object(p.jsx)(w.a,{delay:300,onError:e.handleError,onScan:e.handleScan,style:{width:"100%"},showViewFinder:!1}):Object(p.jsx)(u.a.Fragment,{})},e.displayBarCode=function(){return"found"!==e.state.status?Object(p.jsxs)(u.a.Fragment,{children:[Object(p.jsx)("div",{className:"header",children:Object(p.jsx)("ul",{className:"results",children:e.state.results.map((function(t,a){var s;return Object(p.jsxs)("div",{children:["waiting"===e.state.status?"V\xe9rification du code : "+(null===t||void 0===t||null===(s=t.codeResult)||void 0===s?void 0:s.code):"","not found"===e.state.status?"Code non trouv\xe9, merci de r\xe9essayer":""]},t.codeResult.code+a)}))})}),e.state.scanning?Object(p.jsx)(O,{onDetected:e._onDetected,setQuagga:e.setQuagga,usedCameraId:e.usedCameraId,capabilities:e.props.capabilities}):null]}):Object(p.jsx)(u.a.Fragment,{})},e.switchReader=function(){e.state.reading?e.setState({reading:!1}):(e.state.Quagga&&e.state.Quagga.stop(),e.setState({reading:!0}))},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return this.state.barcode&&this.state.bcProductId&&(this.props.barcode!==this.state.barcode||this.props.bcProductId!==this.state.bcProductId)?Object(p.jsx)(y.a,{to:"/products/"+this.state.barcode+"/"+this.state.bcProductId}):this.state.barcode&&this.props.barcode!==this.state.barcode?Object(p.jsx)(y.a,{to:"/products/"+this.state.barcode}):Object(p.jsxs)("div",{className:"code-reader-container",children:[Object(p.jsx)("span",{className:"close",onClick:function(){e.state.Quagga&&e.state.Quagga.stop(),e.props.showScanner(!1)},children:"\xd7"}),this.displayBarCode()]})}}]),a}(d.Component)),D=a(16),C=function(e){Object(i.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(r.a)(this,a);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={showScanner:!1,barcode:void 0,bcProductId:void 0,height:0,capabilities:{facingMode:"environment"}},e.componentDidMount=Object(c.a)(n.a.mark((function t(){var a,s,r,o,i,l;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.updateWindowDimensions(),window.addEventListener("resize",e.updateWindowDimensions),t.prev=2,a=window.location.search,s=new URLSearchParams(a),s.get("camera"),!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)){t.next=21;break}return t.next=9,navigator.mediaDevices.enumerateDevices().then((function(e){return e.filter((function(e){return"videoinput"===e.kind}))}));case 9:return r=t.sent,0===(o=r.filter((function(e){return null!=e.label.match(/back/)}))).length&&(o=r),console.log(o),i=o.map(function(){var e=Object(c.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:t.deviceId}}}).then((function(e){var t=e.getVideoTracks().map((function(e){return console.log(e),e.getCapabilities?e.getCapabilities():[{}]}));return e.getTracks().forEach((function(e){return e.stop()})),t&&t.length>0?t[0]:{}}),(function(e){return console.log(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.next=16,Promise.all(i);case 16:(l=t.sent)&&l.length>0&&l.sort((function(e,t){return(e.width.max+e.height.max)/2>(t.width.max+t.height.max)/2?-1:1})),l[0]?e.setState({capabilities:l[0]}):e.setState({capabilities:{facingMode:"environment"}}),t.next=22;break;case 21:e.setState({capabilities:{facingMode:"environment"}});case 22:t.next=27;break;case 24:t.prev=24,t.t0=t.catch(2),e.setState({capabilities:{facingMode:"environment"}});case 27:case"end":return t.stop()}}),t,null,[[2,24]])}))),e.updateWindowDimensions=function(){e.setState({height:window.innerHeight})},e.handleScannerButton=function(t){e.setState({showScanner:t})},e.render=function(){return e.state.height<550?Object(p.jsx)(u.a.Fragment,{}):e.state.showScanner?Object(p.jsx)(N,{showScanner:e.handleScannerButton,history:e.props.history,capabilities:e.state.capabilities}):Object(p.jsx)(u.a.Fragment,{children:Object(p.jsxs)("div",{className:"navbar-container",children:[Object(p.jsx)(D.b,{to:"/history",className:"/history"===window.location.pathname?"navbar-link navbar-text-left navbar-selected":"navbar-link navbar-text-left ",children:Object(p.jsx)(j,{})}),Object(p.jsx)("div",{onClick:function(){return e.handleScannerButton(!0)},children:Object(p.jsx)("div",{className:"navbar-circle",children:Object(p.jsx)(m,{})})}),Object(p.jsx)("span",{className:"navbar-scan-text",children:"Scan"}),Object(p.jsx)(D.b,{to:"/profil",className:"/profil"===window.location.pathname?"navbar-link navbar-text-right navbar-selected":"navbar-link navbar-text-right ",children:Object(p.jsx)(b,{})})]})})},e}return Object(o.a)(a,[{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}}]),a}(u.a.Component);t.a=C},44:function(e,t,a){"use strict";t.a=a.p+"static/media/fruits-vegetables-basket-by-oblik-studio.7d5e1c64.svg"},49:function(e,t,a){},50:function(e,t,a){},51:function(e,t,a){},58:function(e,t){},59:function(e,t){},60:function(e,t){},61:function(e,t){},63:function(e,t){},64:function(e,t){},65:function(e,t){},66:function(e,t){},67:function(e,t){},68:function(e,t){},69:function(e,t){},70:function(e,t){}}]);
//# sourceMappingURL=13.af3b9564.chunk.js.map